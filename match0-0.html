<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>travelling</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>BinhLuan\BLDacSanFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="687"></A><FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#687',3,'match0-top.html#687',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.BinhLuan;

import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DacSan.FragmentDacSan_View;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class BLDacSanFragment extends Fragment {

    private static final String ARG_MaTinh</B></FONT> = &quot;MaTinh&quot;;
    private static final String ARG_TenDacSan = &quot;TenDacSan&quot;;
    private static final String ARG_MaDacSan = &quot;MaDacSan&quot;;
<A NAME="688"></A>    public static String mMaTinh, mTenDacSan;
    public static Integer mMaDacSan;
    //Phần khai báo
    View <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#688',3,'match0-top.html#688',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>view;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
    private SharedPreferences.Editor editor;
    public static ArrayList&lt;BinhLuanClass&gt; arrayListBinhLuan;
    private BLDacSanListView adapterBinhLuan;
    private ImageButton btnQuayLai, btnGui;
    private TextView textTenDacSan;
    private EditText editNoiDung;
    private ListView listView;
    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic</B></FONT>();
    public static String strTaiKhoan;

    public BLDacSanFragment() {

    }

    public static BLDacSanFragment newInstance(String maTinh, String tenDacSan, Integer maDacSan) {
        BLDacSanFragment fragment = new BLDacSanFragment();
        Bundle args = new Bundle();
        args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_TenDacSan, tenDacSan);
        args.putInt(ARG_MaDacSan, maDacSan);
        fragment.setArguments(args);
        return fragment;
    }

<A NAME="689"></A>    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (<FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#689',3,'match0-top.html#689',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments() != null) {
            mMaTinh = getArguments().getString(ARG_MaTinh);
            mTenDacSan = getArguments().getString(ARG_TenDacSan);
            mMaDacSan = getArguments</B></FONT>().getInt(ARG_MaDacSan);
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
<A NAME="690"></A>                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_b_l_dac_san, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(<FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#690',3,'match0-top.html#690',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        layoutAnhXa();
        return view;
    }

    private void layoutAnhXa() {
        btnQuayLai = view</B></FONT>.findViewById(R.id.btnQuayLai);
        textTenDacSan = view.findViewById(R.id.textTenDacSan);
<A NAME="691"></A>        listView = view.findViewById(R.id.listView);
        editNoiDung = view.findViewById(R.id.editNoiDung);
        btnGui = view.findViewById(R.id.btnGui);
        <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#691',3,'match0-top.html#691',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTenDacSan.setText(mTenDacSan); //set tên đặc sản
        loadDanhSachBinhLuan();
        clickButton();
    }

    private void loadDanhSachBinhLuan() {
        arrayListBinhLuan = new ArrayList&lt;&gt;();
        arrayListBinhLuan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlBinhLuan = &quot;select MaBinhLuan, Anh, HoTen, NoiDung, TaiKhoanBinhLuan from TB_BinhLuanDacSan blds, TB_NguoiDung nd where blds.TaiKhoanBinhLuan = nd.TaiKhoan and MaSo = '&quot; + mMaDacSan + &quot;' order by MaBinhLuan desc&quot;;
            ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="692"></A>            if (resultSetBinhLuan != null){
                while (resultSetBinhLuan.next()){
                    arrayListBinhLuan.add(new BinhLuanClass(resultSetBinhLuan.getInt(&quot;MaBinhLuan&quot;), resultSetBinhLuan.getString(&quot;Anh&quot;),
                            resultSetBinhLuan</B></FONT>.getString(&quot;HoTen&quot;), <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#692',3,'match0-top.html#692',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetBinhLuan.getString(&quot;NoiDung&quot;), resultSetBinhLuan.getString(&quot;TaiKhoanBinhLuan&quot;)));
                }
            }
<A NAME="693"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log</B></FONT>.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#693',3,'match0-top.html#693',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterBinhLuan = new BLDacSanListView(getContext());
        listView.setAdapter(adapterBinhLuan);
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                FragmentDacSan_View fragmentDacSan = new FragmentDacSan_View();
                Bundle bundleDiaDiem = new Bundle();
                bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                fragmentDacSan.setArguments(bundleDiaDiem);
                fragmentTransaction.replace(R.id.fragment_main, fragmentDacSan);
                fragmentTransaction.commit();
            }
        });

<A NAME="694"></A>        btnGui.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#694',3,'match0-top.html#694',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editNoiDung.getText().length() != 0){
                    try {
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String sqlBinhLuan = &quot;insert into TB_BinhLuanDacSan(TaiKhoanBinhLuan, MaSo, NoiDung) values('&quot; + strTaiKhoan + &quot;', '&quot; + mMaDacSan + &quot;', N'&quot; + editNoiDung.getText().toString() + &quot;')&quot;;
                        if (classConnect.updateData(getActivity(), sqlBinhLuan) == 1){
                            classPublic.ThongBao(getActivity(), &quot;Thông báo! Gửi thành công&quot;);
                            editNoiDung.setText(&quot;&quot;);
                            loadDanhSachBinhLuan();
                        }
                        else {
                            classPublic.ThongBao(getActivity(), &quot;Lỗi! Không gửi được&quot;);
                        }
                        classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.d(&quot;TAG&quot;, e.getMessage());
                    }
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập nội dung&quot;);
                }
            }</B></FONT>
        });
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLDacSanListView.java</CENTER></H3><HR>
<PRE>
<A NAME="695"></A><FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#695',3,'match0-top.html#695',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.BinhLuan;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;

public class BLDacSanListView extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;BinhLuanClass&gt; arraylist;
    ClassPublic classPublic;
    ClassConnect classConnect;
<A NAME="696"></A>
    public BLDacSanListView(Context context) {
        mContext = context;
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#696',3,'match0-top.html#696',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(BLDacSanFragment.arrayListBinhLuan);
    }
    public static class ViewHolder {
        ImageView imageUser, imageXoa;
        TextView textHoTen, textNoiDung;
    }
    @Override
    public int getCount() {
        return BLDacSanFragment.arrayListBinhLuan.size();
    }

    @Override
    public Object getItem(int position) {
        return BLDacSanFragment.arrayListBinhLuan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final BLDacSanListView.ViewHolder holder;
        if (convertView == null) {
            holder = new BLDacSanListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_binhluan, null);
            holder.imageUser = convertView.findViewById(R.id.imageUser);
            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.textNoiDung = convertView.findViewById(R.id.textNoiDung);
            holder.imageXoa = convertView.findViewById(R.id.imageXoa);
            convertView.setTag(holder);
        } else {
            holder = (BLDacSanListView.ViewHolder) convertView.getTag();
        }</B></FONT>
<A NAME="697"></A>        String strAnh = BLDacSanFragment.arrayListBinhLuan.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#697',3,'match0-top.html#697',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager</B></FONT>.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageUser); //Load ảnh người dùng từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
<A NAME="698"></A>
        }
        else {
            <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#698',3,'match0-top.html#698',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.imageUser.setImageResource(R.drawable.profle);
        }
        holder.textHoTen.setText(BLDacSanFragment.arrayListBinhLuan.get(position).getStrHoTen());
        holder.textNoiDung.setText(BLDacSanFragment.arrayListBinhLuan.get(position).getStrNoiDung());
        if (BLDacSanFragment.strTaiKhoan.equals(BLDacSanFragment.arrayListBinhLuan.get(position).getStrTaiKhoan()))
        {
            holder.imageXoa.setVisibility(View.VISIBLE);
        }
        else {
            holder.imageXoa.setVisibility(View.GONE);
        }
        holder</B></FONT>.imageXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa bình luận này không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="699"></A>                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#699',3,'match0-top.html#699',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
                            Integer intMaBinhLuan = BLDacSanFragment.arrayListBinhLuan.get(position).getIntMaBinhLuan();
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            classPublic = new ClassPublic();
                            String sqlBinhLuan = &quot;delete TB_BinhLuanDacSan where MaBinhLuan = '&quot;+intMaBinhLuan+&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlBinhLuan) == 1){
                                classPublic</B></FONT>.ThongBao((Activity)mContext, &quot;Thông báo! Xóa bình luận thành công&quot;);
                                BLDacSanFragment.fragmentTransaction = BLDacSanFragment.fragmentManager.beginTransaction(); //Goi lại trang loại
                                BLDacSanFragment.fragmentTransaction.replace(R.id.fragment_main, BLDacSanFragment.newInstance(BLDacSanFragment.mMaTinh, BLDacSanFragment.mTenDacSan, BLDacSanFragment.mMaDacSan));
                                BLDacSanFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        return convertView;
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLDiaDiemFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="700"></A><FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#700',3,'match0-top.html#700',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.BinhLuan;

import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class BLDiaDiemFragment extends Fragment {

    private static final String ARG_MaTinh = &quot;MaTinh&quot;</B></FONT>;
<A NAME="701"></A>    private static final String ARG_TenDiaDiem = &quot;TenDiaDiem&quot;;
    private static final String ARG_DiaChi = &quot;DiaChi&quot;;
    private static final String ARG_MaDiaDiem = &quot;MaDiaDiem&quot;;
    public static String mMaTinh, <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#701',3,'match0-top.html#701',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mTenDiaDiem, mDiaChi;
    public static Integer mMaDiaDiem;
    //Phần khai báo
    View view;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
    private SharedPreferences.Editor editor;
    public static ArrayList&lt;BinhLuanClass&gt; arrayListBinhLuan;
    private BLDiaDiemListView adapterBinhLuan;
    private ImageButton btnQuayLai, btnGui;
    private TextView textTenDiaDiem, textDiaChi;
    private EditText editNoiDung;
    private ListView listView;
    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic</B></FONT>();
    public static String strTaiKhoan;

    public BLDiaDiemFragment() {

    }

    public static BLDiaDiemFragment newInstance(String maTinh, String tenDiaDiem, String diaChi, Integer maDiaDiem) {
        BLDiaDiemFragment fragment = new BLDiaDiemFragment();
        Bundle args = new Bundle();
        args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_TenDiaDiem, tenDiaDiem);
        args.putString(ARG_DiaChi, diaChi);
        args.putInt(ARG_MaDiaDiem, maDiaDiem);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getArguments() != null) {
            mMaTinh = getArguments().getString(ARG_MaTinh);
            mTenDiaDiem = getArguments().getString(ARG_TenDiaDiem);
            mDiaChi = getArguments().getString(ARG_DiaChi);
            mMaDiaDiem = getArguments().getInt(ARG_MaDiaDiem);
        }
        else {
            mMaTinh = &quot;&quot;;
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_b_l_dia_diem, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        layoutAnhXa();
        return view;
    }
<A NAME="702"></A>
    private void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#702',3,'match0-top.html#702',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTenDiaDiem = view.findViewById(R.id.textDiaDiem);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        listView = view.findViewById(R.id.listView);
        editNoiDung = view.findViewById(R.id.editNoiDung);
        btnGui = view.findViewById(R.id.btnGui);
        textTenDiaDiem.setText(mTenDiaDiem); //set tên địa điểm
        textDiaChi.setText(mDiaChi); //set địa chỉ
        loadDanhSachBinhLuan();
        clickButton();
    }

    private void loadDanhSachBinhLuan() {
        arrayListBinhLuan = new ArrayList&lt;&gt;();
        arrayListBinhLuan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlBinhLuan = &quot;select MaBinhLuan, Anh, HoTen, NoiDung, TaiKhoanBinhLuan from TB_BinhLuan bl, TB_NguoiDung nd where bl.TaiKhoanBinhLuan = nd.TaiKhoan and MaSo = '&quot; + mMaDiaDiem + &quot;' order by MaBinhLuan desc&quot;;
<A NAME="703"></A>            ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
            if (resultSetBinhLuan != null){
                while (resultSetBinhLuan</B></FONT>.next()){
                    arrayListBinhLuan.add(new BinhLuanClass(resultSetBinhLuan.getInt(&quot;MaBinhLuan&quot;), <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#703',3,'match0-top.html#703',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetBinhLuan.getString(&quot;Anh&quot;),
                            resultSetBinhLuan.getString(&quot;HoTen&quot;), resultSetBinhLuan.getString(&quot;NoiDung&quot;), resultSetBinhLuan.getString(&quot;TaiKhoanBinhLuan&quot;)));
                }
            }
<A NAME="704"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch</B></FONT> (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#704',3,'match0-top.html#704',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterBinhLuan = new BLDiaDiemListView(getContext());
        listView.setAdapter(adapterBinhLuan);
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (mMaTinh.equals(&quot;&quot;)) {
                    DiaDiemYeuThichFragment fragmentDiaDiemYeuThich = new DiaDiemYeuThichFragment();
                    fragmentTransaction.replace(R.id.fragment_main, fragmentDiaDiemYeuThich);
                }
                else {
                    FragmentDiaDiem_View fragmentDiaDiemView = new FragmentDiaDiem_View();
                    Bundle bundleDiaDiem = new Bundle();
                    bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragmentDiaDiemView.setArguments(bundleDiaDiem);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentDiaDiemView);
                }
                fragmentTransaction.commit();
            }
        });

<A NAME="705"></A>        btnGui.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#705',3,'match0-top.html#705',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editNoiDung.getText().length() != 0){
                    try {
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String sqlBinhLuan = &quot;insert into TB_BinhLuan(TaiKhoanBinhLuan, MaSo, NoiDung) values('&quot; + strTaiKhoan + &quot;', '&quot; + mMaDiaDiem + &quot;', N'&quot; + editNoiDung.getText().toString() + &quot;')&quot;;
                        if (classConnect.updateData(getActivity</B></FONT>(), sqlBinhLuan) == 1){
                            classPublic.ThongBao(getActivity(), &quot;Thông báo! Gửi thành công&quot;);
<A NAME="706"></A>                            editNoiDung.setText(&quot;&quot;);
                            loadDanhSachBinhLuan();
                        }
                        <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#706',3,'match0-top.html#706',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(), &quot;Lỗi! Không gửi được&quot;);
                        }
                        classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.d(&quot;TAG&quot;, e.getMessage());
                    }</B></FONT>
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập nội dung&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLDiaDiemListView.java</CENTER></H3><HR>
<PRE>
<A NAME="707"></A>package com.example.travelling.BinhLuan;

import android.annotation.SuppressLint;
<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#707',3,'match0-top.html#707',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;

public class BLDiaDiemListView extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;BinhLuanClass&gt; arraylist;
    ClassPublic classPublic;
    ClassConnect classConnect;

    public BLDiaDiemListView(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(BLDiaDiemFragment.arrayListBinhLuan);
<A NAME="708"></A>    }
    public static class ViewHolder {
        ImageView imageUser, imageXoa;
        TextView textHoTen</B></FONT>, <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#708',3,'match0-top.html#708',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textNoiDung;
    }
    @Override
    public int getCount() {
        return BLDiaDiemFragment.arrayListBinhLuan.size();
    }

    @Override
    public Object getItem(int position) {
        return BLDiaDiemFragment.arrayListBinhLuan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final BLDiaDiemListView.ViewHolder holder;
        if (convertView == null) {
            holder = new BLDiaDiemListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_binhluan, null);
            holder.imageUser = convertView.findViewById(R.id.imageUser);
<A NAME="709"></A>            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.textNoiDung = convertView.findViewById(R.id.textNoiDung);
            holder.imageXoa = convertView</B></FONT>.findViewById(R.id.imageXoa);
            <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#709',3,'match0-top.html#709',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>convertView.setTag(holder);
        } else {
            holder = (BLDiaDiemListView.ViewHolder) convertView.getTag();
        }
        String strAnh = BLDiaDiemFragment.arrayListBinhLuan.get(position).getStrAnh();
        if (!strAnh</B></FONT>.isEmpty() || !strAnh.equals(&quot;&quot;)){
<A NAME="710"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#710',3,'match0-top.html#710',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageUser); //Load ảnh người dùng từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }

        }
        else {
            holder.imageUser.setImageResource(R.drawable.profle);
        }
        holder.textHoTen.setText(BLDiaDiemFragment.arrayListBinhLuan.get(position).getStrHoTen());
        holder.textNoiDung.setText(BLDiaDiemFragment</B></FONT>.arrayListBinhLuan.get(position).getStrNoiDung());
        if (BLDiaDiemFragment.strTaiKhoan.equals(BLDiaDiemFragment.arrayListBinhLuan.get(position).getStrTaiKhoan()))
        {
            holder.imageXoa.setVisibility(View.VISIBLE);
        }
        else {
            holder.imageXoa.setVisibility(View.GONE);
        }
        holder.imageXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa bình luận này không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            Integer intMaBinhLuan = BLDacSanFragment.arrayListBinhLuan.get(position).getIntMaBinhLuan();
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            classPublic = new ClassPublic();
                            String sqlBinhLuan = &quot;delete TB_BinhLuan where MaBinhLuan = '&quot;+intMaBinhLuan+&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlBinhLuan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa bình luận thành công&quot;);
                                BLDiaDiemFragment.fragmentTransaction = BLDiaDiemFragment.fragmentManager.beginTransaction(); //Goi lại trang loại
                                BLDiaDiemFragment.fragmentTransaction.replace(R.id.fragment_main, BLDiaDiemFragment.newInstance(BLDiaDiemFragment.mMaTinh, BLDiaDiemFragment.mTenDiaDiem, BLDiaDiemFragment.mDiaChi, BLDiaDiemFragment.mMaDiaDiem));
                                BLDiaDiemFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        return convertView;
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLKhachSanFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="711"></A><FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#711',3,'match0-top.html#711',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.BinhLuan;

import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_Home;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_View;
import com.example.travelling.KhachSan.FragmentKhachSan_Home;
import com.example.travelling.KhachSan.FragmentKhachSan_View;
import com.example.travelling.NhaHang.FragmentNhaHang_Home;
import com.example.travelling.NhaHang.FragmentNhaHang_View;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import</B></FONT> static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class BLKhachSanFragment extends Fragment {

    private static final String ARG_MaTinh = &quot;MaTinh&quot;;
    private static final String ARG_MaDiaDiem = &quot;MaDiaDiem&quot;;
    private static final String ARG_TenKhachSan = &quot;TenKhachSan&quot;;
<A NAME="712"></A>    private static final String ARG_DiaChi = &quot;DiaChi&quot;;
    private static final String ARG_TaiKhoan = &quot;TaiKhoan&quot;;
    private static final String ARG_DieuKien = &quot;DieuKien&quot;;
    public static String <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#712',3,'match0-top.html#712',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mMaTinh, mMaDiaDiem, mTenKhachSan, mDiaChi, mTaiKhoan;
    public static Integer mDieuKien;
    //Phần khai báo
    View view;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
    private SharedPreferences.Editor editor;
<A NAME="713"></A>    public static ArrayList&lt;BinhLuanClass&gt; arrayListBinhLuan;
    private BLKhachSanListView adapterBinhLuan;
    private ImageButton btnQuayLai, btnGui</B></FONT>;
    private TextView <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#713',3,'match0-top.html#713',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTenKhachSan, textDiaChi;
    private EditText editNoiDung;
    private ListView listView;
    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic();
    public static String strTaiKhoan</B></FONT>;

    public BLKhachSanFragment() {

    }

<A NAME="714"></A>    public static BLKhachSanFragment newInstance(String maTinh, String maDiaDiem, String tenKhachSan, String diaChi, String taiKhoan, Integer dieuKien) {
        BLKhachSanFragment fragment = new BLKhachSanFragment();
        Bundle args = new Bundle();
        <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#714',3,'match0-top.html#714',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_MaDiaDiem, maDiaDiem);
        args.putString(ARG_TenKhachSan, tenKhachSan);
        args.putString(ARG_DiaChi, diaChi);
        args.putString(ARG_TaiKhoan, taiKhoan);
        args.putInt(ARG_DieuKien, dieuKien);
        fragment.setArguments(args);
        return fragment;
    }</B></FONT>

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getArguments() != null) {
            mMaTinh = getArguments().getString(ARG_MaTinh);
            mMaDiaDiem = getArguments().getString(ARG_MaDiaDiem);
            mTenKhachSan = getArguments().getString(ARG_TenKhachSan);
            mDiaChi = getArguments().getString(ARG_DiaChi);
            mTaiKhoan = getArguments().getString(ARG_TaiKhoan);
            mDieuKien = getArguments().getInt(ARG_DieuKien);
        }
        else {
            mMaTinh = &quot;&quot;;
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_b_l_khach_san, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        layoutAnhXa();
<A NAME="715"></A>        return view;
    }

    private <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#715',3,'match0-top.html#715',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textTenKhachSan = view.findViewById(R.id.textTenKhachSan);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        listView = view.findViewById(R.id.listView);
        editNoiDung = view.findViewById(R.id.editNoiDung);
        btnGui = view.findViewById(R.id.btnGui);
        textTenKhachSan.setText(mTenKhachSan); //set tên địa điểm
        textDiaChi.setText(mDiaChi); //set địa chỉ
        loadDanhSachBinhLuan();
        clickButton();
    }

    private void loadDanhSachBinhLuan() {
        arrayListBinhLuan = new ArrayList&lt;&gt;();
        arrayListBinhLuan.clear();
<A NAME="716"></A>        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlBinhLuan = &quot;select MaBinhLuan, Anh, HoTen, NoiDung, TaiKhoanBinhLuan from TB_BinhLuan bl, TB_NguoiDung nd where bl.TaiKhoanBinhLuan = nd.TaiKhoan and bl.TaiKhoan = '&quot;</B></FONT> + mTaiKhoan + &quot;' order by MaBinhLuan desc&quot;;
            ResultSet <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#716',3,'match0-top.html#716',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
            if (resultSetBinhLuan != null){
                while (resultSetBinhLuan.next()){
                    arrayListBinhLuan.add(new BinhLuanClass(resultSetBinhLuan.getInt(&quot;MaBinhLuan&quot;), resultSetBinhLuan.getString(&quot;Anh&quot;),
                            resultSetBinhLuan.getString(&quot;HoTen&quot;), resultSetBinhLuan.getString(&quot;NoiDung&quot;), resultSetBinhLuan.getString(&quot;TaiKhoanBinhLuan&quot;)));
                }</B></FONT>
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        adapterBinhLuan = new BLKhachSanListView(getContext());
        listView.setAdapter(adapterBinhLuan);
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (mMaTinh.equals(&quot;&quot;)) {
                    if (mDieuKien == 1) {
                        FragmentCtyDuLich_Home fragmentCtyDuLich_home = new FragmentCtyDuLich_Home();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem);
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentCtyDuLich_home.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentCtyDuLich_home);
                    }
                    else if (mDieuKien == 2){
                        FragmentNhaHang_Home fragmentNhaHang_home = new FragmentNhaHang_Home();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem);
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentNhaHang_home.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentNhaHang_home);
                    }
                    else if (mDieuKien == 3){
                        FragmentKhachSan_Home fragmentKhachSan_home = new FragmentKhachSan_Home();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem);
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentKhachSan_home.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentKhachSan_home);
                    }
                }
                else {
                    if (mDieuKien == 1) {
                        FragmentCtyDuLich_View fragmentCtyDuLich_view = new FragmentCtyDuLich_View();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentCtyDuLich_view.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentCtyDuLich_view);
                    }
                    else if (mDieuKien == 2){
                        FragmentNhaHang_View fragmentNhaHang_view = new FragmentNhaHang_View();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentNhaHang_view.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentNhaHang_view);
                    }
                    else if (mDieuKien == 3){
                        FragmentKhachSan_View fragmentKhachSan_view = new FragmentKhachSan_View();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                        fragmentKhachSan_view.setArguments(bundleDiaDiem);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentKhachSan_view);
                    }
                }
                fragmentTransaction.commit();
            }
        });

        btnGui.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="717"></A>                if (editNoiDung.getText().length() != 0){
                    try {
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#717',3,'match0-top.html#717',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sqlBinhLuan = &quot;insert into TB_BinhLuan(TaiKhoanBinhLuan, TaiKhoan, NoiDung) values('&quot; + strTaiKhoan + &quot;', '&quot; + mTaiKhoan + &quot;', N'&quot; + editNoiDung.getText().toString() + &quot;')&quot;;
                        if (classConnect.updateData(getActivity(), sqlBinhLuan) == 1){
                            classPublic.ThongBao(getActivity(), &quot;Thông báo! Gửi thành công&quot;);
<A NAME="718"></A>                            editNoiDung.setText(&quot;&quot;);
                            loadDanhSachBinhLuan</B></FONT>();
                        }
                        <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#718',3,'match0-top.html#718',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(), &quot;Lỗi! Không gửi được&quot;);
                        }
                        classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.d(&quot;TAG&quot;, e.getMessage());
                    }</B></FONT>
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập nội dung&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLKhachSanListView.java</CENTER></H3><HR>
<PRE>
<A NAME="719"></A>package com.example.travelling.BinhLuan;

<FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#719',3,'match0-top.html#719',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;

public class BLKhachSanListView extends BaseAdapter {

    Context mContext</B></FONT>;
<A NAME="720"></A>    LayoutInflater inflater;
    ArrayList&lt;BinhLuanClass&gt; arraylist;
    ClassPublic classPublic;
    ClassConnect <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#720',3,'match0-top.html#720',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;

    public BLKhachSanListView(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="721"></A>        this.arraylist.addAll(BLKhachSanFragment.arrayListBinhLuan);
    }
    public static class</B></FONT> ViewHolder {
        ImageView <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#721',3,'match0-top.html#721',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>imageUser, imageXoa;
        TextView textHoTen, textNoiDung;
    }
    @Override
    public int getCount() {
        return BLKhachSanFragment.arrayListBinhLuan.size();
    }

    @Override
    public Object getItem(int position) {
        return BLKhachSanFragment.arrayListBinhLuan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final BLKhachSanListView.ViewHolder holder;
        if (convertView == null) {
            holder = new BLKhachSanListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_binhluan, null);
            holder.imageUser = convertView.findViewById(R.id.imageUser);
<A NAME="722"></A>            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.textNoiDung = convertView.findViewById(R.id.textNoiDung);
            holder.imageXoa = convertView</B></FONT>.findViewById(R.id.imageXoa);
            <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#722',3,'match0-top.html#722',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>convertView.setTag(holder);
        } else {
            holder = (BLKhachSanListView.ViewHolder) convertView.getTag();
        }
<A NAME="723"></A>        String strAnh = BLKhachSanFragment.arrayListBinhLuan.get(position).getStrAnh();
        if (!strAnh</B></FONT>.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#723',3,'match0-top.html#723',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
<A NAME="724"></A>            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager</B></FONT>.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#724',3,'match0-top.html#724',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageUser); //Load ảnh người dùng từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }

        }
        else {
            holder.imageUser.setImageResource(R.drawable.profle);
        }
        holder.textHoTen.setText(BLKhachSanFragment.arrayListBinhLuan.get(position).getStrHoTen());
        holder.textNoiDung.setText(BLKhachSanFragment</B></FONT>.arrayListBinhLuan.get(position).getStrNoiDung());
        if (BLKhachSanFragment.strTaiKhoan.equals(BLKhachSanFragment.arrayListBinhLuan.get(position).getStrTaiKhoan()))
        {
            holder.imageXoa.setVisibility(View.VISIBLE);
        }
        else {
            holder.imageXoa.setVisibility(View.GONE);
        }
        holder.imageXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa bình luận này không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            Integer intMaBinhLuan = BLKhachSanFragment.arrayListBinhLuan.get(position).getIntMaBinhLuan();
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            classPublic = new ClassPublic();
                            String sqlBinhLuan = &quot;delete TB_BinhLuan where MaBinhLuan = '&quot;+intMaBinhLuan+&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlBinhLuan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa bình luận thành công&quot;);
                                BLKhachSanFragment.fragmentTransaction = BLKhachSanFragment.fragmentManager.beginTransaction(); //Goi lại trang loại
                                BLKhachSanFragment.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(BLKhachSanFragment.mMaTinh, BLKhachSanFragment.mMaDiaDiem, BLKhachSanFragment.mTenKhachSan, BLKhachSanFragment.mDiaChi, BLKhachSanFragment.mTaiKhoan, BLKhachSanFragment.mDieuKien));
                                BLKhachSanFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        return convertView;
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLPhongFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="725"></A>package com.example.travelling.BinhLuan;

<FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#725',3,'match0-top.html#725',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentTourDuLich_View;
import com.example.travelling.KhachSan.FragmentPhong_View;
import com.example.travelling.NhaHang.FragmentMonAn_View;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class BLPhongFragment extends Fragment {

    //Khai báo
    private View view;
    private static final String ARG_MaTinh</B></FONT> = &quot;MaTinh&quot;;
    private static final String ARG_MaDiaDiem = &quot;MaDiaDiem&quot;;
    private static final String ARG_TenPhong = &quot;TenPhong&quot;;
<A NAME="726"></A>    private static final String ARG_TaiKhoan = &quot;TaiKhoan&quot;;
    private static final String ARG_MaPhong = &quot;MaPhong&quot;;
    private static final String ARG_DieuKien = &quot;DieuKien&quot;;
    public static String <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#726',3,'match0-top.html#726',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mMaTinh, mMaDiaDiem, mTenPhong, mTaiKhoan;
    public static Integer mMaPhong, mDieuKien;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="727"></A>    private SharedPreferences.Editor editor;
    public static ArrayList&lt;BinhLuanClass&gt; arrayListBinhLuan;
    private BLPhongListView adapterBinhLuan</B></FONT>;
    private ImageButton <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#727',3,'match0-top.html#727',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>btnQuayLai, btnGui;
    private TextView textTenPhong;
    private EditText editNoiDung;
    private ListView listView;
    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic();
    public static String strTaiKhoan</B></FONT>;

<A NAME="728"></A>    public static BLPhongFragment newInstance(String maTinh, String maDiaDiem, String tenPhong, String taiKhoan, Integer maPhong, Integer dieuKien) {
        BLPhongFragment fragment = new BLPhongFragment();
        Bundle args = new Bundle();
        <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#728',3,'match0-top.html#728',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_MaDiaDiem, maDiaDiem);
        args.putString(ARG_TenPhong, tenPhong);
        args.putString(ARG_TaiKhoan, taiKhoan);
        args.putInt(ARG_MaPhong, maPhong);
        args.putInt(ARG_DieuKien, dieuKien);
        fragment.setArguments(args);
        return fragment;
    }</B></FONT>

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getArguments() != null) {
            mMaTinh = getArguments().getString(ARG_MaTinh);
            mMaDiaDiem = getArguments().getString(ARG_MaDiaDiem);
            mTenPhong = getArguments().getString(ARG_TenPhong);
            mTaiKhoan = getArguments().getString(ARG_TaiKhoan);
            mMaPhong = getArguments().getInt(ARG_MaPhong);
            mDieuKien = getArguments().getInt(ARG_DieuKien);
<A NAME="729"></A>        }
    }

    <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#729',3,'match0-top.html#729',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_b_l_phong, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        strTaiKhoan = sharedpreferences</B></FONT>.getString(User,&quot;&quot;);
        layoutAnhXa();
        return view;
<A NAME="730"></A>    }

    private void layoutAnhXa() {
        <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#730',3,'match0-top.html#730',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textTenPhong = view.findViewById(R.id.textTenPhong);
        listView = view.findViewById(R.id.listView);
        editNoiDung = view.findViewById(R.id.editNoiDung);
        btnGui = view.findViewById(R.id.btnGui);
<A NAME="731"></A>        textTenPhong.setText(mTenPhong);
        loadDanhSachBinhLuan();
        clickButton</B></FONT>();
    <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#731',3,'match0-top.html#731',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachBinhLuan() {
        arrayListBinhLuan = new ArrayList&lt;&gt;();
        arrayListBinhLuan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlBinhLuan = &quot;select MaBinhLuan, Anh, HoTen, NoiDung, TaiKhoanBinhLuan from TB_BinhLuan bl, TB_NguoiDung nd where bl.TaiKhoanBinhLuan = nd.TaiKhoan and bl.TaiKhoan = '&quot; + mTaiKhoan + &quot;' and MaSo = '&quot;+mMaPhong+&quot;' order by MaBinhLuan desc&quot;;
            ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
            if (resultSetBinhLuan != null){
                while (resultSetBinhLuan.next()){
                    arrayListBinhLuan.add(new BinhLuanClass(resultSetBinhLuan.getInt(&quot;MaBinhLuan&quot;), resultSetBinhLuan.getString(&quot;Anh&quot;),
                            resultSetBinhLuan.getString(&quot;HoTen&quot;), resultSetBinhLuan.getString(&quot;NoiDung&quot;), resultSetBinhLuan.getString(&quot;TaiKhoanBinhLuan&quot;)));
                }
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        adapterBinhLuan = new BLPhongListView(getContext());
        listView.setAdapter(adapterBinhLuan);
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (mDieuKien == 1){
                    FragmentTourDuLich_View fragmentTourDuLich_view = new FragmentTourDuLich_View();
                    Bundle bundleDiaDiem = new Bundle();
                    bundleDiaDiem.putString(&quot;TaiKhoan&quot;, mTaiKhoan);
                    bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragmentTourDuLich_view.setArguments(bundleDiaDiem);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentTourDuLich_view);
                }
                else if (mDieuKien == 2){
                    FragmentMonAn_View fragmentMonAn_view = new FragmentMonAn_View();
                    Bundle bundleDiaDiem = new Bundle();
                    bundleDiaDiem.putString(&quot;TaiKhoan&quot;, mTaiKhoan);
                    bundleDiaDiem.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem);
                    bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragmentMonAn_view.setArguments(bundleDiaDiem);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentMonAn_view);
                }
                else if (mDieuKien == 3){
                    FragmentPhong_View fragmentPhong_view = new FragmentPhong_View();
                    Bundle bundleDiaDiem = new Bundle();
                    bundleDiaDiem.putString(&quot;TaiKhoan&quot;, mTaiKhoan);
                    bundleDiaDiem.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem);
                    bundleDiaDiem.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragmentPhong_view.setArguments(bundleDiaDiem);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentPhong_view);
                }
                fragmentTransaction.commit();
            }
        });

        btnGui.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (editNoiDung.getText().length() != 0){
                    try {
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String sqlBinhLuan = &quot;insert into TB_BinhLuan(TaiKhoanBinhLuan, TaiKhoan, MaSo, NoiDung) values('&quot; + strTaiKhoan + &quot;', '&quot; + mTaiKhoan + &quot;', '&quot;+mMaPhong+&quot;' , N'&quot; + editNoiDung.getText().toString() + &quot;')&quot;;
                        if (classConnect.updateData(getActivity(), sqlBinhLuan) == 1){
                            classPublic.ThongBao(getActivity(), &quot;Thông báo! Gửi thành công&quot;);
<A NAME="732"></A>                            editNoiDung.setText(&quot;&quot;);
                            loadDanhSachBinhLuan();
                        }
                        <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#732',3,'match0-top.html#732',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(), &quot;Lỗi! Không gửi được&quot;);
                        }
                        classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.d(&quot;TAG&quot;, e.getMessage());
                    }</B></FONT>
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập nội dung&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BLPhongListView.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.BinhLuan;
<A NAME="733"></A>
import android.annotation.SuppressLint;
import android.app.Activity;
<FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#733',3,'match0-top.html#733',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;

public class BLPhongListView extends BaseAdapter {

    Context mContext;
<A NAME="734"></A>    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;BinhLuanClass&gt; arraylist;
    ClassPublic classPublic;
    ClassConnect <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#734',3,'match0-top.html#734',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;

    public BLPhongListView(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="735"></A>        this.arraylist.addAll(BLPhongFragment.arrayListBinhLuan);
    }</B></FONT>
    public static class ViewHolder {
        ImageView <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#735',3,'match0-top.html#735',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>imageUser, imageXoa;
        TextView textHoTen, textNoiDung;
    }
    @Override
    public int getCount() {
        return BLPhongFragment.arrayListBinhLuan.size();
    }

    @Override
    public Object getItem(int position) {
        return BLPhongFragment.arrayListBinhLuan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final BLPhongListView.ViewHolder holder;
        if (convertView == null) {
            holder = new BLPhongListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_binhluan, null);
            holder.imageUser = convertView.findViewById(R.id.imageUser);
            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.textNoiDung = convertView.findViewById(R.id.textNoiDung);
<A NAME="736"></A>            holder.imageXoa = convertView</B></FONT>.findViewById(R.id.imageXoa);
            convertView.setTag(holder);
        } else {
            holder = (BLPhongListView.ViewHolder) <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#736',3,'match0-top.html#736',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>convertView.getTag();
        }
<A NAME="737"></A>        String strAnh = BLPhongFragment.arrayListBinhLuan.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh</B></FONT>.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#737',3,'match0-top.html#737',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
<A NAME="738"></A>            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager</B></FONT>.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#738',3,'match0-top.html#738',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageUser); //Load ảnh người dùng từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }

        }
        else {
            holder.imageUser.setImageResource(R.drawable.profle);
        }
        holder.textHoTen.setText(BLPhongFragment.arrayListBinhLuan.get(position).getStrHoTen());
        holder.textNoiDung.setText(BLPhongFragment</B></FONT>.arrayListBinhLuan.get(position).getStrNoiDung());
        if (BLPhongFragment.strTaiKhoan.equals(BLPhongFragment.arrayListBinhLuan.get(position).getStrTaiKhoan()))
        {
            holder.imageXoa.setVisibility(View.VISIBLE);
        }
        else {
            holder.imageXoa.setVisibility(View.GONE);
        }
        holder.imageXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa bình luận này không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            Integer intMaBinhLuan = BLPhongFragment.arrayListBinhLuan.get(position).getIntMaBinhLuan();
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            classPublic = new ClassPublic();
                            String sqlBinhLuan = &quot;delete TB_BinhLuan where MaBinhLuan = '&quot;+intMaBinhLuan+&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlBinhLuan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa bình luận thành công&quot;);
                                BLPhongFragment.fragmentTransaction = BLPhongFragment.fragmentManager.beginTransaction(); //Goi lại trang loại
                                BLPhongFragment.fragmentTransaction.replace(R.id.fragment_main, BLPhongFragment.newInstance(BLPhongFragment.mMaTinh, BLPhongFragment.mMaDiaDiem, BLPhongFragment.mTenPhong, BLPhongFragment.mTaiKhoan, BLPhongFragment.mMaPhong, BLPhongFragment.mDieuKien));
                                BLPhongFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        return convertView;
    }
}
</PRE>
<HR>
<H3><CENTER>BinhLuan\BinhLuanClass.java</CENTER></H3><HR>
<PRE>
<A NAME="686"></A><FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#686',3,'match0-top.html#686',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.BinhLuan;

public class BinhLuanClass {

    Integer intMaBinhLuan;
    String strAnh, strHoTen, strNoiDung, strTaiKhoan;

    public BinhLuanClass(Integer intMaBinhLuan, String strAnh, String strHoTen, String strNoiDung, String strTaiKhoan) {
        this.intMaBinhLuan = intMaBinhLuan;
        this.strAnh = strAnh;
        this.strHoTen = strHoTen;
        this.strNoiDung = strNoiDung;
        this.strTaiKhoan = strTaiKhoan;
    }

    public Integer getIntMaBinhLuan() {
        return intMaBinhLuan;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrHoTen() {
        return strHoTen;
    }

    public String getStrNoiDung() {
        return strNoiDung;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>Class\CircleImage.java</CENTER></H3><HR>
<PRE>
<A NAME="674"></A><FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#674',3,'match0-top.html#674',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Class;

import android.annotation.SuppressLint;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.PorterDuff;
import android.graphics.PorterDuffXfermode;
import android.graphics.Rect;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.util.AttributeSet;
import android.widget.ImageView;

@SuppressLint(&quot;AppCompatCustomView&quot;)
public class CircleImage extends ImageView {
    public CircleImage(Context context) {
        super(context);
    }

    public CircleImage(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public CircleImage(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        Drawable drawable = getDrawable();
        if (drawable == null) {
            return;
        }
        if (getWidth() == 0 || getHeight() == 0) {
            return;
        }
        Bitmap b = ((BitmapDrawable) drawable).getBitmap();
        Bitmap bitmap = b.copy(Bitmap.Config.ARGB_8888, true);
        int w = getWidth();
        Bitmap roundBitmap = getCroppedBitmap(bitmap, w);
        canvas.drawBitmap(roundBitmap, 0, 0, null);
    }

    public static Bitmap getCroppedBitmap(Bitmap bmp, int radius) {
        Bitmap sbmp;
        if (bmp.getWidth() != radius || bmp.getHeight() != radius){
            sbmp = Bitmap.createScaledBitmap(bmp, radius, radius, false);
        }
        else {
            sbmp = bmp;
        }
        Bitmap output = Bitmap.createBitmap(sbmp.getWidth(), sbmp.getHeight(), Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(output);
        final Paint paint = new Paint();
        final Rect rect = new Rect(0, 0, sbmp.getWidth(), sbmp.getHeight());
        paint.setAntiAlias(true);
        paint.setFilterBitmap(true);
        paint.setDither(true);
        canvas.drawARGB(0, 0, 0, 0);
        paint.setColor(Color.parseColor(&quot;#BAB399&quot;));
        canvas.drawCircle(sbmp.getWidth() / 2 + 0.7f,sbmp.getHeight() / 2 + 0.7f, sbmp.getWidth() / 2 + 0.1f, paint);
        paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC_IN));
        canvas.drawBitmap(sbmp, rect, rect, paint);
        return output;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>Class\ClassConnect.java</CENTER></H3><HR>
<PRE>
<A NAME="675"></A><FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#675',3,'match0-top.html#675',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Class;

import android.app.Activity;
import android.os.StrictMode;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class ClassConnect {
    private String stringHostName = &quot;137.59.106.74&quot;; //Địa chỉ IP khi kết nối internet
    private String stringDataBase = &quot;atravelling&quot;; //Tên CSDL trong SQL Server
    private String stringUser = &quot;tytravelling&quot;; //Tên đăng nhập vào SQL Server
    private String stringPass = &quot;P2w*xm74&quot;; //Mật khẩu đăng nhập vào SQL Server

    private Connection connection = null; //Khai báo biến kết nối
    private ClassPublic classPublic = new ClassPublic();

    //============Hàm kết nối=================
    public Connection CONN(Activity activity){
        try {
            StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy);
            Class.forName(&quot;net.sourceforge.jtds.jdbc.Driver&quot;).newInstance();
            //Khai báo chuỗi kết nối
            String stringURL = &quot;jdbc:jtds:sqlserver://&quot; + stringHostName + &quot;;&quot;
                    + &quot;databaseName=&quot; + stringDataBase + &quot;;user=&quot; + stringUser + &quot;;password=&quot;
                    + stringPass + &quot;;&quot;;
            connection = DriverManager.getConnection(stringURL); //Mở kết nối đến SQL Server
        } catch (SQLException se) {
            classPublic.ThongBao(activity,se.getMessage());
        } catch (ClassNotFoundException e) {
            classPublic.ThongBao(activity,e.getMessage());
        } catch (Exception e) {
            classPublic.ThongBao(activity,e.getMessage());
        }
        return connection;
    }

    //=================Hàm lấy dữ liệu=============================
    public ResultSet selectData(Activity activity, String stringSQL){
        ResultSet resultSet = null;
        try {
            connection = CONN(activity); //Mở kết nối
            Statement statement = connection.createStatement();
            resultSet = statement.executeQuery(stringSQL); //Lấy dahh sách kết quả

        } catch (Exception e){
            classPublic.ThongBao(activity,e.getMessage());
        }
        return resultSet;
    }

    //================Hàm cập nhật dữ liệu================================
    public int updateData(Activity activity, String stringSQL){
        int i;
        try {
            connection = CONN(activity); //Mở kết nối
            Statement statement = connection.createStatement();
            if (statement.executeUpdate(stringSQL) &gt; 0) {
                i = 1;
            }
            else{
                i = 0;
            }
            statement.close();
            connection.close(); //Đóng kết nối
        } catch (Exception e){
            classPublic.ThongBao(activity,e.getMessage());
            i = 0;
        }
        return i;
    }
}</B></FONT>

</PRE>
<HR>
<H3><CENTER>Class\ClassPublic.java</CENTER></H3><HR>
<PRE>
<A NAME="676"></A>package com.example.travelling.Class;

<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#676',3,'match0-top.html#676',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.os.Handler;
import android.speech.tts.TextToSpeech;
import android.util.Log;
import android.widget.ImageView;
import android.widget.Toast;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.sql.ResultSet;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.Objects;
import java.util.Random;
import android.os.Message;

public class ClassPublic {

    //Các khai báo
    private TextToSpeech tts;
    private ImageView imageView;
    private Bitmap bitmap;
    private InputStream in;
    private ClassConnect classConnect;
    String alpha</B></FONT> = &quot;abcdefghijklmnopqrstuvwxyz&quot;;
    String alphaUpperCase = alpha.toUpperCase(); // A-Z
    String digits = &quot;0123456789&quot;; // 0-9
    String ALPHA_NUMERIC = alpha + alphaUpperCase + digits;
    static final Random generator = new Random();

    //Thông báo
    public void ThongBao(Activity activity, String string){
        Toast.makeText(activity, string, Toast.LENGTH_SHORT).show();
    }
    //Đọc văn bản
    public TextToSpeech DocVanBan(Activity activity, final String st){
        tts = new TextToSpeech(activity, new TextToSpeech.OnInitListener() {
            @Override
            public void onInit(int status) {
                if (status == TextToSpeech.SUCCESS){
                    if (!st.equals(&quot;&quot;)){
                        tts.speak(st, TextToSpeech.QUEUE_FLUSH,null);
                    }
                }
                tts.setPitch(1.0f);
                tts.setSpeechRate(1.0f);
<A NAME="677"></A>            }
        });
        return tts;
    <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#677',3,'match0-top.html#677',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
    //Load ảnh từ hosting
    public void downloadImage(String urlStr, final ImageView img) {
        imageView = img;
        final String url = urlStr;
        new Thread() {
            public void run() {
                Message msg = Message.obtain();
                msg.what = 1;
                try {
                    in = openHttpConnection(url);
                    bitmap = BitmapFactory.decodeStream(in);
                    Bundle b = new Bundle();
                    b.putParcelable(&quot;bitmap&quot;, bitmap);
                    msg.setData(b);
                    in.close();
                }catch (IOException e1) {
                    e1.printStackTrace();
                }
                messageHandler.sendMessage(msg);
            }
        }.start();
    }

    private InputStream openHttpConnection(String urlStr) {
        InputStream in = null;
        int resCode;
        try {
            URL url = new URL(urlStr);
            URLConnection urlConn = url.openConnection();
            if (!(urlConn instanceof HttpURLConnection)) {
                throw new IOException(&quot;URL is not an Http URL&quot;);
            }
            HttpURLConnection httpConn = (HttpURLConnection) urlConn;
            httpConn.setAllowUserInteraction(false);
            httpConn.setInstanceFollowRedirects(true);
            httpConn.setRequestMethod(&quot;GET&quot;);
            httpConn.connect();
            resCode = httpConn.getResponseCode();
            if (resCode == HttpURLConnection.HTTP_OK) {
                in = httpConn.getInputStream();
            }
        }catch (MalformedURLException e) {
            e.printStackTrace();
        }catch (IOException e) {
            e.printStackTrace();
        }
        return in;
    }

    @SuppressLint(&quot;HandlerLeak&quot;)
    private Handler messageHandler = new Handler() {
        public void handleMessage(Message msg) {
            super.handleMessage(msg);
            imageView.setImageBitmap((msg.getData().getParcelable(&quot;bitmap&quot;)));
        }
<A NAME="678"></A>    }</B></FONT>;

    //Kiểm tra định dạng ngày tháng năm
    <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#678',3,'match0-top.html#678',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public boolean isValidDate(String date) {
        DateFormat sdf = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());
        Date testDate;
        try {

            testDate = sdf.parse(date);
        }
        catch (ParseException e) {
            return false;
        }</B></FONT>
        if (!sdf.format(Objects.requireNonNull(testDate)).equals(date)) {
            return false;
        }
        return true;
<A NAME="679"></A>    }
    //======================Tính số ngày sinh trưởng cho lúa============================
    @SuppressLint({&quot;NewApi&quot;, &quot;LocalSuppress&quot;})
    public <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#679',3,'match0-top.html#679',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String soNgay(String strNgayThaCa){
        DateFormat simpleDateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());
        Date currentDate = new Date();
        Date date1, date2;
        long getDaysDiff = 0;
        try {
            //Lấy ngày hệ thống
            String endDate = simpleDateFormat.format(currentDate);
            date2 = simpleDateFormat.parse(endDate);
            //Lấy ngày xuống giống
            date1 = simpleDateFormat</B></FONT>.parse(strNgayThaCa);
            long getDiff = Objects.requireNonNull(date2).getTime() - Objects.requireNonNull(date1).getTime();
            getDaysDiff = getDiff / (24 * 60 * 60 * 1000);
        } catch (Exception e) {
            e.printStackTrace();
        }
        return String.valueOf(getDaysDiff);
    }
<A NAME="680"></A>
    //====================Lấy loại tài khoản=============================================
    @SuppressLint(&quot;NewApi&quot;)
    public <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#680',3,'match0-top.html#680',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String layLoaiTaiKhoan(String taiKhoan, Activity activity){
        String strLoaiTaiKhoan = null;
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlLoaiTaiKhoan = &quot;select LoaiTaiKhoan from TB_NguoiDung where TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetLoaiTaiKhoan = classConnect.selectData(activity, sqlLoaiTaiKhoan);
            if (resultSetLoaiTaiKhoan != null &amp;&amp; resultSetLoaiTaiKhoan.next()){
                strLoaiTaiKhoan = resultSetLoaiTaiKhoan.getString(&quot;LoaiTaiKhoan&quot;);
            }
            classConnect.CONN(activity).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        return strLoaiTaiKhoan;
    }
<A NAME="681"></A>
    //====================Lấy mã tỉnh====================================================
    @SuppressLint(&quot;NewApi&quot;)
    public <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#681',3,'match0-top.html#681',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String layMaTinh(String taiKhoan, Activity activity){
        String strMaTinh = null;
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlMaTinh = &quot;select MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetMaTinh = classConnect.selectData(activity, sqlMaTinh);
            if (resultSetMaTinh != null &amp;&amp; resultSetMaTinh.next()){
                strMaTinh = resultSetMaTinh.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(activity).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        return strMaTinh;
    }


    public String setPass() {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i &lt; 8; i++) {
            int number = randomNumber(0, ALPHA_NUMERIC.length() - 1);
            char ch = ALPHA_NUMERIC.charAt(number);
            sb.append(ch);
        }
        return sb.toString();
    }
    public static int randomNumber(int min, int max) {
        return generator.nextInt((max - min) + 1) + min;
    }
}

</PRE>
<HR>
<H3><CENTER>Class\ConnectionReceiver.java</CENTER></H3><HR>
<PRE>
<A NAME="682"></A><FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#682',3,'match0-top.html#682',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Class;

import android.annotation.SuppressLint;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;

public class ConnectionReceiver extends BroadcastReceiver {
    @SuppressLint(&quot;UnsafeProtectedBroadcastReceiver&quot;)
    @Override
    public void onReceive(Context context, Intent intent) {
    }
    public static boolean isConnected() {
        ConnectivityManager
                cm = (ConnectivityManager) WifiApp.getInstance().getApplicationContext()
                .getSystemService(Context.CONNECTIVITY_SERVICE);
        assert cm != null;
        NetworkInfo ni = cm.getActiveNetworkInfo();
        return ni != null &amp;&amp; ni.isConnectedOrConnecting();
    }
}</B></FONT>

</PRE>
<HR>
<H3><CENTER>Class\FragmentGoogleMap.java</CENTER></H3><HR>
<PRE>
<A NAME="683"></A>package com.example.travelling.Class;

<FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#683',3,'match0-top.html#683',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import com.example.travelling.DiaDiem.FragmentChiDuong;
import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.OnMapReadyCallback;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.model.CameraPosition;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;

public class FragmentGoogleMap extends SupportMapFragment implements OnMapReadyCallback {
    private GoogleMap googleMap</B></FONT>;
    public FragmentGoogleMap()  {
        getMapAsync(this);
    }

    @Override
    public void onMapReady(final GoogleMap googleMap) {
        this.googleMap = googleMap;
        LatLng vietnam = new LatLng(FragmentChiDuong.doubleKinhDo, FragmentChiDuong.doubleViDo);
        this.googleMap.addMarker(new MarkerOptions().position(vietnam).title(FragmentChiDuong.strTenDiaDiem));
        CameraPosition cp = new CameraPosition.Builder().target(vietnam).zoom(15).build();
        googleMap.animateCamera(CameraUpdateFactory.newCameraPosition(cp));
        MarkerOptions markerOptions = new MarkerOptions();
        markerOptions.position(vietnam);
<A NAME="684"></A>        markerOptions.title(vietnam.latitude + &quot; : &quot; + vietnam.longitude);
        this.googleMap.setOnMapClickListener(new GoogleMap.OnMapClickListener() {
            @Override
            public <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#684',3,'match0-top.html#684',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void onMapClick(LatLng latLng) {
                MarkerOptions markerOptions = new MarkerOptions();
                markerOptions.position(latLng);
                markerOptions.title(latLng.latitude + &quot; : &quot; + latLng.longitude);
                // Clear previously click position.
                googleMap.clear();
                // Zoom the Marker
                googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10));
                // Add Marker on Map
                googleMap</B></FONT>.addMarker(markerOptions);
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>Class\WifiApp.java</CENTER></H3><HR>
<PRE>
<A NAME="685"></A><FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#685',3,'match0-top.html#685',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Class;

import android.annotation.SuppressLint;
import android.app.Application;

@SuppressLint(&quot;Registered&quot;)
public class WifiApp extends Application {
    static WifiApp wifiInstance;
    @Override
    public void onCreate() {
        super.onCreate();
        wifiInstance = this;
    }
    public static synchronized WifiApp getInstance() {
        return wifiInstance;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ClassCtyDuLich_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="594"></A><FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#594',3,'match0-top.html#594',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

public class ClassCtyDuLich_Home {
    Integer intGiaTour, intLuotThich, intBinhLuan;
    String strTaiKhoan, strTenCty, strDiaChi, strSoDienThoai;
    public ClassCtyDuLich_Home(String strTaiKhoan, String strTenCty, String strDiaChi, String strSoDienThoai,
                               Integer intGiaTour, Integer intLuotThich, Integer intBinhLuan){
        this.strTaiKhoan = strTaiKhoan;
        this.strTenCty = strTenCty;
        this.strDiaChi = strDiaChi;
        this.strSoDienThoai = strSoDienThoai;
        this.intGiaTour = intGiaTour;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrTenCty() {
        return strTenCty;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public Integer getIntGiaTour() {
        return intGiaTour;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ClassCtyDuLich_View.java</CENTER></H3><HR>
<PRE>
<A NAME="595"></A><FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#595',3,'match0-top.html#595',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

public class ClassCtyDuLich_View {
    private Integer intLuotThich, intBinhLuan;
    private String strTaiKhoan, strCtyDuLich, strSoDienThoai, strEmail, strDiaChi;
    public ClassCtyDuLich_View(String strTaiKhoan, String strCtyDuLich, String strSoDienThoai,
                               String strEmail, String strDiaChi, Integer intLuotThich, Integer intBinhLuan){
        this.strTaiKhoan = strTaiKhoan;
        this.strCtyDuLich = strCtyDuLich;
        this.strSoDienThoai = strSoDienThoai;
        this.strEmail = strEmail;
        this.strDiaChi = strDiaChi;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrCtyDuLich() {
        return strCtyDuLich;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public String getStrEmail() {
        return strEmail;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ClassTourDuLich_Edit.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.CtyDuLich;

public class ClassTourDuLich_Edit {

    Integer intMaTour, intGiaTour;
    private String strNoiDi, strTenTinh, strMaDiaDiem, strTenDiaDiem, strDiaChiDen;

    public ClassTourDuLich_Edit(Integer intMaTour, String strNoiDi, String strTenTinh, String strMaDiaDiem,
<A NAME="596"></A>                                String strTenDiaDiem, String strDiaChiDen, Integer intGiaTour){
        this.intMaTour = intMaTour;
        this.strNoiDi = strNoiDi;
        <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#596',3,'match0-top.html#596',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strTenTinh = strTenTinh;
        this.strMaDiaDiem = strMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strDiaChiDen = strDiaChiDen;
        this.intGiaTour = intGiaTour;
    }

    public Integer getIntMaTour() {
        return intMaTour;
    }

    public String getStrNoiDi() {
        return strNoiDi;
    }

    public String getStrTenTinh() {
        return strTenTinh;
    }

    public String getStrMaDiaDiem() {
        return strMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }</B></FONT>

    public String getStrDiaChiDen() {
        return strDiaChiDen;
    }

    public Integer getIntGiaTour() {
        return intGiaTour;
    }
}
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ClassTourDuLich_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.CtyDuLich;
<A NAME="597"></A>
public class ClassTourDuLich_View {

    Integer <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#597',3,'match0-top.html#597',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>intMaTour, intGiaTour, intLuotThich, intBinhLuan;
    String strTenTinh, strTenDiaDiem, strDiaChiDen, strTaiKhoan;

    public ClassTourDuLich_View(Integer intMaTour, String strTenTinh, String strTenDiaDiem, String strDiaChiDen,
                                Integer intGiaTour, Integer intLuotThich, Integer intBinhLuan, String strTaiKhoan){
        this.intMaTour = intMaTour;
        this.strTenTinh = strTenTinh;
        this.strTenDiaDiem = strTenDiaDiem;
<A NAME="598"></A>        this.strDiaChiDen = strDiaChiDen;
        this.intGiaTour = intGiaTour;
        this</B></FONT>.intLuotThich = intLuotThich;
        <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#598',3,'match0-top.html#598',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.intBinhLuan = intBinhLuan;
        this.strTaiKhoan = strTaiKhoan;
    }

    public Integer getIntMaTour() {
        return intMaTour;
    }

    public String getStrTenTinh() {
<A NAME="599"></A>        return strTenTinh;
    }</B></FONT>

    public <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#599',3,'match0-top.html#599',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrDiaChiDen() {
        return strDiaChiDen;
    }

    public Integer getIntGiaTour() {
        return intGiaTour;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\FragmentCtyDuLich_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="600"></A><FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#600',3,'match0-top.html#600',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentCtyDuLich_Home extends Fragment implements SearchView.OnQueryTextListener{

    //Khai báo
    View view;
    ImageButton btnQuayLai;
    TextView textDiaDiem;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
    public static String strMaDiaDiem, strMaTinh, strNoiDi, strTaiKhoan</B></FONT>;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();
    public static ArrayList&lt;ClassCtyDuLich_Home&gt; arrayListCtyDuLich;
    ListViewCtyDuLich_Home adapterCtyDuLich;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="601"></A>    SharedPreferences.Editor editor;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();

    <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#601',3,'match0-top.html#601',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_danhsach_cty_view, container, false);
<A NAME="602"></A>        sharedpreferences</B></FONT> = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(<FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#602',3,'match0-top.html#602',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;);
            strMaTinh = bundle</B></FONT>.getString(&quot;MaTinh&quot;);
        }
        else {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        strNoiDi = classPublic.layMaTinh(strTaiKhoan, getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
<A NAME="603"></A>    }

    private void layoutAnhXa() {
        <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#603',3,'match0-top.html#603',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view.findViewById(R.id.listView);
        layTenDiaDiem(strMaDiaDiem); //Lấy tên địa điểm du lịch
        loadHienThi();
        clickButton</B></FONT>();
<A NAME="604"></A>    }

    private void loadHienThi() {
        <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#604',3,'match0-top.html#604',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    loadDanhSachCty(strMaDiaDiem, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
<A NAME="605"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void layTenDiaDiem(String maDiaDiem) {
        <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#605',3,'match0-top.html#605',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select TenDiaDiem from TB_DiaDiem where MaDiaDiem = '&quot;+ maDiaDiem +&quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()){
                textDiaDiem.setText(resultSetDiaDiem</B></FONT>.getString(&quot;TenDiaDiem&quot;).toUpperCase());
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachCty(String maDiaDiem, String hienThi) {
        arrayListCtyDuLich = new ArrayList&lt;&gt;();
        arrayListCtyDuLich.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlCtyDuLich;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlCtyDuLich = &quot;select TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, SoDienThoai, GiaTour, nd.LuotThich &quot; +
                        &quot;from TB_NguoiDung nd, TB_TourDuLich dl, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = dl.TaiKhoan and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa &quot; +
                        &quot;and dl.NoiDen = '&quot; + maDiaDiem + &quot;' and nd.LoaiTaiKhoan = 3 order by dl.GiaTour asc&quot;;
            }
            else {
                sqlCtyDuLich = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, SoDienThoai, GiaTour, nd.LuotThich &quot; +
                        &quot;from TB_NguoiDung nd, TB_TourDuLich dl, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = dl.TaiKhoan and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa &quot; +
                        &quot;and dl.NoiDen = '&quot; + maDiaDiem + &quot;' and nd.LoaiTaiKhoan = 3 order by dl.GiaTour asc&quot;;
            }
            ResultSet resultSetCtyDuLich = classConnect.selectData(getActivity(), sqlCtyDuLich);
            if (resultSetCtyDuLich != null){
                while (resultSetCtyDuLich.next()){
                    String strDiaChi = resultSetCtyDuLich.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetCtyDuLich.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetCtyDuLich.getString(&quot;TenTinh&quot;));
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetCtyDuLich.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="606"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListCtyDuLich.add(new ClassCtyDuLich_Home(<FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#606',3,'match0-top.html#606',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetCtyDuLich.getString(&quot;TaiKhoan&quot;), resultSetCtyDuLich.getString(&quot;CongTy&quot;), strDiaChi,
                            resultSetCtyDuLich.getString(&quot;SoDienThoai&quot;), Integer.parseInt(resultSetCtyDuLich.getString(&quot;GiaTour&quot;)),Integer.parseInt(resultSetCtyDuLich.getString(&quot;LuotThich&quot;)), intBinhLuan));
                }
            }
            if (arrayListCtyDuLich.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách cty du lịch&quot;);
<A NAME="607"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log</B></FONT>.e(&quot;TAG&quot;, <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#607',3,'match0-top.html#607',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterCtyDuLich = new ListViewCtyDuLich_Home(getContext());
        listView.setAdapter(adapterCtyDuLich);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterCtyDuLich.filter(newText);
        return false;
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (strMaTinh.equals(&quot;&quot;)){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else {
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>CtyDuLich\FragmentCtyDuLich_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.CtyDuLich;

<A NAME="608"></A>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
<FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#608',3,'match0-top.html#608',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentCtyDuLich_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();
    public static FragmentManager fragmentManager</B></FONT>; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    SearchView searchView;
    Spinner cmdTinh, cmdHienThi;
<A NAME="609"></A>    ListView listView;
    public static ArrayList&lt;ClassCtyDuLich_View&gt; arrayListCtyDuLich;
    ListViewCtyDuLich_View adapterCtyDuLich;
    ArrayList&lt;<FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#609',3,'match0-top.html#609',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    public static String strMaTinh;
    String strGanMaTinh, strHienThi, mMaTinh;
    int intDieuKien</B></FONT> = 0;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="610"></A>    SharedPreferences.Editor editor;


    <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#610',3,'match0-top.html#610',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
<A NAME="611"></A>        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_ctydulich_view, container, false);
        fragmentManager</B></FONT> = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#611',3,'match0-top.html#611',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        Bundle bundle = this.getArguments();
        if</B></FONT> (bundle != null) {
            strGanMaTinh = bundle.getString(&quot;MaTinh&quot;); //Lấy mã tỉnh được gửi qua từ FragmentTourDuLich_View
        }
        else {
            strGanMaTinh = &quot;&quot;;
        }
        mMaTinh = classPublic.layMaTinh(sharedpreferences.getString(User,&quot;&quot;), getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
<A NAME="612"></A>    }

    private void layoutAnhXa() {
        <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#612',3,'match0-top.html#612',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        loadTinh(); //Load danh sách tỉnh
        loadHienThi();
    }</B></FONT>
<A NAME="613"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#613',3,'match0-top.html#613',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
<A NAME="614"></A>                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            if(<FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#614',3,'match0-top.html#614',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaTinh.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    if (strGanMaTinh.equals(&quot;&quot;) &amp;&amp; intDieuKien == 0){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        intDieuKien = 1;
                    }
                    if (!strGanMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(strGanMaTinh));
                        strGanMaTinh = &quot;&quot;;
                    }
<A NAME="615"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachCtyDuLich(strMaTinh, strHienThi);
                }
            <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#615',3,'match0-top.html#615',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
<A NAME="616"></A>    }

    private void</B></FONT> loadHienThi() {
        <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#616',3,'match0-top.html#616',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="617"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(<FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#617',3,'match0-top.html#617',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachCtyDuLich(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?</B></FONT>&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachCtyDuLich(String maTinh, String hienThi) {
        arrayListCtyDuLich = new ArrayList&lt;&gt;();
        arrayListCtyDuLich.clear();
        if (!maTinh.equals(&quot;&quot;)){
            try{
                classConnect = new ClassConnect(); //Mở kết nối đến SQL
                String sqlCtyDuLich;
                if (hienThi.equals(&quot;Tất cả&quot;)) {
                    sqlCtyDuLich = &quot;select TenXa, TenHuyen, TenTinh, TaiKhoan, CongTy, SoDienThoai, Email, LuotThich &quot; +
                            &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh &quot; +
                            &quot;and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 3 order by LuotThich desc&quot;;
                }
                else {
                    sqlCtyDuLich = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, TaiKhoan, CongTy, SoDienThoai, Email, LuotThich &quot; +
                            &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh &quot; +
                            &quot;and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 3 order by LuotThich desc&quot;;
                }
                ResultSet resultSetCtyDuLich = classConnect.selectData(getActivity(), sqlCtyDuLich);
                if (resultSetCtyDuLich != null){
                    while (resultSetCtyDuLich.next()){
                        String strDiaChi = resultSetCtyDuLich.getString(&quot;TenXa&quot;);
                        strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetCtyDuLich.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetCtyDuLich.getString(&quot;TenTinh&quot;));
                        int intBinhLuan = 0;
                        String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetCtyDuLich.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                        ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="618"></A>                        if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                            intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                        }
                        arrayListCtyDuLich.add(new ClassCtyDuLich_View(<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#618',3,'match0-top.html#618',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetCtyDuLich.getString(&quot;TaiKhoan&quot;), resultSetCtyDuLich.getString(&quot;CongTy&quot;),
                                resultSetCtyDuLich.getString(&quot;SoDienThoai&quot;), resultSetCtyDuLich.getString(&quot;Email&quot;), strDiaChi, Integer.parseInt(resultSetCtyDuLich.getString(&quot;LuotThich&quot;)), intBinhLuan));
                    }
                }
                if (arrayListCtyDuLich.isEmpty()){
                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách cty du lịch&quot;);
                }
                classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
            }catch (Exception e){
                Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
<A NAME="619"></A>            }
        }

        <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#619',3,'match0-top.html#619',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>adapterCtyDuLich = new ListViewCtyDuLich_View(getContext());
        listView.setAdapter(adapterCtyDuLich);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterCtyDuLich.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\FragmentTourDuLich_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="620"></A><FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#620',3,'match0-top.html#620',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;
import static java.util.Objects.requireNonNull;

public class FragmentTourDuLich_Edit extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;
    Spinner cmdHienThi;
    SearchView searchView;
    ImageButton btnThemMoi;
    ListView listView;
<A NAME="621"></A>    public static ArrayList&lt;ClassTourDuLich_Edit&gt; arrayListTourDuLich;
    ListViewTourDuLich_Edit adapterTourDuLich;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    String strTaiKhoan, <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#621',3,'match0-top.html#621',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaTinh, strHienThi;
    TextView textTieuDe;
    EditText editMaTour, editGiaTour;
    Spinner cmdTinh, cmdDiaDiem;
    Button btnLuuLai, btnXoa, btnDong;
    Integer intDieuKienGan;
    String strNoiDi, strMaTinh, strTenTinh, strMaDiaDiem, ganTenTinh, ganMaDiaDiem;
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaDiaDiem = new ArrayList&lt;&gt;(); //Khai báo danh sách địa điểm
    ArrayList&lt;String&gt; listTenDiaDiem = new ArrayList</B></FONT>&lt;&gt;();

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="622"></A>    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_tourdulich_edit, container, false);
        sharedpreferences = <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#622',3,'match0-top.html#622',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        strNoiDi = classPublic.layMaTinh(strTaiKhoan, getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="623"></A>        return view;
    }</B></FONT>

    private <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#623',3,'match0-top.html#623',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
<A NAME="624"></A>        listView = view.findViewById(R.id.listView);
        ganMaDiaDiem</B></FONT> = &quot;&quot;; //Điều kiện gán dữ liệu cho tỉnh và địa điểm
        ganTenTinh = &quot;&quot;;
        <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#624',3,'match0-top.html#624',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadHienThi();
        clickButton();
        clickListView();
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi</B></FONT>.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
<A NAME="625"></A>        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#625',3,'match0-top.html#625',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachTourDuLich(strTaiKhoan, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachTourDuLich(String taiKhoan, String hienThi) {
        arrayListTourDuLich = new ArrayList&lt;&gt;();
        arrayListTourDuLich.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTourDuLich;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlTourDuLich = &quot;select MaTour, NoiDi, TenTinh, NoiDen, TenDiaDiem, DiaChiDen, GiaTour &quot; +
                        &quot;from TB_TourDuLich dl, TB_Tinh t, TB_DiaDiem dd where dl.NoiDi = t.MaTinh and &quot; +
                        &quot;dl.NoiDen = dd.MaDiaDiem and dl.TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
            else {
                sqlTourDuLich = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaTour, NoiDi, TenTinh, NoiDen, TenDiaDiem, DiaChiDen, GiaTour &quot; +
<A NAME="626"></A>                        &quot;from TB_TourDuLich dl, TB_Tinh t, TB_DiaDiem dd where dl.NoiDi = t.MaTinh and &quot; +
                        &quot;dl.NoiDen = dd.MaDiaDiem and dl.TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
            ResultSet <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#626',3,'match0-top.html#626',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetTourDuLich = classConnect.selectData(getActivity(), sqlTourDuLich);
            if (resultSetTourDuLich != null){
                while (resultSetTourDuLich.next()){
                    arrayListTourDuLich.add(new ClassTourDuLich_Edit(Integer.parseInt(resultSetTourDuLich.getString(&quot;MaTour&quot;)),
                            resultSetTourDuLich.getString(&quot;NoiDi&quot;), resultSetTourDuLich.getString(&quot;TenTinh&quot;), resultSetTourDuLich.getString(&quot;NoiDen&quot;),
                            resultSetTourDuLich.getString(&quot;TenDiaDiem&quot;), resultSetTourDuLich.getString(&quot;DiaChiDen&quot;),
                            Integer.parseInt(resultSetTourDuLich.getString(&quot;GiaTour&quot;))));
                }
            }
            if (arrayListTourDuLich.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách tour du lịch&quot;);
            }
<A NAME="627"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#627',3,'match0-top.html#627',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterTourDuLich = new ListViewTourDuLich_Edit(getContext());
        listView.setAdapter(adapterTourDuLich);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterTourDuLich.filter(newText);
        return false;
    }</B></FONT>

    private void clickButton() {
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                updateTourDuLich(-1);
            }
        });
    }

    private void clickListView() {
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
<A NAME="628"></A>                updateTourDuLich(position);
            }
        });
    <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#628',3,'match0-top.html#628',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void updateTourDuLich(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_tourdulich, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaTour = alertLayout.findViewById(R.id.editMaTour);
        cmdTinh = alertLayout.findViewById(R.id.cmdTinh);
        cmdDiaDiem = alertLayout.findViewById(R.id.cmdDiaDiem);
        editGiaTour = alertLayout.findViewById(R.id.editGiaTour);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
<A NAME="629"></A>        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout</B></FONT>.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#629',3,'match0-top.html#629',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
<A NAME="630"></A>        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI TOUR DU LỊCH&quot;</B></FONT>;
            <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#630',3,'match0-top.html#630',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT TOUR DU LỊCH&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaTour.setText(String.valueOf(arrayListTourDuLich</B></FONT>.get(intChiSo).getIntMaTour())); //Gán giá trị mã tour du lịch
            ganTenTinh = arrayListTourDuLich.get(intChiSo).getStrDiaChiDen(); //Gán giá trị địa chỉ đến
            ganMaDiaDiem = arrayListTourDuLich.get(intChiSo).getStrMaDiaDiem(); //Gán giá trị mã địa điểm
            editGiaTour.setText(String.valueOf(arrayListTourDuLich.get(intChiSo).getIntGiaTour()));
        }
        loadTinh();
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
<A NAME="631"></A>            @Override
            public void onClick(View v) {
                try {
                    <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#631',3,'match0-top.html#631',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (!listMaDiaDiem.isEmpty()) {
                        if (editGiaTour.getText().length() != 0){
                            String sqlTourDuLich;
                            if (intChiSo == -1){ //Thêm mới
                                sqlTourDuLich = &quot;insert into TB_TourDuLich(TaiKhoan, NoiDi, NoiDen, DiaChiDen, GiaTour) &quot; +
                                        &quot;values ('&quot;+ strTaiKhoan +&quot;', '&quot;+ strNoiDi +&quot;', '&quot;+ strMaDiaDiem +&quot;', N'&quot;+ strTenTinh +&quot;', '&quot;+ Integer.parseInt(editGiaTour</B></FONT>.getText().toString()) +&quot;')&quot;;
<A NAME="632"></A>                            }
                            else { //Cập nhật
                                sqlTourDuLich = &quot;update TB_TourDuLich set NoiDi = '&quot;+ strNoiDi +&quot;', NoiDen = '&quot;+ strMaDiaDiem +&quot;', DiaChiDen = N'&quot;+ strTenTinh +&quot;', &quot; +
                                        &quot;GiaTour = '&quot;+ Integer.parseInt(<FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#632',3,'match0-top.html#632',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editGiaTour.getText().toString())+&quot;' &quot; +
                                        &quot;where MaTour = '&quot;+ Integer.parseInt(editMaTour.getText().toString()) +&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlTourDuLich) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tour du lịch thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tour du lịch thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachTourDuLich</B></FONT>(strTaiKhoan, strHienThi); //Load lại danh sách
                            }
<A NAME="633"></A>                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }
                            <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#633',3,'match0-top.html#633',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập giá tour du lịch&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn địa điểm&quot;);
                    }</B></FONT>
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="634"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#634',3,'match0-top.html#634',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaTour.getText().length() != 0) {
                    dialogXoa(editMaTour.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity</B></FONT>(),&quot;Lỗi! Không tìm thấy mã tour du lịch để xóa&quot;);
                }
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="635"></A>                dialog.cancel();
            }
        });
        <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#635',3,'match0-top.html#635',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách tỉnh
    }

    private void dialogXoa(final String maTour){
        //Hiện hộp thoại thông báo xóa tour du lịch
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TOUR DU LỊCH&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa tour du lịch này không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="636"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#636',3,'match0-top.html#636',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlTourDuLich = &quot;delete TB_TourDuLich where MaTour = '&quot;+ maTour +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlTourDuLich) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tour du lịch thành công&quot;);
                        loadDanhSachTourDuLich(strTaiKhoan, strHienThi); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tour du lịch&quot;);
                    }</B></FONT>
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
<A NAME="637"></A>        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#637',3,'match0-top.html#637',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
<A NAME="638"></A>        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect</B></FONT>.selectData(<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#638',3,'match0-top.html#638',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
<A NAME="639"></A>                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#639',3,'match0-top.html#639',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị địa điểm
            listMaDiaDiem.clear(); // Xóa danh sách địa điểm
            listTenDiaDiem.clear();
            ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenDiaDiem);
            dataDiaDiem.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdDiaDiem.setAdapter(dataDiaDiem);
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
                    strTenTinh = listTenTinh.get(position);
                    if (!ganTenTinh.equals(&quot;&quot;)){
<A NAME="640"></A>                        cmdTinh.setSelection(listTenTinh.indexOf(ganTenTinh));
                        strMaTinh = listMaTinh.get(listTenTinh.indexOf(ganTenTinh));
                        strTenTinh = ganTenTinh;
                        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#640',3,'match0-top.html#640',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganTenTinh = &quot;&quot;;
                    }
                    loadDiaDiem(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDiaDiem(String maTinh){ //Danh sách địa điểm du lịch
        listMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
        listTenDiaDiem.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem from TB_DiaDiem where MaTinh = '&quot; + maTinh + &quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null) {
                while (resultSetDiaDiem.next()) {
                    listMaDiaDiem.add(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;));
                    listTenDiaDiem.add(resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;));
                }
                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listTenDiaDiem);
                dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdDiaDiem.setAdapter(dataDiaDiem);
<A NAME="641"></A>            }
            if (listMaDiaDiem.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
            <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#641',3,'match0-top.html#641',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        } catch (Exception e) {
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdDiaDiem.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaDiaDiem.isEmpty()) {
                    strMaDiaDiem = listMaDiaDiem.get(position);
<A NAME="642"></A>                    if (!ganMaDiaDiem.equals(&quot;&quot;)) {
                        cmdDiaDiem.setSelection(listMaDiaDiem.indexOf(ganMaDiaDiem));
                        strMaDiaDiem</B></FONT> = ganMaDiaDiem;
                        <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#642',3,'match0-top.html#642',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaDiaDiem = &quot;&quot;;
                    }
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\FragmentTourDuLich_View.java</CENTER></H3><HR>
<PRE>
<A NAME="643"></A><FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#643',3,'match0-top.html#643',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentTourDuLich_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
<A NAME="644"></A>    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    public static FragmentManager <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#644',3,'match0-top.html#644',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    ImageButton btnQuayLai, btnLienHe;
    TextView textTenCty, textDiaChi;
    Spinner cmdHienThi;
    SearchView searchView;
<A NAME="645"></A>    ListView listView</B></FONT>;
    public static ArrayList&lt;ClassTourDuLich_View&gt; arrayListTourDuLich;
    ListViewTourDuLich_View adapterTourDuLich;
    ArrayList&lt;String&gt; listHienThi = new <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#645',3,'match0-top.html#645',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ArrayList&lt;&gt;();
    public static String strTaiKhoan, strMaTinh, strSoDienThoai, strTenCty;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_tourdulich_view, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if</B></FONT> (bundle != null) {
            strTaiKhoan = bundle.getString(&quot;TaiKhoan&quot;); //Lấy tài khoản được gửi qua từ FragmentCtyDuLich_View
            strMaTinh = bundle.getString(&quot;MaTinh&quot;); //Lấy mã tỉnh được gửi qua từ FragmentCtyDuLich_View
        }
        else {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="646"></A>        return view;
    }

    private <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#646',3,'match0-top.html#646',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnLienHe = view.findViewById(R.id.btnLienHe);
        textTenCty = view.findViewById(R.id.textTenCty);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view.findViewById(R.id.listView);
        layTenCty(strTaiKhoan);
        loadHienThi();
        clickButton();
<A NAME="647"></A>    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#647',3,'match0-top.html#647',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layTenCty(String taiKhoan) {
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTenCty = &quot;select CongTy, TenXa, TenHuyen, TenTinh, SoDienThoai from TB_NguoiDung nd, TB_Xa x, TB_Huyen h, TB_Tinh t &quot; +
                    &quot;where nd.MaXa = x.MaXa and nd.MaHuyen = h.MaHuyen and nd.MaTinh = t.MaTinh and LoaiTaiKhoan = 3 and TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetTenCty = classConnect.selectData(getActivity(), sqlTenCty);
            if (resultSetTenCty != null &amp;&amp; resultSetTenCty.next()){
                strTenCty = resultSetTenCty</B></FONT>.getString(&quot;CongTy&quot;).toUpperCase();
                textTenCty.setText(strTenCty);
                String strDiaChi = resultSetTenCty.getString(&quot;TenXa&quot;);
                strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetTenCty.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetTenCty.getString(&quot;TenTinh&quot;));
                textDiaChi.setText(strDiaChi);
                strSoDienThoai = resultSetTenCty.getString(&quot;SoDienThoai&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
<A NAME="648"></A>    }

    private void loadHienThi() {
        <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#648',3,'match0-top.html#648',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    loadDanhSachTourDuLich(strTaiKhoan, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachTourDuLich(String taiKhoan, String hienThi) {
        arrayListTourDuLich = new ArrayList&lt;&gt;();
        arrayListTourDuLich.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTourDuLich;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlTourDuLich = &quot;select MaTour, TenTinh, TenDiaDiem, DiaChiDen, GiaTour, dl.LuotThich from TB_TourDuLich dl, TB_Tinh t, TB_DiaDiem dd &quot; +
                        &quot;where dl.NoiDi = t.MaTinh and dl.NoiDen = dd.MaDiaDiem and dl.TaiKhoan = '&quot; + taiKhoan + &quot;' order by dl.GiaTour asc&quot;;
            }
            else {
                sqlTourDuLich = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaTour, TenTinh, TenDiaDiem, DiaChiDen, GiaTour, dl.LuotThich from TB_TourDuLich dl, TB_Tinh t, TB_DiaDiem dd &quot; +
                        &quot;where dl.NoiDi = t.MaTinh and dl.NoiDen = dd.MaDiaDiem and dl.TaiKhoan = '&quot; + taiKhoan + &quot;' order by dl.GiaTour asc&quot;;
            }
            ResultSet resultSetTourDuLich = classConnect.selectData(getActivity(), sqlTourDuLich);
            if (resultSetTourDuLich != null){
                while (resultSetTourDuLich.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+taiKhoan+&quot;' and MaSo = '&quot;+resultSetTourDuLich.getInt(&quot;MaTour&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="649"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListTourDuLich.add(new ClassTourDuLich_View(<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#649',3,'match0-top.html#649',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetTourDuLich.getInt(&quot;MaTour&quot;), resultSetTourDuLich.getString(&quot;TenTinh&quot;),
                            resultSetTourDuLich.getString(&quot;TenDiaDiem&quot;), resultSetTourDuLich.getString(&quot;DiaChiDen&quot;),
                            resultSetTourDuLich.getInt(&quot;GiaTour&quot;), resultSetTourDuLich.getInt(&quot;LuotThich&quot;), intBinhLuan, taiKhoan));
                }
            }
            if (arrayListTourDuLich.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách tour du lịch&quot;);
<A NAME="650"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch</B></FONT> (Exception e){
            Log.e(&quot;TAG&quot;, <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#650',3,'match0-top.html#650',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterTourDuLich = new ListViewTourDuLich_View(getContext());
        listView.setAdapter(adapterTourDuLich);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên tour du lịch
        adapterTourDuLich.filter(newText);
        return false;
    }

    private void clickButton() {
<A NAME="651"></A>        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#651',3,'match0-top.html#651',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                FragmentCtyDuLich_View fragment = new FragmentCtyDuLich_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;TaiKhoan&quot;, strTaiKhoan);
                bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                fragment.setArguments(bundle);
                fragmentTransaction.replace(R.id.fragment_main, fragment);
                fragmentTransaction.commit();
            }</B></FONT>
        });

        btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (strSoDienThoai.length() != 0) {
                    //Hiện hộp thoại thông báo
                    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
                    builder.setTitle(&quot;THÔNG BÁO&quot;);
                    builder.setMessage(&quot;Bạn muốn gọi cho &quot; + strTenCty);
                    builder.setCancelable(false);
                    builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                        @SuppressLint(&quot;NewApi&quot;)
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            Objects.requireNonNull(getActivity()).startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + strSoDienThoai)));
                        }
                    });
                    builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            //Đóng hộp thoại thông báo
                            dialogInterface.dismiss();
                        }
                    });
                    AlertDialog alertDialog = builder.create();
                    alertDialog.show();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ListViewCtyDuLich_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="652"></A>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
<FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#652',3,'match0-top.html#652',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewCtyDuLich_Home extends BaseAdapter {
    private Context mContext;
    private LayoutInflater inflater</B></FONT>;
    private ArrayList&lt;ClassCtyDuLich_Home&gt; arraylist;
<A NAME="653"></A>    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic();

    public <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#653',3,'match0-top.html#653',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ListViewCtyDuLich_Home(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentCtyDuLich_Home.arrayListCtyDuLich);
    }
    public static class ViewHolder {
        TextView textTenCty, textDiaChi, textSoDienThoai, textGiaTour, textLuotThich, textBinhLuan;
        ImageButton btnLienHe, btnLike, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentCtyDuLich_Home.arrayListCtyDuLich.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewCtyDuLich_Home.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewCtyDuLich_Home.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_danhsach_cty_view, null);
            holder.textTenCty = convertView.findViewById(R.id.textTenCty);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.textSoDienThoai = convertView.findViewById(R.id.textSoDienThoai);
            holder.textGiaTour = convertView.findViewById(R.id.textGiaTour);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnLienHe = convertView.findViewById(R.id.btnLienHe);
            holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
<A NAME="654"></A>            holder = (ListViewCtyDuLich_Home.ViewHolder) convertView.getTag();
        }</B></FONT>

        <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#654',3,'match0-top.html#654',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTenCty.setText((position + 1) + &quot;. &quot; + FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrTenCty());
        holder.textDiaChi.setText(FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrDiaChi());
        holder.textSoDienThoai.setText(&quot;Số điện thoại: &quot;+ FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrSoDienThoai());
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        holder.textGiaTour.setText(&quot;Giá tour: &quot; + formatter.format(FragmentCtyDuLich_Home</B></FONT>.arrayListCtyDuLich.get(position).getIntGiaTour()) + &quot;đ&quot;);
        final Integer[] intThich = {FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="655"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#655',3,'match0-top.html#655',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position) != null) {
                    if (FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrTenCty());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="656"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#656',3,'match0-top.html#656',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

        holder.btnLike.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String strMaDiaDiem = FragmentCtyDuLich_Home.strMaDiaDiem;
                String strTaiKhoan = FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrTaiKhoan();
                String strTenCty = FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrTenCty();
                String strDiaChi = FragmentCtyDuLich_Home.arrayListCtyDuLich.get(position).getStrDiaChi();
                FragmentCtyDuLich_Home.fragmentTransaction = FragmentCtyDuLich_Home.fragmentManager.beginTransaction();
                FragmentCtyDuLich_Home.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(&quot;&quot;, strMaDiaDiem, strTenCty, strDiaChi, strTaiKhoan,1));
                FragmentCtyDuLich_Home.fragmentTransaction.commit();
<A NAME="657"></A>            }
        });

        <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#657',3,'match0-top.html#657',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentCtyDuLich_Home.arrayListCtyDuLich.clear();
        if (charText.length() == 0) {
            FragmentCtyDuLich_Home.arrayListCtyDuLich.addAll(arraylist);
        } else {
            for (ClassCtyDuLich_Home wp : arraylist) {
                if (wp.getStrTenCty().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentCtyDuLich_Home</B></FONT>.arrayListCtyDuLich.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ListViewCtyDuLich_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
<A NAME="658"></A>import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
<FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#658',3,'match0-top.html#658',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewCtyDuLich_View extends BaseAdapter {
    private Context mContext;
    private LayoutInflater inflater;
    private ArrayList&lt;ClassCtyDuLich_View&gt; arraylist;
    private ClassConnect classConnect;
    private ClassPublic classPublic = new ClassPublic();
    public ListViewCtyDuLich_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="659"></A>        this.arraylist.addAll(FragmentCtyDuLich_View.arrayListCtyDuLich);
    }
    public static class ViewHolder {
        TextView textCtyDuLich, textSoDienThoai</B></FONT>, <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#659',3,'match0-top.html#659',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textEmail, textDiaChi, textLuotThich, textBinhLuan;
        ImageButton btnDanhSach, btnLienHe, btnLike, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentCtyDuLich_View.arrayListCtyDuLich.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentCtyDuLich_View.arrayListCtyDuLich.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewCtyDuLich_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewCtyDuLich_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_ctydulich_view, null);
            holder.textCtyDuLich = convertView.findViewById(R.id.textCtyDuLich);
            holder.textSoDienThoai = convertView.findViewById(R.id.textSoDienThoai);
            holder.textEmail = convertView.findViewById(R.id.textEmail);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
<A NAME="660"></A>            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnDanhSach = convertView.findViewById(R.id.btnDanhSach);
            holder.btnLienHe = convertView</B></FONT>.findViewById(R.id.btnLienHe);
            <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#660',3,'match0-top.html#660',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
<A NAME="661"></A>            holder = (ListViewCtyDuLich_View.ViewHolder) convertView.getTag();
        }</B></FONT>

        <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#661',3,'match0-top.html#661',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textCtyDuLich.setText((position + 1) + &quot;. &quot; + FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrCtyDuLich().toUpperCase());
        holder.textSoDienThoai.setText(&quot;Điện thoại: &quot; + FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrSoDienThoai());
        holder.textEmail.setText(&quot;Email: &quot; + FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrEmail());
        holder.textDiaChi.setText(FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrDiaChi());
        final Integer[] intThich = {FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder</B></FONT>.textBinhLuan.setText(FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

        holder.btnDanhSach.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="662"></A>            public void onClick(View v) {
                FragmentCtyDuLich_View.fragmentTransaction = FragmentCtyDuLich_View.fragmentManager.beginTransaction();
                FragmentTourDuLich_View fragment = new FragmentTourDuLich_View();
                Bundle <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#662',3,'match0-top.html#662',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;TaiKhoan&quot;, FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrTaiKhoan());
                bundle.putString(&quot;MaTinh&quot;, FragmentCtyDuLich_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentCtyDuLich_View</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentCtyDuLich_View.fragmentTransaction.commit();
            }
        });
<A NAME="663"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#663',3,'match0-top.html#663',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentCtyDuLich_View.arrayListCtyDuLich.get(position) != null) {
                    if (FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrCtyDuLich());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="664"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#664',3,'match0-top.html#664',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

        holder.btnLike.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String strMaTinh = FragmentCtyDuLich_View.strMaTinh;
                String strTaiKhoan = FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrTaiKhoan();
                String strTenCty = FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrCtyDuLich();
                String strDiaChi = FragmentCtyDuLich_View.arrayListCtyDuLich.get(position).getStrDiaChi();
                FragmentCtyDuLich_View.fragmentTransaction = FragmentCtyDuLich_View.fragmentManager.beginTransaction();
                FragmentCtyDuLich_View.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(strMaTinh,&quot;&quot;, strTenCty, strDiaChi, strTaiKhoan,1));
                FragmentCtyDuLich_View.fragmentTransaction.commit();
<A NAME="665"></A>            }
        });

        <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#665',3,'match0-top.html#665',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentCtyDuLich_View.arrayListCtyDuLich.clear();
        if (charText.length() == 0) {
            FragmentCtyDuLich_View.arrayListCtyDuLich.addAll(arraylist);
        } else {
            for (ClassCtyDuLich_View wp : arraylist) {
                if (wp.getStrCtyDuLich().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentCtyDuLich_View</B></FONT>.arrayListCtyDuLich.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ListViewTourDuLich_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="666"></A><FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#666',3,'match0-top.html#666',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewTourDuLich_Edit extends BaseAdapter {

    Context mContext</B></FONT>;
    LayoutInflater inflater;
    ArrayList&lt;ClassTourDuLich_Edit&gt; arraylist;
<A NAME="667"></A>
    public ListViewTourDuLich_Edit(Context context) {
        mContext = context;
        <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#667',3,'match0-top.html#667',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentTourDuLich_Edit.arrayListTourDuLich);
    }

    public static class ViewHolder {
        TextView textTenTour, textGiaTour;
    }
    @Override
    public int getCount() {
        return FragmentTourDuLich_Edit.arrayListTourDuLich.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentTourDuLich_Edit.arrayListTourDuLich.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewTourDuLich_Edit.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewTourDuLich_Edit.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_tourdulich_edit, null);
            holder.textTenTour = convertView.findViewById(R.id.textTenTour);
            holder.textGiaTour = convertView.findViewById(R.id.textGiaTour);
            convertView.setTag(holder);
        } else {
            holder = (ListViewTourDuLich_Edit.ViewHolder) convertView.getTag();
        }</B></FONT>

        String strTenTour = (position + 1) + &quot;. Khởi hành từ &quot; + FragmentTourDuLich_Edit.arrayListTourDuLich.get(position).getStrTenTinh();
<A NAME="668"></A>        strTenTour = strTenTour.concat(&quot; đến &quot; + FragmentTourDuLich_Edit.arrayListTourDuLich.get(position).getStrTenDiaDiem() + &quot; (&quot;+ FragmentTourDuLich_Edit.arrayListTourDuLich.get(position).getStrDiaChiDen() + &quot;)&quot;);
        holder.textTenTour.setText(strTenTour);
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#668',3,'match0-top.html#668',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textGiaTour.setText(&quot;Giá tour: &quot; + formatter.format(FragmentTourDuLich_Edit.arrayListTourDuLich.get(position).getIntGiaTour()) + &quot;đ&quot;);
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentTourDuLich_Edit.arrayListTourDuLich.clear();
        if (charText.length() == 0) {
            FragmentTourDuLich_Edit.arrayListTourDuLich.addAll(arraylist);
        } else {
            for (ClassTourDuLich_Edit wp : arraylist) {
                if (wp.getStrNoiDi().toLowerCase(Locale.getDefault()).contains(charText) || wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentTourDuLich_Edit.arrayListTourDuLich.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>CtyDuLich\ListViewTourDuLich_View.java</CENTER></H3><HR>
<PRE>
<A NAME="669"></A>package com.example.travelling.CtyDuLich;

import android.annotation.SuppressLint;
<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#669',3,'match0-top.html#669',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.Activity;
import android.content.Context;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.TextView;

import com.example.travelling.BinhLuan.BLPhongFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewTourDuLich_View extends BaseAdapter {

    //Phần khai báo
<A NAME="670"></A>    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassTourDuLich_View&gt; arraylist;
    ClassConnect <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#670',3,'match0-top.html#670',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;

    public ListViewTourDuLich_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentTourDuLich_View.arrayListTourDuLich);
    }
    public static class ViewHolder {
        TextView textTenTour, textGiaTour, textLuotThich, textBinhLuan;
        ImageButton btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentTourDuLich_View.arrayListTourDuLich.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentTourDuLich_View.arrayListTourDuLich.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewTourDuLich_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewTourDuLich_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_tourdulich_view, null);
            holder.textTenTour = convertView.findViewById(R.id.textTenTour);
            holder.textGiaTour = convertView.findViewById(R.id.textGiaTour);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ListViewTourDuLich_View.ViewHolder) convertView.getTag();
<A NAME="671"></A>        }

        String strTenTour = (position + 1) + &quot;. Khởi hành &quot; + FragmentTourDuLich_View</B></FONT>.arrayListTourDuLich.get(position).getStrTenTinh();
        strTenTour = strTenTour.concat(&quot; đến &quot; + <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#671',3,'match0-top.html#671',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentTourDuLich_View.arrayListTourDuLich.get(position).getStrTenDiaDiem() + &quot;(&quot;+ FragmentTourDuLich_View.arrayListTourDuLich.get(position).getStrDiaChiDen() + &quot;)&quot;);
        holder.textTenTour.setText(strTenTour);
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        holder.textGiaTour.setText(&quot;Giá tour: &quot; + formatter.format(FragmentTourDuLich_View</B></FONT>.arrayListTourDuLich.get(position).getIntGiaTour()) + &quot;đ&quot;);
        final Integer[] intThich = {FragmentTourDuLich_View.arrayListTourDuLich.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentTourDuLich_View.arrayListTourDuLich.get(position).getIntBinhLuan() + &quot; bình luận&quot;);
        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    Integer intMaTour = FragmentTourDuLich_View.arrayListTourDuLich.get(position).getIntMaTour();
                    String sqlThich = &quot;update TB_TourDuLich set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaTour = '&quot;+ intMaTour +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
<A NAME="672"></A>            @Override
            public void onClick(View v) {
                String strMaTinh = FragmentTourDuLich_View.strMaTinh;
                Integer intMaTour = <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#672',3,'match0-top.html#672',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentTourDuLich_View.arrayListTourDuLich.get(position).getIntMaTour();
                String strTenTour = FragmentTourDuLich_View.arrayListTourDuLich.get(position).getStrTenDiaDiem();
                String strTaiKhoan = FragmentTourDuLich_View.arrayListTourDuLich.get(position).getStrTaiKhoan();
                String strDiaChi = FragmentTourDuLich_View</B></FONT>.arrayListTourDuLich.get(position).getStrDiaChiDen();
                FragmentTourDuLich_View.fragmentTransaction = FragmentTourDuLich_View.fragmentManager.beginTransaction();
                FragmentTourDuLich_View.fragmentTransaction.replace(R.id.fragment_main, BLPhongFragment.newInstance(strMaTinh, &quot;&quot;, strTenTour, strTaiKhoan, intMaTour, 1));
<A NAME="673"></A>                FragmentTourDuLich_View.fragmentTransaction.commit();
            }
        });
        <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#673',3,'match0-top.html#673',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentTourDuLich_Edit.arrayListTourDuLich.clear();
        if (charText.length() == 0) {
            FragmentTourDuLich_View.arrayListTourDuLich.addAll(arraylist);
        } else {
            for (ClassTourDuLich_View wp : arraylist) {
                if (wp.getStrTenTinh().toLowerCase(Locale.getDefault()).contains(charText) || wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentTourDuLich_View.arrayListTourDuLich.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DacSan\ClassDacSan_Edit.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.DacSan;

public class ClassDacSan_Edit {

    Integer intDacSan, intLuotThich, intBinhLuan;
    String strMaTinh, strTenDacSan, strGioiThieu, strAnh, strMaDacSan;
<A NAME="550"></A>
    public ClassDacSan_Edit(String strMaDacSan, String strMaTinh, String strTenDacSan, String strAnh, String strGioiThieu, Integer intLuotThich, Integer intBinhLuan){
        this.strMaDacSan = strMaDacSan;
        <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#550',3,'match0-top.html#550',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strMaTinh = strMaTinh;
        this.strTenDacSan = strTenDacSan;
        this.strAnh = strAnh;
        this.strGioiThieu = strGioiThieu;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
    }

    public String getStrMaDacSan() {
        return strMaDacSan;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenDacSan() {
        return strTenDacSan;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrGioiThieu() {
        return strGioiThieu;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }</B></FONT>

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }
}
</PRE>
<HR>
<H3><CENTER>DacSan\ClassDacSan_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.DacSan;

public class ClassDacSan_View {

    Integer intMaDacSan, intLuotThich, intBinhLuan;
    String strMaDacSan, strMaTinh, strTenDacSan, strAnh, strGioiThieu;

<A NAME="551"></A>    public ClassDacSan_View(Integer intMaDacSan, String strMaTinh, String strTenDacSan, String strAnh,
                            String strGioiThieu, Integer intLuotThich, Integer intBinhLuan){
        this.intMaDacSan = intMaDacSan;
        <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#551',3,'match0-top.html#551',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strMaTinh = strMaTinh;
        this.strTenDacSan = strTenDacSan;
        this.strAnh = strAnh;
        this.strGioiThieu = strGioiThieu;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
    }

    public Integer getIntMaDacSan() {
        return intMaDacSan;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenDacSan() {
        return strTenDacSan;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrGioiThieu() {
        return strGioiThieu;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }</B></FONT>

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }
}
</PRE>
<HR>
<H3><CENTER>DacSan\FragmentDacSan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="552"></A><FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#552',3,'match0-top.html#552',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DacSan;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentDacSan_Edit extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="553"></A>    ListView listView;
    public static ArrayList&lt;ClassDacSan_Edit&gt; arrayListDacSan;
    ListViewDacSan_Edit adapterDacSan;
    ArrayList&lt;<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#553',3,'match0-top.html#553',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    String strMaTinh, ganMaTinh, strHienThi;
    EditText editMaDacSan, editTenDacSan, editThongTin;
    TextView textTieuDe;
    Button btnLuuLai, btnXoa, btnDong;
    ImageButton btnThemMoi;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="554"></A>    SharedPreferences.Editor editor;
    String mTaiKhoan, mLoaiTaiKhoan, mMaTinh</B></FONT>;

    <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#554',3,'match0-top.html#554',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_dacsan_edit, container, false);
        sharedpreferences = Objects</B></FONT>.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        mTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        loadPhanQuyen(mTaiKhoan);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
<A NAME="555"></A>    }

    private void loadPhanQuyen(String mTaiKhoan) {
        <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#555',3,'match0-top.html#555',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sql = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+mTaiKhoan+&quot;'&quot;;
            ResultSet resultSet = classConnect.selectData(getActivity</B></FONT>(), sql);
            while (resultSet != null &amp;&amp; resultSet.next()){
                mLoaiTaiKhoan = resultSet.getString(&quot;LoaiTaiKhoan&quot;);
                mMaTinh = resultSet.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e) {
            Log.d(&quot;TAG&quot;, e.getMessage());
        }
<A NAME="556"></A>    }

    private void layoutAnhXa() {
        <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#556',3,'match0-top.html#556',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view.findViewById(R.id.listView);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        loadTinh(); //Load tên tỉnh
<A NAME="557"></A>        loadHienThi();
        clickListView();
        clickButton</B></FONT>();
    <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#557',3,'match0-top.html#557',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
<A NAME="558"></A>            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#558',3,'match0-top.html#558',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?</B></FONT>&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    if (mLoaiTaiKhoan.equals(&quot;6&quot;) &amp;&amp; !mMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        cmdTinh.setEnabled(false);
                    }
<A NAME="559"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachDacSan(strMaTinh, strHienThi);
                }
            <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#559',3,'match0-top.html#559',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
<A NAME="560"></A>    }

    private void</B></FONT> loadHienThi() {
        <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#560',3,'match0-top.html#560',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="561"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(<FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#561',3,'match0-top.html#561',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachDacSan(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void</B></FONT> clickListView() {
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateDacSan(position);
            }

        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDacSan(String maTinh, String hienThi) {
        arrayListDacSan = new ArrayList&lt;&gt;();
        arrayListDacSan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDacSan;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlDacSan = &quot;select MaDacSan, MaTinh, TenDacSan, Anh, GioiThieu, LuotThich from TB_DacSan where MaTinh = '&quot; + maTinh + &quot;'&quot;;
            }
            else {
                sqlDacSan = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaDacSan, MaTinh, TenDacSan, Anh, GioiThieu, LuotThich from TB_DacSan where MaTinh = '&quot; + maTinh + &quot;'&quot;;
            }
            ResultSet resultSetDacSan = classConnect.selectData(getActivity(), sqlDacSan);
            if (resultSetDacSan != null){
                while (resultSetDacSan.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuanDacSan where MaSo = '&quot;+resultSetDacSan.getInt(&quot;MaDacSan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="562"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#562',3,'match0-top.html#562',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDacSan.add(new ClassDacSan_Edit(resultSetDacSan.getString(&quot;MaDacSan&quot;),
                            resultSetDacSan.getString(&quot;MaTinh&quot;), resultSetDacSan.getString(&quot;TenDacSan&quot;),
                            resultSetDacSan.getString(&quot;Anh&quot;), resultSetDacSan.getString(&quot;GioiThieu&quot;), resultSetDacSan.getInt(&quot;LuotThich&quot;), intBinhLuan));
                }
            }
            if (arrayListDacSan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách đặc sản&quot;);
<A NAME="563"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(<FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#563',3,'match0-top.html#563',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e.getMessage()));
        }
        adapterDacSan = new ListViewDacSan_Edit(getContext());
        listView.setAdapter(adapterDacSan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    private void clickButton() {
        btnThemMoi</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                updateDacSan(-1);
            }
<A NAME="564"></A>        });
    }
    @SuppressLint(&quot;SetTextI18n&quot;)
    private <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#564',3,'match0-top.html#564',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void updateDacSan(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_dacsan, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaDacSan = alertLayout.findViewById(R.id.editMaDacSan);
        editTenDacSan = alertLayout.findViewById(R.id.editTenDacSan);
        editThongTin = alertLayout.findViewById(R.id.editThongTin);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
<A NAME="565"></A>        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity</B></FONT>());
        <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#565',3,'match0-top.html#565',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
<A NAME="566"></A>        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI TÊN ĐẶC SẢN&quot;</B></FONT>;
            <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#566',3,'match0-top.html#566',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT TÊN ĐẶC SẢN&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaDacSan.setText(arrayListDacSan.get(intChiSo).getStrMaDacSan()); //Gán giá trị mã địa điểm du lịch
            editTenDacSan.setText(arrayListDacSan.get(intChiSo).getStrTenDacSan()); //Gán giá trị tên địa điểm du lịch
            editThongTin.setText(arrayListDacSan.get(intChiSo).getStrGioiThieu()); //Gán giá trị file youtube
        }
        btnLuuLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
<A NAME="567"></A>            @Override
            public void onClick(View v) {
                try {
                    <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#567',3,'match0-top.html#567',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editTenDacSan.getText().length() != 0){
                        if (editThongTin.getText().length() != 0){
                            String sqlDacSan;
                            if (intChiSo == -1){
                                sqlDacSan = &quot;insert into TB_DacSan(MaTinh, TenDacSan, GioiThieu) values ('&quot;+strMaTinh+&quot;', N'&quot;+editTenDacSan.getText().toString()+&quot;', N'&quot;+editThongTin.getText().toString()+&quot;')&quot;;
                            }
                            else {
                                sqlDacSan = &quot;update TB_DacSan set TenDacSan = N'&quot;+editTenDacSan.getText().toString()+&quot;', GioiThieu = N'&quot;+editThongTin.getText().toString()+&quot;'&quot; +
                                        &quot; where MaDacSan = '&quot;+editMaDacSan.getText()+&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlDacSan) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên đặc sản thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên đặc sản thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachDacSan</B></FONT>(strMaTinh, strHienThi); //Load lại danh sách
                            }
<A NAME="568"></A>                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }
                            <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#568',3,'match0-top.html#568',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập thông tin đặc sản&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên địa đặc sản&quot;);
                    }</B></FONT>
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="569"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#569',3,'match0-top.html#569',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaDacSan.getText().length() != 0) {
                    dialogXoa(editMaDacSan.getText().toString(), editMaDacSan.getText().toString());
                    dialog</B></FONT>.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã đặc sản để xóa&quot;);
                }
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="570"></A>                dialog.cancel();
            }
        });
        <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#570',3,'match0-top.html#570',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách địa điểm du lịch
    }

    private void dialogXoa(final String maDacSan, final String tenDacSan){
        //Hiện hộp thoại thông báo xóa địa điểm du lịch
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN ĐẶC SẢN&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa đặc sản\n&quot;+ tenDacSan +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="571"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#571',3,'match0-top.html#571',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlDiaDiem = &quot;delete TB_DacSan where MaDacSan = '&quot;+ maDacSan +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlDiaDiem) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên đặc sản thành công&quot;);
                        loadDanhSachDacSan(strMaTinh, strHienThi); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên đặc sản&quot;);
                    }</B></FONT>
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
<A NAME="572"></A>                dialogInterface.dismiss();
            }
        });
        AlertDialog <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#572',3,'match0-top.html#572',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
        alertDialog.show();
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean</B></FONT> onQueryTextChange(String newText) {

        return false;
    }
}
</PRE>
<HR>
<H3><CENTER>DacSan\FragmentDacSan_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.DacSan;

<A NAME="573"></A>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
<FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#573',3,'match0-top.html#573',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentDacSan_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();
    public static FragmentManager fragmentManager</B></FONT>; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="574"></A>    ListView listView;
    public static ArrayList&lt;ClassDacSan_View&gt; arrayListDacSan;
    ListViewDacSan_View adapterDacSan;
    ArrayList&lt;<FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#574',3,'match0-top.html#574',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    public static String strMaTinh, ganMaTinh, strHienThi, mMaTinh;
    int intDieuKien</B></FONT> = 0;
<A NAME="575"></A>    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;

    <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#575',3,'match0-top.html#575',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
<A NAME="576"></A>        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_dacsan_view, container, false);
        fragmentManager = Objects</B></FONT>.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        sharedpreferences = <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#576',3,'match0-top.html#576',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            ganMaTinh = bundle.getString(&quot;MaTinh&quot;);
        }
        else {
            ganMaTinh = &quot;&quot;;
        }
        mMaTinh = classPublic</B></FONT>.layMaTinh(sharedpreferences.getString(User,&quot;&quot;), getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="577"></A>        return view;
    }

    private <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#577',3,'match0-top.html#577',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
<A NAME="578"></A>        listView = view.findViewById(R.id.listView);
        loadTinh</B></FONT>(); //Load tên tỉnh
        loadHienThi();
    <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#578',3,'match0-top.html#578',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
<A NAME="579"></A>                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#579',3,'match0-top.html#579',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh.setAdapter(dataTinh);
            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity</B></FONT>()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    if (ganMaTinh.equals(&quot;&quot;) &amp;&amp; intDieuKien == 0){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        intDieuKien = 1;
                    }
                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(ganMaTinh));
                        ganMaTinh = &quot;&quot;;
                    }
<A NAME="580"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachDacSan(strMaTinh, strHienThi);
                }
            <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#580',3,'match0-top.html#580',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
<A NAME="581"></A>    }

    private void</B></FONT> loadHienThi() {
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#581',3,'match0-top.html#581',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="582"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#582',3,'match0-top.html#582',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachDacSan(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDacSan(String maTinh, String hienThi) {
        arrayListDacSan = new ArrayList&lt;&gt;();
        arrayListDacSan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDacSan;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlDacSan = &quot;select * from TB_DacSan where MaTinh = '&quot; + maTinh + &quot;'&quot;;
            }
            else {
                sqlDacSan = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; * from TB_DacSan where MaTinh = '&quot; + maTinh + &quot;'&quot;;
            }
            ResultSet resultSetDacSan = classConnect.selectData(getActivity(), sqlDacSan);
            if (resultSetDacSan != null){
                while (resultSetDacSan.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuanDacSan where MaSo = '&quot;+resultSetDacSan.getInt(&quot;MaDacSan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="583"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#583',3,'match0-top.html#583',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDacSan.add(new ClassDacSan_View(resultSetDacSan.getInt(&quot;MaDacSan&quot;), resultSetDacSan.getString(&quot;MaTinh&quot;),
                             resultSetDacSan.getString(&quot;TenDacSan&quot;), resultSetDacSan.getString(&quot;Anh&quot;),
                            resultSetDacSan.getString(&quot;GioiThieu&quot;), resultSetDacSan.getInt(&quot;LuotThich&quot;), intBinhLuan));
                }
            }
            if (arrayListDacSan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách đặc sản&quot;);
            }
<A NAME="584"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#584',3,'match0-top.html#584',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterDacSan = new ListViewDacSan_View(getContext());
        listView.setAdapter(adapterDacSan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterDacSan.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DacSan\ListViewDacSan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="585"></A>package com.example.travelling.DacSan;

import android.annotation.SuppressLint;
<FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#585',3,'match0-top.html#585',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Context;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDacSan_Edit extends BaseAdapter {

    Context mContext;
<A NAME="586"></A>    LayoutInflater inflater;
    ArrayList&lt;ClassDacSan_Edit&gt; arraylist;
    ClassConnect classConnect</B></FONT>;
    ClassPublic <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#586',3,'match0-top.html#586',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic;

    public ListViewDacSan_Edit(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDacSan_Edit.arrayListDacSan);
    }
    public static class ViewHolder {
        TextView textTenDacSan, textLuotThich, textBinhLuan;
        ImageView imageDacSan;
    }
    @Override
    public int getCount() {
        return FragmentDacSan_Edit.arrayListDacSan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDacSan_Edit.arrayListDacSan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_dacsan_edit, null);
            holder.textTenDacSan = convertView.findViewById(R.id.textTenDacSan);
            holder.imageDacSan = convertView.findViewById(R.id.imageDacSan);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.textTenDacSan.setText((position + 1) + &quot;. &quot; + FragmentDacSan_Edit</B></FONT>.arrayListDacSan.get(position).getStrTenDacSan().toUpperCase());
        String strAnh = FragmentDacSan_Edit.arrayListDacSan.get(position).getStrAnh();
        if (!strAnh.equals(&quot;&quot;)){
<A NAME="587"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#587',3,'match0-top.html#587',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDacSan); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imageDacSan.setImageResource(R.drawable.no_image);
<A NAME="588"></A>        }

        final Integer[] intThich = {</B></FONT>FragmentDacSan_Edit.arrayListDacSan.get(position).getIntLuotThich()};
        <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#588',3,'match0-top.html#588',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textLuotThich.setText(intThich[0] +&quot; lượt&quot;);
        holder.textBinhLuan.setText(FragmentDacSan_Edit.arrayListDacSan.get(position).getIntBinhLuan() + &quot; bình luận&quot;);
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDacSan_Edit.arrayListDacSan.clear();
        if (charText.length() == 0) {
            FragmentDacSan_Edit.arrayListDacSan.addAll(arraylist);
        } else {
            for (ClassDacSan_Edit wp : arraylist) {
                if (wp.getStrTenDacSan().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDacSan_Edit.arrayListDacSan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DacSan\ListViewDacSan_View.java</CENTER></H3><HR>
<PRE>
<A NAME="589"></A>package com.example.travelling.DacSan;

<FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#589',3,'match0-top.html#589',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
import android.text.Html;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLDacSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDacSan_View extends BaseAdapter {

    Context mContext;
<A NAME="590"></A>    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassDacSan_View&gt; arraylist;
    ClassConnect classConnect;
    ClassPublic <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#590',3,'match0-top.html#590',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic;

    public ListViewDacSan_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDacSan_View.arrayListDacSan);
<A NAME="591"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#591',3,'match0-top.html#591',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTenDacSan, textGioiThieu, textLuotThich, textBinhLuan;
        ImageView imageDacSan;
        ImageButton btnLike, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentDacSan_View.arrayListDacSan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDacSan_View.arrayListDacSan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;, &quot;JavascriptInterface&quot;, &quot;SetJavaScriptEnabled&quot;, &quot;AddJavascriptInterface&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_dacsan_view, null);
            holder.textTenDacSan = convertView.findViewById(R.id.textTenDacSan);
            holder.imageDacSan = convertView.findViewById(R.id.imageDacSan);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            holder.textGioiThieu = convertView</B></FONT>.findViewById(R.id.textGioiThieu);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.textTenDacSan.setText((position + 1) + &quot;. &quot; + FragmentDacSan_View.arrayListDacSan.get(position).getStrTenDacSan().toUpperCase());
        String strAnh = FragmentDacSan_View.arrayListDacSan.get(position).getStrAnh();
        if (!strAnh.equals(&quot;&quot;)){
<A NAME="592"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#592',3,'match0-top.html#592',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDacSan); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imageDacSan.setImageResource(R.drawable.no_image);
        }

        final Integer[] intThich = {</B></FONT>FragmentDacSan_View.arrayListDacSan.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentDacSan_View.arrayListDacSan.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

        holder.btnLike.setOnClickListener(v -&gt;  { //Click nút thích
            try{
                classConnect = new ClassConnect(); //Mở kết nối đến SQL
                int intMaDacSan = FragmentDacSan_View.arrayListDacSan.get(position).getIntMaDacSan();
                String sqlThich = &quot;update TB_DacSan set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaDacSan = '&quot;+ intMaDacSan +&quot;'&quot;;
                if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                    holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                }
                classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
            }catch (Exception e){
                Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
            }
        });

        holder.btnBinhLuan.setOnClickListener(v -&gt;  {
            String strMaTinh = FragmentDacSan_View.strMaTinh;
            Integer intMaDacSan = FragmentDacSan_View.arrayListDacSan.get(position).getIntMaDacSan();
            String strTenDacSan = FragmentDacSan_View.arrayListDacSan.get(position).getStrTenDacSan();
            FragmentDacSan_View.fragmentTransaction = FragmentDacSan_View.fragmentManager.beginTransaction();
            FragmentDacSan_View.fragmentTransaction.replace(R.id.fragment_main, BLDacSanFragment.newInstance(strMaTinh, strTenDacSan, intMaDacSan));
            FragmentDacSan_View.fragmentTransaction.commit();
        });
        String gioiThieu = FragmentDacSan_View.arrayListDacSan.get(position).getStrGioiThieu();
        if (!gioiThieu.equals(&quot;&quot;)) {
            String[] strGioiThieu = FragmentDacSan_View.arrayListDacSan.get(position).getStrGioiThieu().split(&quot;\\.&quot;);
            if (!strGioiThieu[0].equals(&quot;&quot;)) {
                holder.textGioiThieu.setText(Html.fromHtml(strGioiThieu[0] + &quot;... &lt;font color = 'blue'&gt;&lt;i&gt;Xem thêm &gt;&gt;&lt;/i&gt;&lt;/font&gt;&quot;), TextView.BufferType.SPANNABLE);
            }
            else {
                holder.textGioiThieu.setVisibility(View.GONE);
            }
        }
<A NAME="593"></A>        else {
            holder.textGioiThieu.setVisibility(View.GONE);
        }
        <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#593',3,'match0-top.html#593',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textGioiThieu.setOnClickListener(v -&gt;
            holder.textGioiThieu.setText(FragmentDacSan_View.arrayListDacSan.get(position).getStrGioiThieu()));

        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDacSan_View.arrayListDacSan.clear();
        if (charText.length() == 0) {
            FragmentDacSan_View.arrayListDacSan.addAll(arraylist);
        } else {
            for (ClassDacSan_View wp : arraylist) {
                if (wp.getStrTenDacSan().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDacSan_View.arrayListDacSan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\ClassDiaDiemGan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="382"></A><FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#382',3,'match0-top.html#382',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class ClassDiaDiemGan_Edit {

    Integer intMaGan;
    Double doubleKhoangCach;
    String strMaTinh, strMaHuyen, strMaDiaDiem, strTenDiaDiem;

    public ClassDiaDiemGan_Edit(Integer intMaGan, String strMaTinh, String strMaHuyen, String strMaDiaDiem,
                                String strTenDiaDiem, Double doubleKhoangCach){
        this.intMaGan = intMaGan;
        this.strMaTinh = strMaTinh;
        this.strMaHuyen = strMaHuyen;
        this.strMaDiaDiem = strMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.doubleKhoangCach = doubleKhoangCach;
    }

    public Integer getIntMaGan() {
        return intMaGan;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrMaHuyen() {
        return strMaHuyen;
    }

    public String getStrMaDiaDiem() {
        return strMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public Double getDoubleKhoangCach() {
        return doubleKhoangCach;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\ClassDiaDiemGan_View.java</CENTER></H3><HR>
<PRE>
<A NAME="383"></A><FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#383',3,'match0-top.html#383',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class ClassDiaDiemGan_View {
    private String strMaDiaDiem, strTenDiaDiem, strMaTinh, strTenTinh, strTenHuyen, strTenXa, strAnh, strYoutube;
    private Integer intLuotThich;
<A NAME="384"></A>    private Double doubleKhoangCach</B></FONT>;
    public ClassDiaDiemGan_View(String strMaDiaDiem, String strTenDiaDiem, String strMaTinh, String strTenTinh,
                                String strTenHuyen, String strTenXa, String strAnh, Integer intLuotThich, Double doubleKhoangCach, String strYoutube){
        <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#384',3,'match0-top.html#384',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strMaDiaDiem = strMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strMaTinh = strMaTinh;
        this.strTenTinh = strTenTinh;
        this.strTenHuyen = strTenHuyen;
        this.strTenXa = strTenXa;
        this.strAnh = strAnh;
        this.intLuotThich = intLuotThich;
        this.doubleKhoangCach = doubleKhoangCach;
        this.strYoutube = strYoutube;
    }

    public String getStrMaDiaDiem() {
        return strMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenTinh() {
        return strTenTinh;
    }

    public String getStrTenHuyen() {
        return strTenHuyen;
    }

    public String getStrTenXa() {
        return strTenXa;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Double getDoubleKhoangCach() {
        return doubleKhoangCach;
    }

    public String getStrYoutube() {
        return strYoutube;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ClassDiaDiem_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="385"></A><FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#385',3,'match0-top.html#385',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class ClassDiaDiem_Edit {

    String strMaDiaDiem, strTenDiaDiem, strTenTinh, strMaHuyen, strTenHuyen, strMaXa, strTenXa, strYoutube, strAnh;
    Integer intLuotThich;
    Float floatKinhDo, floatViDo;

    public ClassDiaDiem_Edit(String strMaDiaDiem, String strTenDiaDiem, String strTenTinh, String strMaHuyen,
                             String strTenHuyen, String strMaXa, String strTenXa, String strYoutube, String strAnh, Integer intLuotThich,
                             Float floatKinhDo, Float floatViDo){
        this.strMaDiaDiem = strMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strTenTinh = strTenTinh;
        this.strMaHuyen = strMaHuyen;
        this.strTenHuyen = strTenHuyen;
        this.strMaXa = strMaXa;
        this.strTenXa = strTenXa;
        this.strYoutube = strYoutube;
        this.strAnh = strAnh;
        this.intLuotThich = intLuotThich;
        this.floatKinhDo = floatKinhDo;
        this.floatViDo = floatViDo;
    }

    public String getStrMaDiaDiem() {
        return strMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrTenTinh() {
        return strTenTinh;
    }

    public String getStrMaHuyen() {
        return strMaHuyen;
    }

    public String getStrTenHuyen() {
        return strTenHuyen;
    }

    public String getStrMaXa() {
        return strMaXa;
    }

    public String getStrTenXa() {
        return strTenXa;
    }

    public String getStrYoutube() {
        return strYoutube;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Float getFloatKinhDo() {
        return floatKinhDo;
    }

    public Float getFloatViDo() {
        return floatViDo;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\ClassDiaDiem_View.java</CENTER></H3><HR>
<PRE>
<A NAME="386"></A><FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#386',3,'match0-top.html#386',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class ClassDiaDiem_View {
<A NAME="387"></A>    String strMaDiaDiem, strTenDiaDiem, strMaTinh, strTenTinh, strTenHuyen, strTenXa, strAnh, strYoutube;
    Integer intLuotThich, intBinhLuan</B></FONT>;
    public ClassDiaDiem_View(String strMaDiaDiem, String strTenDiaDiem, String strMaTinh, String strTenTinh, String strTenHuyen, String strTenXa, String strAnh, Integer intLuotThich, Integer intBinhLuan, String strYoutube){
        <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#387',3,'match0-top.html#387',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strMaDiaDiem = strMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strMaTinh = strMaTinh;
        this.strTenTinh = strTenTinh;
        this.strTenHuyen = strTenHuyen;
        this.strTenXa = strTenXa;
        this.strAnh = strAnh;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
        this.strYoutube = strYoutube;
    }

    public String getStrMaDiaDiem() {
        return strMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenTinh() {
        return strTenTinh;
    }

    public String getStrTenHuyen() {
        return strTenHuyen;
    }

    public String getStrTenXa() {
        return strTenXa;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public String getStrYoutube() {
        return strYoutube;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ClassThoiTiet.java</CENTER></H3><HR>
<PRE>
<A NAME="388"></A><FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#388',3,'match0-top.html#388',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class ClassThoiTiet {
    private String strNgay, strStatus, strImage, strNhietDo, strTocDoGio, strDoAm;
    public ClassThoiTiet(String strNgay, String strStatus, String strImage,  String strNhietDo, String strTocDoGio, String strDoAm){
        this.strNgay = strNgay;
        this.strStatus = strStatus;
        this.strImage = strImage;
        this.strNhietDo = strNhietDo;
        this.strTocDoGio = strTocDoGio;
        this.strDoAm = strDoAm;
    }

    public String getStrNgay() {
        return strNgay;
    }

    public String getStrStatus() {
        return strStatus;
    }

    public String getStrImage() {
        return strImage;
    }

    public String getStrNhietDo() {
        return strNhietDo;
    }

    public String getStrTocDoGio() {
        return strTocDoGio;
    }

    public String getStrDoAm() {
        return strDoAm;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\DiaDiemYeuThichClass.java</CENTER></H3><HR>
<PRE>
<A NAME="389"></A><FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#389',3,'match0-top.html#389',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

public class DiaDiemYeuThichClass {
<A NAME="390"></A>    String strTenDiaDiem, strMaTinh, strTenTinh, strTenHuyen, strTenXa, strAnh, strYoutube;
    Integer intMaDiaDiem, intLuotThich, intBinhLuan</B></FONT>;
    public DiaDiemYeuThichClass(Integer intMaDiaDiem, String strTenDiaDiem, String strMaTinh, String strTenTinh, String strTenHuyen, String strTenXa, String strAnh, Integer intLuotThich, Integer intBinhLuan, String strYoutube){
        <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#390',3,'match0-top.html#390',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.intMaDiaDiem = intMaDiaDiem;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strMaTinh = strMaTinh;
        this.strTenTinh = strTenTinh;
        this.strTenHuyen = strTenHuyen;
        this.strTenXa = strTenXa;
        this.strAnh = strAnh;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
        this.strYoutube = strYoutube;
    }

    public Integer getIntMaDiaDiem() {
        return intMaDiaDiem;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenTinh() {
        return strTenTinh;
    }

    public String getStrTenHuyen() {
        return strTenHuyen;
    }

    public String getStrTenXa() {
        return strTenXa;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public String getStrYoutube() {
        return strYoutube;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\DiaDiemYeuThichFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="391"></A><FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#391',3,'match0-top.html#391',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class DiaDiemYeuThichFragment extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
    public static ArrayList&lt;DiaDiemYeuThichClass&gt; arrayListDiaDiem;
    DiaDiemYeuThichListView adapterDiaDiem;
<A NAME="392"></A>    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();

    @SuppressLint(&quot;NewApi&quot;)
    public <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#392',3,'match0-top.html#392',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_dia_diem_yeu_thich, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void layoutAnhXa() {
<A NAME="393"></A>        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view</B></FONT>.findViewById(R.id.listView);
        <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#393',3,'match0-top.html#393',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadHienThi();
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
<A NAME="394"></A>        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi</B></FONT>.add(&quot;40&quot;);
        <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#394',3,'match0-top.html#394',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    loadDanhSachDiaDiem(listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDiaDiem(String strHienThi) {
        arrayListDiaDiem = new ArrayList&lt;&gt;();
        arrayListDiaDiem.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem;
            if (strHienThi.equals(&quot;Tất cả&quot;)){
                sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem, dd.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, dd.Youtube &quot; +
                        &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x &quot; +
                        &quot;where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa order by dd.LuotThich desc&quot;;
            }
            else {
                sqlDiaDiem = &quot;select top &quot; + Integer.parseInt(strHienThi) + &quot; MaDiaDiem, TenDiaDiem, dd.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, dd.Youtube &quot; +
<A NAME="395"></A>                        &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x &quot; +
                        &quot;where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa order by dd.LuotThich desc&quot;;
            }
            ResultSet <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#395',3,'match0-top.html#395',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null){
                while (resultSetDiaDiem.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where MaSo = '&quot;+resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListDiaDiem.add(new DiaDiemYeuThichClass(resultSetDiaDiem.getInt(&quot;MaDiaDiem&quot;), resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;),
                            resultSetDiaDiem.getString(&quot;MaTinh&quot;), resultSetDiaDiem.getString(&quot;TenTinh&quot;),
                            resultSetDiaDiem.getString(&quot;TenHuyen&quot;), resultSetDiaDiem.getString(&quot;TenXa&quot;),
<A NAME="396"></A>                            resultSetDiaDiem.getString(&quot;Anh&quot;), resultSetDiaDiem.getInt(&quot;LuotThich&quot;), intBinhLuan, resultSetDiaDiem</B></FONT>.getString(&quot;Youtube&quot;)));
                }
            }
            if (<FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#396',3,'match0-top.html#396',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDiaDiem.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
<A NAME="397"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log</B></FONT>.e(&quot;TAG&quot;, <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#397',3,'match0-top.html#397',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterDiaDiem = new DiaDiemYeuThichListView(getContext());
        listView.setAdapter(adapterDiaDiem);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterDiaDiem.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\DiaDiemYeuThichListView.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
<A NAME="398"></A>import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
<FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#398',3,'match0-top.html#398',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLDiaDiemFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_Home;
import com.example.travelling.KhachSan.FragmentKhachSan_View;
import com.example.travelling.NhaHang.FragmentNhaHang_View;
import com.example.travelling.R;

import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class DiaDiemYeuThichListView extends BaseAdapter {

    private Context mContext;
    private LayoutInflater inflater;
    private ArrayList&lt;DiaDiemYeuThichClass&gt; arraylist;
    private ClassConnect classConnect;
    private ClassPublic classPublic;
    public DiaDiemYeuThichListView(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(DiaDiemYeuThichFragment.arrayListDiaDiem);
<A NAME="399"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView textTenDiaDiem, textDiaChi, <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#399',3,'match0-top.html#399',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textLuotThich, textBinhLuan;
        ImageView imageDiaDiem;
        ImageButton btnVideo, btnChiDuong, btnCtyDuLich, btnNhaHang, btnKhachSan, btnDiaDiemGan, btnThoiTiet, btnLike, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return DiaDiemYeuThichFragment.arrayListDiaDiem.size();
    }

    @Override
    public Object getItem(int position) {
        return DiaDiemYeuThichFragment.arrayListDiaDiem.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final DiaDiemYeuThichListView.ViewHolder holder;
        if (convertView == null) {
            holder = new DiaDiemYeuThichListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_diadiem_view, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.textTenDiaDiem = convertView.findViewById(R.id.textTenDiaDiem);
            holder.imageDiaDiem = convertView.findViewById(R.id.imageDiaDiem);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.btnVideo = convertView.findViewById(R.id.btnVideo);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnCtyDuLich = convertView.findViewById(R.id.btnCtyDuLich);
            holder.btnNhaHang = convertView.findViewById(R.id.btnNhaHang);
<A NAME="400"></A>            holder.btnKhachSan = convertView.findViewById(R.id.btnKhachSan);
            holder.btnDiaDiemGan = convertView.findViewById(R.id.btnDiaDiemGan);
            holder.btnThoiTiet = convertView</B></FONT>.findViewById(R.id.btnThoiTiet);
            <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#400',3,'match0-top.html#400',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (DiaDiemYeuThichListView.ViewHolder) convertView.getTag();
        }
<A NAME="401"></A>
        holder.textTenDiaDiem.setText((position + 1) + &quot;. &quot; + DiaDiemYeuThichFragment</B></FONT>.arrayListDiaDiem.get(position).getStrTenDiaDiem().toUpperCase());
        String strAnh = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrAnh();
        if (!<FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#401',3,'match0-top.html#401',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager</B></FONT>.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDiaDiem); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
<A NAME="402"></A>        else {
            holder.imageDiaDiem.setImageResource(R.drawable.no_image);
        }
        String strDiaChi = <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#402',3,'match0-top.html#402',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenXa();
        strDiaChi = strDiaChi.concat(&quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenTinh());
        holder</B></FONT>.textDiaChi.setText(strDiaChi);
        final Integer[] intThich = {DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="403"></A>        holder.btnVideo.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String strTenDiaDiem = <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#403',3,'match0-top.html#403',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenDiaDiem();
                String strYoutube = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrYoutube();
                String strDiaChi = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenXa() + &quot; - &quot; + DiaDiemYeuThichFragment</B></FONT>.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).strTenTinh;
                if (strYoutube.equals(&quot;&quot;)){
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật video&quot;);
                    return;
                }
                DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                DiaDiemYeuThichFragment.fragmentTransaction.replace(R.id.fragment_main, YoutubeFragment.newInstance(0, strTenDiaDiem, &quot;&quot;, strYoutube, strDiaChi, 1));
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

<A NAME="404"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#404',3,'match0-top.html#404',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                bundle.putInt(&quot;DieuKien&quot;,1);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.commit();
            }
        });

<A NAME="405"></A>        holder.btnCtyDuLich.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#405',3,'match0-top.html#405',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentCtyDuLich_Home fragment = new FragmentCtyDuLich_Home();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

<A NAME="406"></A>        holder.btnNhaHang.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#406',3,'match0-top.html#406',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentNhaHang_View fragment = new FragmentNhaHang_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

<A NAME="407"></A>        holder.btnKhachSan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#407',3,'match0-top.html#407',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentKhachSan_View fragment = new FragmentKhachSan_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

<A NAME="408"></A>        holder.btnDiaDiemGan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#408',3,'match0-top.html#408',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentDiaDiemGan_View fragment = new FragmentDiaDiemGan_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

<A NAME="409"></A>        holder.btnThoiTiet.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#409',3,'match0-top.html#409',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentThoiTiet fragment = new FragmentThoiTiet();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem().toString());
                bundle</B></FONT>.putString(&quot;MaTinh&quot;, &quot;&quot;);
                fragment.setArguments(bundle);
                DiaDiemYeuThichFragment.fragmentTransaction.replace(R.id.fragment_main, fragment);
                DiaDiemYeuThichFragment.fragmentTransaction.commit();
            }
        });

        holder.btnLike.setOnClickListener(new View.OnClickListener() { //Click nút thích
<A NAME="410"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) { //Click nút lượt thích
                <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#410',3,'match0-top.html#410',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String sqlThich = &quot;update TB_DiaDiem set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaDiaDiem = '&quot;+DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem()+&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }</B></FONT>
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="411"></A>                Integer intMaDiaDiem = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getIntMaDiaDiem();
                String strTenDiaDiem = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenDiaDiem();
                String strDiaChi = DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenXa();
                strDiaChi = <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#411',3,'match0-top.html#411',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strDiaChi.concat(&quot; - &quot;+DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenHuyen()+&quot; - &quot;+DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenTinh());
                DiaDiemYeuThichFragment.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                DiaDiemYeuThichFragment.fragmentTransaction.replace(R.id.fragment_main, BLDiaDiemFragment.newInstance(&quot;&quot;, strTenDiaDiem, strDiaChi,intMaDiaDiem));
<A NAME="412"></A>                DiaDiemYeuThichFragment</B></FONT>.fragmentTransaction.commit();
            }
        });
        <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#412',3,'match0-top.html#412',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        DiaDiemYeuThichFragment.arrayListDiaDiem.clear();
        if (charText.length() == 0) {
            DiaDiemYeuThichFragment.arrayListDiaDiem.addAll(arraylist);
        } else {
            for (DiaDiemYeuThichClass wp : arraylist) {
                if (wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    DiaDiemYeuThichFragment</B></FONT>.arrayListDiaDiem.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentChiDuong.java</CENTER></H3><HR>
<PRE>
<A NAME="413"></A>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
<FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#413',3,'match0-top.html#413',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageButton;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Class.FragmentGoogleMap;
import com.example.travelling.Home.FragmentHome;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.KhachSan.FragmentKhachSan_View;
import com.example.travelling.NhaHang.FragmentNhaHang_View;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.Objects;

public class FragmentChiDuong extends Fragment {
    //Khái báo
    private View view;
    private FragmentGoogleMap googleMap;
    private ClassPublic classPublic = new ClassPublic();
    private String strMaDiaDiem</B></FONT>, strMaTinh, mTaiKhoan;
<A NAME="414"></A>    private Integer mDieuKien;
    public static String strTenDiaDiem;
    public static Double doubleKinhDo, doubleViDo;
    private ImageButton <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#414',3,'match0-top.html#414',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>btnQuayLai;
    private TextView textDiaDiem, textDiaChi;
    private ClassConnect classConnect;
    private FragmentManager fragmentManager; //Tạo Fragment
    private FragmentTransaction fragmentTransaction;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_chiduong, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null){
            mTaiKhoan = bundle.getString(&quot;TaiKhoan&quot;);
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;);
            strMaTinh = bundle.getString(&quot;MaTinh&quot;);
            mDieuKien = bundle</B></FONT>.getInt(&quot;DieuKien&quot;);
        }
        else {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa();
        //Kiểm tra kinh độ và vĩ độ
        if (doubleKinhDo != 0 &amp;&amp; doubleViDo != 0) {
            googleMap = (FragmentGoogleMap) fragmentManager.findFragmentById(R.id.fragmentMap);
        }
        else {
            classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật vị trí&quot;);
            switch (mDieuKien){
                case 1:
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new FragmentHome());
<A NAME="415"></A>                    fragmentTransaction.commit();
                    break;
                case 2:
                    <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#415',3,'match0-top.html#415',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                    FragmentDiaDiem_View fragmentDiaDiem = new FragmentDiaDiem_View();
                    Bundle bundleDiaDiem = new Bundle();
                    bundleDiaDiem.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragmentDiaDiem.setArguments(bundleDiaDiem);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentDiaDiem);
<A NAME="416"></A>                    fragmentTransaction</B></FONT>.commit();
                    break;
                case 3:
                    <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#416',3,'match0-top.html#416',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                    FragmentNhaHang_View fragmentNhaHang = new FragmentNhaHang_View();
                    Bundle bundleNhaHang = new Bundle();
                    bundleNhaHang.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundleNhaHang.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragmentNhaHang.setArguments(bundleNhaHang);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentNhaHang);
<A NAME="417"></A>                    fragmentTransaction</B></FONT>.commit();
                    break;
                case 4:
                    <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#417',3,'match0-top.html#417',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                    FragmentKhachSan_View fragmentKhachSan = new FragmentKhachSan_View();
                    Bundle bundleKhachSan = new Bundle();
                    bundleKhachSan.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundleKhachSan.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragmentKhachSan.setArguments(bundleKhachSan);
                    fragmentTransaction.replace(R.id.fragment_main, fragmentKhachSan);
                    fragmentTransaction</B></FONT>.commit();
                    break;
            }
        }
<A NAME="418"></A>        return view;
    }

    private <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#418',3,'match0-top.html#418',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        layDiaDiem(strMaDiaDiem);
        clickButton();
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void layDiaDiem(String maDiaDiem) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            if (mDieuKien == 1 || mDieuKien == 2) {
                String sqlDiaDiem = &quot;select * from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x &quot; +
                        &quot;where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa and dd.MaDiaDiem = '&quot; + maDiaDiem + &quot;'&quot;;
<A NAME="419"></A>                ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
                if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()) {
                    String strDiaChi = resultSetDiaDiem.getString(&quot;TenXa&quot;);
                    strDiaChi = <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#419',3,'match0-top.html#419',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strDiaChi.concat(&quot; - &quot; + resultSetDiaDiem.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetDiaDiem.getString(&quot;TenTinh&quot;));
                    strTenDiaDiem = resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;);
                    doubleKinhDo = Double.parseDouble(resultSetDiaDiem.getString(&quot;KinhDo&quot;));
<A NAME="420"></A>                    doubleViDo = Double</B></FONT>.parseDouble(resultSetDiaDiem.getString(&quot;ViDo&quot;));
                    textDiaDiem.setText(strTenDiaDiem.toUpperCase());
                    textDiaChi.setText(strDiaChi);
                <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#420',3,'match0-top.html#420',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            }
            else {
                String sqlTaiKhoan = &quot;select * from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x &quot; +
                        &quot;where nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and nd.TaiKhoan = '&quot; + mTaiKhoan + &quot;'&quot;;
<A NAME="421"></A>                ResultSet resultSetTaiKhoan = classConnect.selectData(getActivity(), sqlTaiKhoan);
                if</B></FONT> (resultSetTaiKhoan != null &amp;&amp; resultSetTaiKhoan.next()) {
                    String strDiaChi = resultSetTaiKhoan.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetTaiKhoan.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#421',3,'match0-top.html#421',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetTaiKhoan.getString(&quot;TenTinh&quot;));
                    strTenDiaDiem = resultSetTaiKhoan.getString(&quot;CongTy&quot;);
                    doubleKinhDo = Double.parseDouble(resultSetTaiKhoan.getString(&quot;KinhDo&quot;));
                    doubleViDo = Double.parseDouble(resultSetTaiKhoan</B></FONT>.getString(&quot;ViDo&quot;));
                    textDiaDiem.setText(strTenDiaDiem.toUpperCase());
                    textDiaChi.setText(strDiaChi);
                }
            }
            classConnect.CONN(getActivity()).close();
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                switch (mDieuKien){
                    case 1:
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
<A NAME="422"></A>                        fragmentTransaction.commit();
                        break;
                    case 2:
                        <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#422',3,'match0-top.html#422',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                        FragmentDiaDiem_View fragmentDiaDiem = new FragmentDiaDiem_View();
                        Bundle bundleDiaDiem = new Bundle();
                        bundleDiaDiem.putString(&quot;MaTinh&quot;, strMaTinh);
                        fragmentDiaDiem.setArguments(bundleDiaDiem);
                        fragmentTransaction</B></FONT>.replace(R.id.fragment_main, fragmentDiaDiem);
<A NAME="423"></A>                        fragmentTransaction.commit();
                        break;
                    case 3:
                        <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#423',3,'match0-top.html#423',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                        FragmentNhaHang_View fragmentNhaHang = new FragmentNhaHang_View();
                        Bundle bundleNhaHang = new Bundle();
                        bundleNhaHang.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                        bundleNhaHang.putString(&quot;MaTinh&quot;, strMaTinh);
                        fragmentNhaHang.setArguments(bundleNhaHang);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentNhaHang);
<A NAME="424"></A>                        fragmentTransaction</B></FONT>.commit();
                        break;
                    case 4:
                        <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#424',3,'match0-top.html#424',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction = fragmentManager.beginTransaction();
                        FragmentKhachSan_View fragmentKhachSan = new FragmentKhachSan_View();
                        Bundle bundleKhachSan = new Bundle();
                        bundleKhachSan.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                        bundleKhachSan.putString(&quot;MaTinh&quot;, strMaTinh);
                        fragmentKhachSan</B></FONT>.setArguments(bundleKhachSan);
                        fragmentTransaction.replace(R.id.fragment_main, fragmentKhachSan);
                        fragmentTransaction.commit();
                        break;
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentDiaDiemGan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="425"></A>package com.example.travelling.DiaDiem;

<FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#425',3,'match0-top.html#425',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentDiaDiemGan_Edit extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    SearchView searchView;
    ImageButton btnThemMoi;
    ListView listView;
    Spinner cmdTinh, cmdHuyen, cmdDiaDiem;
<A NAME="426"></A>    ClassPublic classPublic = new ClassPublic();
    ClassConnect classConnect;
    String strMaTinh, strMaHuyen, strMaDiaDiem</B></FONT>;
    public static ArrayList&lt;ClassDiaDiemGan_Edit&gt; <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#426',3,'match0-top.html#426',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDiaDiemGan;
    ListViewDiaDiemGan_Edit adapterDiaDiemGan;
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaDiaDiem = new ArrayList&lt;&gt;(); //Khai báo danh sách địa điểm du lịch
    ArrayList&lt;String&gt; listTenDiaDiem = new ArrayList&lt;&gt;();
    TextView textTieuDe;
<A NAME="427"></A>    EditText editMaGan, editKhoangCach;
    Spinner cmdDialogTinh, cmdDialogHuyen, cmdDialogDiaDiemGan;
    String strDialogMaTinh, strDialogMaHuyen, strDialogMaDiaDiem</B></FONT>, ganMaTinh, ganMaHuyen, ganDiaDiemGan;
    ArrayList&lt;<FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#427',3,'match0-top.html#427',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listDialogMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listDialogTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listDialogMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listDialogTenHuyen = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listDialogMaDiaDiem = new ArrayList&lt;&gt;(); //Khai báo danh sách địa điểm du lịch
<A NAME="428"></A>    ArrayList&lt;String&gt; listDialogTenDiaDiem = new ArrayList&lt;&gt;();
    Button btnLuuLai, btnXoa, btnDong;
    SharedPreferences sharedpreferences</B></FONT>; //Nhớ tài khoản
    SharedPreferences.Editor <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#428',3,'match0-top.html#428',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editor;
    String mTaiKhoan, mLoaiTaiKhoan, mMaTinh;

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="429"></A>    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater</B></FONT>.inflate(R.layout.fragment_diadiemgan_edit, container, false);
        sharedpreferences = <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#429',3,'match0-top.html#429',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        mTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        loadPhanQuyen(mTaiKhoan);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void loadPhanQuyen(String mTaiKhoan) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sql = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+mTaiKhoan+&quot;'&quot;;
            ResultSet resultSet = classConnect.selectData(getActivity</B></FONT>(), sql);
            while (resultSet != null &amp;&amp; resultSet.next()){
                mLoaiTaiKhoan = resultSet.getString(&quot;LoaiTaiKhoan&quot;);
                mMaTinh = resultSet.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
<A NAME="430"></A>        }catch (Exception e) {
            Log.d(&quot;TAG&quot;, e.getMessage());
        }
    <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#430',3,'match0-top.html#430',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void layoutAnhXa() {
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        cmdDiaDiem = view.findViewById(R.id.cmdDiaDiem);
        loadTinh(); //Load danh sách tỉnh, huyện, xã
        clickListView(); //Chọn địa điểm du lịch trên listview
<A NAME="431"></A>        clickButton</B></FONT>(); //Click nút thêm mới
        ganMaTinh = &quot;&quot;;
        ganMaHuyen = &quot;&quot;;
        <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#431',3,'match0-top.html#431',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganDiaDiemGan = &quot;&quot;;
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
<A NAME="432"></A>                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
                listMaHuyen.clear(); // Xóa danh sách huyện
                listTenHuyen.clear();
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(<FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#432',3,'match0-top.html#432',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
                listMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
<A NAME="433"></A>                listTenDiaDiem.clear();
                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listTenDiaDiem);
                dataDiaDiem.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#433',3,'match0-top.html#433',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdDiaDiem.setAdapter(dataDiaDiem);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (mLoaiTaiKhoan.equals(&quot;6&quot;) &amp;&amp; !mMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        cmdTinh.setEnabled(false);
                    }
<A NAME="434"></A>                    strMaTinh = listMaTinh.get(position);
                    loadHuyen(strMaTinh);
                }
            <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#434',3,'match0-top.html#434',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
<A NAME="435"></A>
                listMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
                listTenDiaDiem.clear();
                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(<FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#435',3,'match0-top.html#435',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listTenDiaDiem);
                dataDiaDiem.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdDiaDiem.setAdapter(dataDiaDiem);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
<A NAME="436"></A>        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#436',3,'match0-top.html#436',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()) {
                    strMaHuyen = listMaHuyen.get(position);
                    loadDiaDiem(strMaTinh, strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDiaDiem(String maTinh, String maHuyen){ //Danh sách địa điểm du lịch
        listMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
        listTenDiaDiem.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem from TB_DiaDiem &quot; +
                    &quot;where MaTinh = '&quot; + maTinh + &quot;' and MaHuyen = '&quot; + maHuyen + &quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null) {
                while (resultSetDiaDiem.next()) {
                    listMaDiaDiem.add(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;));
                    listTenDiaDiem.add(resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;));
                }
                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listTenDiaDiem);
                dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdDiaDiem.setAdapter(dataDiaDiem);
<A NAME="437"></A>            }
            if (listMaDiaDiem.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
            <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#437',3,'match0-top.html#437',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        } catch (Exception e) {
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdDiaDiem.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaDiaDiem.isEmpty()) {
                    strMaDiaDiem = listMaDiaDiem.get(position);
                    loadDiaDiemGan(strMaDiaDiem);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="438"></A>    private void loadDiaDiemGan(String maDiaDiem){
        arrayListDiaDiemGan = new ArrayList&lt;&gt;();
        arrayListDiaDiemGan.clear();
        <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#438',3,'match0-top.html#438',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiemGan = &quot;select distinct MaGan, dd.MaTinh, h.MaHuyen, dd.MaDiaDiem, TenDiaDiem, KhoangCach &quot; +
                    &quot;from TB_DiaDiem dd, TB_DiaDiemGan ddg, TB_Tinh t, TB_Huyen h where dd.MaDiaDiem = ddg.DiaDiemGan and &quot; +
                    &quot;dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen &quot; +
                    &quot;and dd.MaDiaDiem in (select DiaDiemGan from TB_DiaDiemGan where MaDiaDiem = '&quot;+maDiaDiem+&quot;')&quot;;
            ResultSet resultSetDiaDiemGan = classConnect.selectData(getActivity(), sqlDiaDiemGan);
            if (resultSetDiaDiemGan != null){
                while (resultSetDiaDiemGan.next()){
                    arrayListDiaDiemGan.add(new ClassDiaDiemGan_Edit(Integer.parseInt(resultSetDiaDiemGan.getString(&quot;MaGan&quot;)),
                            resultSetDiaDiemGan.getString(&quot;MaTinh&quot;), resultSetDiaDiemGan.getString(&quot;MaHuyen&quot;), resultSetDiaDiemGan.getString(&quot;MaDiaDiem&quot;),
                            resultSetDiaDiemGan.getString(&quot;TenDiaDiem&quot;), Double.parseDouble(resultSetDiaDiemGan.getString(&quot;KhoangCach&quot;))));
                }
            }
            if (arrayListDiaDiemGan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách điểm du lịch gần nhau&quot;);
            }
<A NAME="439"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#439',3,'match0-top.html#439',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterDiaDiemGan = new ListViewDiaDiemGan_Edit(getContext());
        listView.setAdapter(adapterDiaDiemGan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterDiaDiemGan.filter(newText);
        return false;
    }

    private void clickListView(){
        listView</B></FONT>.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateDiaDiemGan(position);
            }
        });
    }

    private void clickButton() {
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="440"></A>                updateDiaDiemGan(-1);
            }
        });
    <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#440',3,'match0-top.html#440',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

<A NAME="441"></A>    @SuppressLint(&quot;SetTextI18n&quot;)
    private void updateDiaDiemGan(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout</B></FONT> = <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#441',3,'match0-top.html#441',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>inflater.inflate(R.layout.dialog_diadiemgan_edit, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaGan = alertLayout.findViewById(R.id.editMaGan);
        cmdDialogTinh = alertLayout.findViewById(R.id.cmdTinh);
        cmdDialogHuyen = alertLayout.findViewById(R.id.cmdHuyen);
        cmdDialogDiaDiemGan = alertLayout.findViewById(R.id.cmdDiaDiemGan);
        editKhoangCach = alertLayout.findViewById(R.id.editKhoangCach);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
<A NAME="442"></A>            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI ĐIỂM DU LỊCH GẦN&quot;;
            textTieuDe</B></FONT>.setText(strTieuDe);
            String <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#442',3,'match0-top.html#442',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT ĐIỂM DU LỊCH GẦN&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
<A NAME="443"></A>            btnLuuLai.setText(strNut);
            editMaGan.setText(String.valueOf(arrayListDiaDiemGan</B></FONT>.get(intChiSo).getIntMaGan())); //Gán giá trị mã gần
            ganMaTinh = arrayListDiaDiemGan.get(intChiSo).getStrMaTinh(); //Gán giá trị mã tỉnh
            ganMaHuyen = <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#443',3,'match0-top.html#443',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDiaDiemGan.get(intChiSo).getStrMaHuyen(); //Gán giá trị mã huyện
            ganDiaDiemGan = arrayListDiaDiemGan.get(intChiSo).getStrMaDiaDiem(); //Gán giá trị mã huyện
            editKhoangCach.setText(String.valueOf(arrayListDiaDiemGan</B></FONT>.get(intChiSo).getDoubleKhoangCach())); //Gán giá trị khoảng cách
        }
        loadDialogTinh();
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try {
                    if (!listDialogMaDiaDiem.isEmpty()){
                        if (editKhoangCach.getText().length() != 0){
<A NAME="444"></A>                            String sqlDiaDiem;
                            if (intChiSo == -1){ //Thêm mới
                                sqlDiaDiem = &quot;insert into TB_DiaDiemGan(MaDiaDiem, DiaDiemGan, KhoangCach) &quot; +
                                        &quot;values ('&quot;+ strMaDiaDiem +&quot;', '&quot;+ strDialogMaDiaDiem +&quot;', '&quot;+<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#444',3,'match0-top.html#444',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Integer.parseInt(editKhoangCach.getText().toString())+&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlDiaDiem = &quot;update TB_DiaDiemGan set MaDiaDiem = '&quot;+ strMaDiaDiem +&quot;', DiaDiemGan = '&quot;+ strDialogMaDiaDiem +&quot;', &quot; +
                                        &quot;KhoangCach = '&quot;+Integer.parseInt(editKhoangCach.getText().toString())+&quot;' &quot;+
                                        &quot;where MaGan = '&quot;+ Integer.parseInt(editMaGan.getText().toString()) +&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlDiaDiem) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới địa điểm du lịch gần thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật địa điểm du lịch gần thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDiaDiemGan</B></FONT>(strMaDiaDiem); //Load lại danh sách
                            }
<A NAME="445"></A>                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }
                            <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#445',3,'match0-top.html#445',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn tên phường/xã&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn tên quận/huyện&quot;);
                    }</B></FONT>
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="446"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#446',3,'match0-top.html#446',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaGan.getText().length() != 0) {
                    dialogXoa(editMaGan.getText().toString(), arrayListDiaDiemGan.get(intChiSo).getStrTenDiaDiem());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã địa điểm du lịch để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="447"></A>                dialog.cancel();
            }
        });
        <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#447',3,'match0-top.html#447',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách địa điểm du lịch
    }

    private void dialogXoa(final String maDiaDiem, final String tenDiaDiem){
        //Hiện hộp thoại thông báo xóa địa điểm du lịch
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA ĐỊA ĐIỂM DU LỊCH GẦN&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa địa điểm du lịch\n&quot;+ tenDiaDiem +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="448"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#448',3,'match0-top.html#448',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlDiaDiem = &quot;delete TB_DiaDiemGan where MaGan = '&quot;+ maDiaDiem +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlDiaDiem) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa địa điểm du lịch gần thành công&quot;);
                        loadDiaDiemGan(strMaDiaDiem); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được địa điểm du lịch gần&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
<A NAME="449"></A>                dialogInterface.dismiss();
            }
        });
        AlertDialog <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#449',3,'match0-top.html#449',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
        alertDialog.show();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDialogTinh(){ //Danh sách tỉnh
        listDialogMaTinh.clear(); // Xóa danh sách tỉnh
        listDialogTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listDialogMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listDialogTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listDialogTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="450"></A>                cmdDialogTinh.setAdapter(dataTinh);
            }
            if (listDialogMaTinh.isEmpty()){
                classPublic.ThongBao(<FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#450',3,'match0-top.html#450',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listDialogMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listDialogMaHuyen.clear(); // Xóa danh sách huyện
            listDialogTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listDialogTenHuyen);
<A NAME="451"></A>            dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdDialogHuyen.setAdapter(dataHuyen);
            loadDialogDiaDiem(strDialogMaTinh, strDialogMaHuyen); //Load danh điểm du lịch
        <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#451',3,'match0-top.html#451',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        cmdDialogTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listDialogMaTinh.isEmpty()) {
                    strDialogMaTinh = listDialogMaTinh.get(position);
<A NAME="452"></A>                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdDialogTinh</B></FONT>.setSelection(listDialogMaTinh.indexOf(ganMaTinh));
                        strDialogMaTinh = ganMaTinh;
                        <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#452',3,'match0-top.html#452',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaTinh = &quot;&quot;;
                    }
                    loadDialogHuyen(strDialogMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDialogHuyen(String maTinh){ //Danh sách huyện
        listDialogMaHuyen.clear(); // Xóa danh sách huyện
        listDialogTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listDialogMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listDialogTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listDialogTenHuyen);
                dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="453"></A>                cmdDialogHuyen.setAdapter(dataHuyen);
            }
            if (listDialogMaHuyen.isEmpty()){
                classPublic.ThongBao(<FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#453',3,'match0-top.html#453',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listDialogMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listDialogMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
            listDialogTenDiaDiem.clear();
<A NAME="454"></A>            ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listDialogTenDiaDiem);
            dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdDialogDiaDiemGan.setAdapter(dataDiaDiem);
        <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#454',3,'match0-top.html#454',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        cmdDialogHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listDialogMaHuyen.isEmpty()) {
                    strDialogMaHuyen = listDialogMaHuyen.get(position);
<A NAME="455"></A>                    if (!ganMaHuyen.equals(&quot;&quot;)){
                        cmdDialogHuyen</B></FONT>.setSelection(listDialogMaHuyen.indexOf(ganMaHuyen));
                        strDialogMaHuyen = ganMaHuyen;
                        <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#455',3,'match0-top.html#455',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaHuyen = &quot;&quot;;
                    }
                    loadDialogDiaDiem(strDialogMaTinh, strDialogMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDialogDiaDiem(String maTinh, String maHuyen){ //Danh sách địa điểm du lịch
        listDialogMaDiaDiem.clear(); // Xóa danh sách địa điểm du lịch
        listDialogTenDiaDiem.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem from TB_DiaDiem &quot; +
                    &quot;where MaTinh = '&quot; + maTinh + &quot;' and MaHuyen = '&quot; + maHuyen + &quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null) {
                while (resultSetDiaDiem.next()) {
                    listDialogMaDiaDiem.add(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;));
                    listDialogTenDiaDiem.add(resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;));
                }
<A NAME="456"></A>                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listDialogTenDiaDiem);
                dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdDialogDiaDiemGan.setAdapter(dataDiaDiem);
            <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#456',3,'match0-top.html#456',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            if (listDialogMaDiaDiem.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        } catch (Exception e) {
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdDialogDiaDiemGan.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listDialogMaDiaDiem.isEmpty()) {
                    strDialogMaDiaDiem = listDialogMaDiaDiem.get(position);
<A NAME="457"></A>                    if (!ganDiaDiemGan.equals(&quot;&quot;)){
                        cmdDialogDiaDiemGan</B></FONT>.setSelection(listDialogMaDiaDiem.indexOf(ganDiaDiemGan));
                        strDialogMaDiaDiem = ganDiaDiemGan;
                        <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#457',3,'match0-top.html#457',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganDiaDiemGan = &quot;&quot;;
                    }
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
}</B></FONT>


</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentDiaDiemGan_View.java</CENTER></H3><HR>
<PRE>
<A NAME="458"></A>package com.example.travelling.DiaDiem;

<FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#458',3,'match0-top.html#458',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentDiaDiemGan_View extends Fragment implements SearchView.OnQueryTextListener{

<A NAME="459"></A>    //Phần khai báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#459',3,'match0-top.html#459',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
    TextView textDiaDiem;
    public static String strMaDiaDiem, strMaTinh;
    ImageButton btnQuayLai</B></FONT>;
    public static ArrayList&lt;ClassDiaDiemGan_View&gt; arrayListDiaDiemGan;
<A NAME="460"></A>    ListViewDiaDiemGan_View adapterDiaDiemGan;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();

    <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#460',3,'match0-top.html#460',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
<A NAME="461"></A>    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_diadiemgan_view, container, false);
        fragmentManager = Objects</B></FONT>.requireNonNull(<FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#461',3,'match0-top.html#461',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;); //Lấy mã địa điểm được gửi qua từ FragmentDiaDiem_View
            strMaTinh = bundle</B></FONT>.getString(&quot;MaTinh&quot;); ////Lấy mã tỉnh được gửi qua từ FragmentDiaDiem_View
        }
        else {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="462"></A>        return view;
    }

    private <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#462',3,'match0-top.html#462',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
<A NAME="463"></A>        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        listView = view.findViewById(R.id.listView);
        layTenDiaDiem</B></FONT>(strMaDiaDiem); //Lấy tên địa điểm du lịch
        <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#463',3,'match0-top.html#463',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadHienThi();
        clickButton();
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi</B></FONT>.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    loadDanhSachDiaDiemGan(strMaDiaDiem, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
<A NAME="464"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void layTenDiaDiem(String maDiaDiem) {
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#464',3,'match0-top.html#464',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select TenDiaDiem from TB_DiaDiem where MaDiaDiem = '&quot;+ maDiaDiem +&quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()){
                textDiaDiem.setText(resultSetDiaDiem</B></FONT>.getString(&quot;TenDiaDiem&quot;).toUpperCase());
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDiaDiemGan(String maDiaDiem, String hienThi) {
        arrayListDiaDiemGan = new ArrayList&lt;&gt;();
        arrayListDiaDiemGan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlDiaDiem = &quot;select dd.MaDiaDiem, TenDiaDiem, t.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, ddg.KhoangCach, dd.Youtube &quot; +
                        &quot;from TB_DiaDiem dd, TB_DiaDiemGan ddg, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaDiaDiem = ddg.DiaDiemGan &quot; +
                        &quot;and dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa &quot; +
                        &quot;and dd.MaDiaDiem in (select DiaDiemGan from TB_DiaDiemGan where MaDiaDiem = '&quot; + maDiaDiem + &quot;') &quot; +
                        &quot;order by KhoangCach asc&quot;;
            }
            else {
                sqlDiaDiem = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; dd.MaDiaDiem, TenDiaDiem, t.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, ddg.KhoangCach, dd.Youtube &quot; +
                        &quot;from TB_DiaDiem dd, TB_DiaDiemGan ddg, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaDiaDiem = ddg.DiaDiemGan &quot; +
                        &quot;and dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa &quot; +
<A NAME="465"></A>                        &quot;and dd.MaDiaDiem in (select DiaDiemGan from TB_DiaDiemGan where MaDiaDiem = '&quot; + maDiaDiem + &quot;') &quot; +
                        &quot;order by KhoangCach asc&quot;;
            }
<A NAME="466"></A>            ResultSet <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#465',3,'match0-top.html#465',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null){
                while (resultSetDiaDiem.next()){
                    arrayListDiaDiemGan.add(new ClassDiaDiemGan_View(resultSetDiaDiem</B></FONT>.getString(&quot;MaDiaDiem&quot;), <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#466',3,'match0-top.html#466',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;),
                            resultSetDiaDiem.getString(&quot;MaTinh&quot;), resultSetDiaDiem.getString(&quot;TenTinh&quot;),
                            resultSetDiaDiem.getString(&quot;TenHuyen&quot;), resultSetDiaDiem.getString(&quot;TenXa&quot;),
                            resultSetDiaDiem.getString(&quot;Anh&quot;), resultSetDiaDiem.getInt(&quot;LuotThich&quot;), Double.parseDouble(resultSetDiaDiem.getString(&quot;KhoangCach&quot;)), resultSetDiaDiem.getString(&quot;Youtube&quot;)));
                }
            }
            if (arrayListDiaDiemGan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
            }
<A NAME="467"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#467',3,'match0-top.html#467',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterDiaDiemGan = new ListViewDiaDiemGan_View(getContext());
        listView.setAdapter(adapterDiaDiemGan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }
    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterDiaDiemGan.filter(newText);
        return false;
    }

    private void</B></FONT> clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (strMaTinh.equals(&quot;&quot;)){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else {
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentDiaDiem_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="468"></A><FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#468',3,'match0-top.html#468',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentDiaDiem_Edit extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    ImageButton btnThemMoi;
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="469"></A>    ListView listView;
    public static ArrayList&lt;ClassDiaDiem_Edit&gt; arrayListDiaDiem;
    ListViewDiaDiem_Edit adapterDiaDiem;
    ArrayList&lt;<FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#469',3,'match0-top.html#469',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaXa = new ArrayList&lt;&gt;(); //Khai báo danh sách xã
    ArrayList&lt;String&gt; listTenXa = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    String strMaTinh, strMaHuyen, strMaXa, ganMaHuyen, ganMaXa, strHienThi;
    TextView textTieuDe;
    EditText editMaDiaDiem, editTenDiaDiem, editYoutube, editKinhDo, editViDo;
    Spinner cmdHuyen, cmdXa;
    Button btnLuuLai, btnXoa, btnDong;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="470"></A>    SharedPreferences.Editor editor;
    String mTaiKhoan, mLoaiTaiKhoan, mMaTinh</B></FONT>;

    public <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#470',3,'match0-top.html#470',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_diadiem_edit, container, false);
<A NAME="471"></A>        sharedpreferences = Objects.requireNonNull(this</B></FONT>.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        mTaiKhoan = <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#471',3,'match0-top.html#471',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sharedpreferences.getString(User,&quot;&quot;);
        loadPhanQuyen(mTaiKhoan);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void loadPhanQuyen(String mTaiKhoan) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sql = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+mTaiKhoan+&quot;'&quot;;
            ResultSet resultSet = classConnect.selectData(getActivity</B></FONT>(), sql);
            while (resultSet != null &amp;&amp; resultSet.next()){
                mLoaiTaiKhoan = resultSet.getString(&quot;LoaiTaiKhoan&quot;);
                mMaTinh = resultSet.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e) {
            Log.d(&quot;TAG&quot;, e.getMessage());
<A NAME="472"></A>        }
    }

    private <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#472',3,'match0-top.html#472',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view.findViewById(R.id.listView);
<A NAME="473"></A>        loadTinh</B></FONT>(); //Load tên tỉnh
        loadHienThi();
        clickListView(); //Chọn địa điểm du lịch trên listview
        <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#473',3,'match0-top.html#473',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>clickButton(); //Click nút thêm mới
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="474"></A>                cmdTinh.setAdapter(dataTinh);
            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(<FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#474',3,'match0-top.html#474',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (mLoaiTaiKhoan.equals(&quot;6&quot;) &amp;&amp; !mMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        cmdTinh.setEnabled(false);
                    }
<A NAME="475"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachDiaDiem(strMaTinh, strHienThi);
                }
            <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#475',3,'match0-top.html#475',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void loadHienThi() {
        listHienThi.clear();
<A NAME="476"></A>        listHienThi.add(&quot;10&quot;);
        listHienThi</B></FONT>.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#476',3,'match0-top.html#476',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="477"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(<FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#477',3,'match0-top.html#477',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachDiaDiem(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void</B></FONT> clickListView(){
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateDiaDiem(position);
            }
        });
    }

    private void clickButton() {
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                updateDiaDiem(-1);
            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDiaDiem(String maTinh, String hienThi) {
        arrayListDiaDiem = new ArrayList&lt;&gt;();
        arrayListDiaDiem.clear();
        if (!maTinh.equals(&quot;&quot;)) {
            try {
                classConnect = new ClassConnect(); //Mở kết nối đến SQL
                String sqlDiaDiem;
                if (hienThi.equals(&quot;Tất cả&quot;)) {
                    sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem, TenTinh, h.MaHuyen, TenHuyen, x.MaXa, TenXa, Youtube, Anh, LuotThich, KinhDo, ViDo &quot; +
                            &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and &quot; +
                            &quot;dd.MaXa = x.MaXa and dd.MaTinh = '&quot; + maTinh + &quot;' order by dd.LuotThich desc&quot;;
                }
                else {
                    sqlDiaDiem = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaDiaDiem, TenDiaDiem, TenTinh, h.MaHuyen, TenHuyen, x.MaXa, TenXa, Youtube, Anh, LuotThich, KinhDo, ViDo &quot; +
<A NAME="478"></A>                            &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and &quot; +
                            &quot;dd.MaXa = x.MaXa and dd.MaTinh = '&quot; + maTinh + &quot;' order by dd.LuotThich desc&quot;;
                }
                ResultSet <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#478',3,'match0-top.html#478',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
                if (resultSetDiaDiem != null) {
                    while (resultSetDiaDiem.next()) {
                        arrayListDiaDiem.add(new ClassDiaDiem_Edit(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;), resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;),
                                resultSetDiaDiem.getString(&quot;TenTinh&quot;), resultSetDiaDiem.getString(&quot;MaHuyen&quot;), resultSetDiaDiem.getString(&quot;TenHuyen&quot;),
                                resultSetDiaDiem.getString(&quot;MaXa&quot;), resultSetDiaDiem.getString(&quot;TenXa&quot;), resultSetDiaDiem.getString(&quot;Youtube&quot;), resultSetDiaDiem.getString(&quot;Anh&quot;),
                                resultSetDiaDiem.getInt(&quot;LuotThich&quot;), Float.parseFloat(resultSetDiaDiem.getString(&quot;KinhDo&quot;)),
                                Float.parseFloat(resultSetDiaDiem.getString(&quot;ViDo&quot;))));
                    }
                }
                if (arrayListDiaDiem.isEmpty()) {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
                }
                classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
            } catch (Exception e) {
                Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
            }
        }
        adapterDiaDiem = new ListViewDiaDiem_Edit(getContext());
        listView.setAdapter(adapterDiaDiem);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
<A NAME="479"></A>    }

    @SuppressLint(&quot;SetTextI18n&quot;)
    private <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#479',3,'match0-top.html#479',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void updateDiaDiem(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_diadiem, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaDiaDiem = alertLayout.findViewById(R.id.editMaDiaDiem);
        editTenDiaDiem = alertLayout.findViewById(R.id.editTenDiaDiem);
        cmdHuyen = alertLayout.findViewById(R.id.cmdHuyen);
        cmdXa = alertLayout.findViewById(R.id.cmdXa);
        editYoutube = alertLayout.findViewById(R.id.editYoutube);
        editKinhDo = alertLayout.findViewById(R.id.editKinhDo);
        editViDo = alertLayout.findViewById(R.id.editViDo);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI TÊN ĐỊA ĐIỂM DU LỊCH&quot;;
            textTieuDe</B></FONT>.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
<A NAME="480"></A>            ganMaHuyen = &quot;&quot;;
            ganMaXa = &quot;&quot;;
        }
        <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#480',3,'match0-top.html#480',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT TÊN ĐỊA ĐIỂM DU LỊCH&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
<A NAME="481"></A>            editMaDiaDiem.setText(arrayListDiaDiem.get(intChiSo).getStrMaDiaDiem()); //Gán giá trị mã địa điểm du lịch
            editTenDiaDiem.setText(arrayListDiaDiem</B></FONT>.get(intChiSo).getStrTenDiaDiem()); //Gán giá trị tên địa điểm du lịch
            ganMaHuyen = arrayListDiaDiem.get(intChiSo).getStrMaHuyen(); //Gán giá trị mã huyện
            ganMaXa = <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#481',3,'match0-top.html#481',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListDiaDiem.get(intChiSo).getStrMaXa(); //Gán giá trị mã xã
            editYoutube.setText(arrayListDiaDiem.get(intChiSo).getStrYoutube()); //Gán giá trị file youtube
            editKinhDo.setText(arrayListDiaDiem.get(intChiSo).getFloatKinhDo().toString()); //Gán giá trị kinh độ
            editViDo.setText(arrayListDiaDiem.get(intChiSo).getFloatViDo().toString()); //Gán giá trị vĩ độ
        }
        loadHuyen</B></FONT>(strMaTinh);
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try {
                    if (editTenDiaDiem.getText().length() != 0){
                        if (!listMaTinh.isEmpty()){
                            if (!listMaHuyen.isEmpty()){
                                if (!listMaXa.isEmpty()){
                                    String sqlDiaDiem;
                                    if (intChiSo == -1){ //Thêm mới
                                        sqlDiaDiem = &quot;insert into TB_DiaDiem(TenDiaDiem, MaTinh, MaHuyen, MaXa, KinhDo, ViDo) &quot; +
                                                &quot;values (N'&quot;+ editTenDiaDiem.getText() +&quot;', '&quot;+ strMaTinh +&quot;', '&quot;+ strMaHuyen +&quot;', &quot; +
<A NAME="482"></A>                                                &quot;'&quot;+ strMaXa +&quot;', '&quot;+Float.parseFloat(editKinhDo.getText().toString())+&quot;', '&quot;+Float.parseFloat(editViDo.getText().toString())+&quot;')&quot;;
                                    }
                                    else { //Cập nhật
                                        sqlDiaDiem = &quot;update TB_DiaDiem set TenDiaDiem = N'&quot;+ <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#482',3,'match0-top.html#482',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editTenDiaDiem.getText() +&quot;', MaHuyen = '&quot;+ strMaHuyen +&quot;', MaXa = '&quot;+ strMaXa +&quot;', &quot; +
                                                &quot;KinhDo = '&quot;+Float.parseFloat(editKinhDo.getText().toString())+&quot;', ViDo = '&quot;+Float.parseFloat(editViDo.getText().toString())+&quot;' &quot; +
                                                &quot;where MaDiaDiem = '&quot;+ editMaDiaDiem.getText() +&quot;'&quot;;
                                    }
                                    classConnect = new ClassConnect(); //Mở kết nối SQL
                                    if (classConnect.updateData(getActivity(), sqlDiaDiem) == 1){
                                        if (intChiSo == -1){
                                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên địa điểm du lịch thành công&quot;);
                                        }
                                        else {
                                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên địa điểm du lịch thành công&quot;);
                                        }
                                        dialog.cancel(); //Đóng dialog
                                        loadDanhSachDiaDiem</B></FONT>(strMaTinh, strHienThi); //Load lại danh sách
                                    }
<A NAME="483"></A>                                    else {
                                        classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                                    }
                                    <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#483',3,'match0-top.html#483',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn tên phường/xã&quot;);
                                }
                            }
                            else {
                                classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn tên quận/huyện&quot;);
                            }
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng chọn tên tỉnh/thành phố&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên địa điểm du lịch&quot;);
                    }</B></FONT>
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="484"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#484',3,'match0-top.html#484',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaDiaDiem.getText().length() != 0) {
                    dialogXoa(editMaDiaDiem.getText().toString(), editTenDiaDiem.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã địa điểm du lịch để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="485"></A>                dialog.cancel();
            }
        });
        <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#485',3,'match0-top.html#485',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách địa điểm du lịch
    }

    private void dialogXoa(final String maDiaDiem, final String tenDiaDiem){
        //Hiện hộp thoại thông báo xóa địa điểm du lịch
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN ĐỊA ĐIỂM DU LỊCH&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa tên địa điểm du lịch\n&quot;+ tenDiaDiem +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="486"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#486',3,'match0-top.html#486',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlDiaDiem = &quot;delete TB_DiaDiem where MaDiaDiem = '&quot;+ maDiaDiem +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlDiaDiem) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên địa điểm du lịch thành công&quot;);
                        loadDanhSachDiaDiem(strMaTinh, strHienThi); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên địa điểm du lịch&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
<A NAME="487"></A>            }
        });
        AlertDialog alertDialog = builder.create();
        <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#487',3,'match0-top.html#487',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog.show();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
<A NAME="488"></A>                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(<FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#488',3,'match0-top.html#488',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
            }
            else {
                Log.e(&quot;TAG&quot;, &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaXa.clear(); // Xóa danh sách xã
            listTenXa.clear();
<A NAME="489"></A>            ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenXa);
            dataXa</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdXa.setAdapter(dataXa);
        <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#489',3,'match0-top.html#489',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()){
                    strMaHuyen = listMaHuyen.get(position);
<A NAME="490"></A>                    if (!ganMaHuyen.equals(&quot;&quot;)) {
                        cmdHuyen</B></FONT>.setSelection(listMaHuyen.indexOf(ganMaHuyen));
                        strMaHuyen = ganMaHuyen;
                        <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#490',3,'match0-top.html#490',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaHuyen = &quot;&quot;;
                    }
                    loadXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadXa(String maHuyen){
        //Danh sách huyện
        listMaXa.clear(); // Xóa danh sách huyện
        listTenXa.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
            ResultSet resultSetXa = classConnect.selectData(getActivity(), sqlXa);
            if (resultSetXa != null){
                while (resultSetXa.next()){
                    listMaXa.add(resultSetXa.getString(&quot;MaXa&quot;));
                    listTenXa.add(resultSetXa.getString(&quot;TenXa&quot;));
<A NAME="491"></A>                }
                ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenXa);
                dataXa</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#491',3,'match0-top.html#491',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdXa.setAdapter(dataXa);
            }
            else {
                Log.e(&quot;TAG&quot;, &quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdXa.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaXa.isEmpty()){
                    strMaXa = listMaXa.get(position);
<A NAME="492"></A>                    if (!ganMaXa.equals(&quot;&quot;)){
                        cmdXa</B></FONT>.setSelection(listMaXa.indexOf(ganMaXa));
                        strMaXa = ganMaXa;
                        <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#492',3,'match0-top.html#492',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaXa = &quot;&quot;;
                    }
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {
<A NAME="493"></A>
            }
        }</B></FONT>);
    <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#493',3,'match0-top.html#493',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterDiaDiem.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentDiaDiem_View.java</CENTER></H3><HR>
<PRE>
<A NAME="494"></A>package com.example.travelling.DiaDiem;

<FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#494',3,'match0-top.html#494',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentDiaDiem_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="495"></A>    ListView listView;
    public static ArrayList&lt;ClassDiaDiem_View&gt; arrayListDiaDiem;
    ListViewDiaDiem_View adapterDiaDiem;
    ArrayList&lt;<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#495',3,'match0-top.html#495',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
<A NAME="496"></A>    public static String strMaTinh, ganMaTinh, strHienThi, mMaTinh;
    int intDieuKien</B></FONT> = 0;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#496',3,'match0-top.html#496',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editor;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_diadiem_view, container, false);
        sharedpreferences = Objects</B></FONT>.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            ganMaTinh = bundle.getString(&quot;MaTinh&quot;); ////Lấy mã tỉnh được gửi qua từ FragmentNhaHang_View
        }
        else {
            ganMaTinh = &quot;&quot;;
        }
        mMaTinh = classPublic.layMaTinh(sharedpreferences.getString(User,&quot;&quot;), getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="497"></A>        return view;
    }

    private <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#497',3,'match0-top.html#497',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
<A NAME="498"></A>        searchView = view.findViewById(R.id.searchTen);
        listView = view.findViewById(R.id.listView);
        loadTinh</B></FONT>(); //Load tên tỉnh
        <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#498',3,'match0-top.html#498',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadHienThi();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
<A NAME="499"></A>            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#499',3,'match0-top.html#499',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?</B></FONT>&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    if (ganMaTinh.equals(&quot;&quot;) &amp;&amp; intDieuKien == 0){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        intDieuKien = 1;
                    }
                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(ganMaTinh));
                        ganMaTinh = &quot;&quot;;
                    }

<A NAME="500"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachDiaDiem(strMaTinh, strHienThi);
                }
            <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#500',3,'match0-top.html#500',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void</B></FONT> loadHienThi() {
        listHienThi.clear();
<A NAME="501"></A>        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#501',3,'match0-top.html#501',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="502"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#502',3,'match0-top.html#502',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachDiaDiem(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDiaDiem(String maTinh, String hienThi) {
        arrayListDiaDiem = new ArrayList&lt;&gt;();
        arrayListDiaDiem.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem, t.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, dd.Youtube &quot; +
                        &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen &quot; +
                        &quot;and dd.MaXa = x.MaXa and dd.MaTinh = '&quot; + maTinh + &quot;' order by dd.LuotThich desc&quot;;
            }
            else {
                sqlDiaDiem = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaDiaDiem, TenDiaDiem, t.MaTinh, TenTinh, TenHuyen, TenXa, Anh, LuotThich, dd.Youtube &quot; +
<A NAME="503"></A>                        &quot;from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen &quot; +
                        &quot;and dd.MaXa = x.MaXa and dd.MaTinh = '&quot; + maTinh + &quot;' order by dd.LuotThich desc&quot;;
            }
            ResultSet <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#503',3,'match0-top.html#503',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null){
                while (resultSetDiaDiem.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where MaSo = '&quot;+resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListDiaDiem.add(new ClassDiaDiem_View(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;), resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;),
                            resultSetDiaDiem.getString(&quot;MaTinh&quot;), resultSetDiaDiem.getString(&quot;TenTinh&quot;),
                            resultSetDiaDiem.getString(&quot;TenHuyen&quot;), resultSetDiaDiem.getString(&quot;TenXa&quot;),
                            resultSetDiaDiem.getString(&quot;Anh&quot;), resultSetDiaDiem.getInt(&quot;LuotThich&quot;), intBinhLuan, resultSetDiaDiem</B></FONT>.getString(&quot;Youtube&quot;)));
                }
            }
            if (arrayListDiaDiem.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách địa điểm du lịch&quot;);
<A NAME="504"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#504',3,'match0-top.html#504',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterDiaDiem = new ListViewDiaDiem_View(getContext());
        listView.setAdapter(adapterDiaDiem);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterDiaDiem.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\FragmentThoiTiet.java</CENTER></H3><HR>
<PRE>
<A NAME="505"></A>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
<FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#505',3,'match0-top.html#505',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.android.volley.Request;
import com.android.volley.RequestQueue;
import com.android.volley.Response;
import com.android.volley.VolleyError;
import com.android.volley.toolbox.JsonObjectRequest;
import com.android.volley.toolbox.Volley;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import java.sql.ResultSet;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.Objects;

public class FragmentThoiTiet extends Fragment {
    //Khai báo
    private View view;
<A NAME="506"></A>    private ListView listView</B></FONT>;
    public static ArrayList&lt;ClassThoiTiet&gt; arrayListThoiTiet;
    private ListViewThoiTiet adapterThoiTiet;
    private ClassPublic classPublic = <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#506',3,'match0-top.html#506',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>new ClassPublic();
    private String strMaDiaDiem, strMaTinh, strKinhDo, strViDo;
    private ImageButton btnQuayLai;
    private TextView textDiaDiem, textDiaChi;
    private ClassConnect classConnect;
    private FragmentManager fragmentManager; //Tạo Fragment
<A NAME="507"></A>    private FragmentTransaction fragmentTransaction;
    private static final int REQUEST_LOCATION</B></FONT> = 1; //Dự báo thời tiết
    private RequestQueue requestQueue;
    private  String <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#507',3,'match0-top.html#507',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strUrl;
    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_thoitiet, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
<A NAME="508"></A>        Bundle bundle = this</B></FONT>.getArguments();
        if (bundle != null){
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;);
            <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#508',3,'match0-top.html#508',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh = bundle.getString(&quot;MaTinh&quot;);
        }
        else {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa();
        return view;
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        listView = view.findViewById(R.id.listView);
        layDiaDiem(strMaDiaDiem);
        requestQueue = Volley.newRequestQueue(Objects.requireNonNull(getActivity()));
        getWeather(strUrl);
        clickButton();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void layDiaDiem(String maDiaDiem) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select * from TB_DiaDiem dd, TB_Tinh t, TB_Huyen h, TB_Xa x &quot; +
                    &quot;where dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa and dd.MaDiaDiem = '&quot;+ maDiaDiem +&quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()){
                String strDiaChi = resultSetDiaDiem.getString(&quot;TenXa&quot;);
                strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetDiaDiem.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetDiaDiem.getString(&quot;TenTinh&quot;));
                textDiaDiem.setText(resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;).toUpperCase());
                textDiaChi.setText(strDiaChi);
                strKinhDo = resultSetDiaDiem.getString(&quot;KinhDo&quot;);
                strViDo = resultSetDiaDiem.getString(&quot;ViDo&quot;);
                strUrl = &quot;http://api.openweathermap.org/data/2.5/forecast?lat=&quot;+strKinhDo+&quot;&amp;lon=&quot;+strViDo+&quot;&amp;units=metric&amp;cnt=7&amp;lang=vi&amp;appid=f61469e5fd6b1dab8f4e33481396c915&quot;;
            }
            classConnect.CONN(getActivity()).close();
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void getWeather(String url) {
<A NAME="509"></A>        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest</B></FONT>(Request.Method.GET, url, null, new Response.Listener&lt;JSONObject&gt;() {
            @Override
            public void onResponse(JSONObject response) {
                <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#509',3,'match0-top.html#509',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    arrayListThoiTiet = new ArrayList&lt;&gt;();
                    arrayListThoiTiet.clear();
                    JSONArray jsonArray = response.getJSONArray(&quot;list&quot;);
                    for (int i = 0; i &lt; jsonArray.length(); i++){
                        JSONObject jsonObjectList = jsonArray.getJSONObject(i);

                        //Chuyển sang định dạng ngày
                        Calendar calendar = Calendar.getInstance();
                        calendar.add(Calendar.DAY_OF_YEAR,i);
                        Date date = calendar.getTime();
                        @SuppressLint(&quot;SimpleDateFormat&quot;) SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;EEEE dd-MM-yyyy&quot;);
                        String strDay = simpleDateFormat.format(date);

                        JSONObject jsonObjectTemp = jsonObjectList.getJSONObject(&quot;main&quot;);
                        String nhietDo = jsonObjectTemp.getString(&quot;temp&quot;);
                        //Chuyển sang nhiệt độ
<A NAME="510"></A>                        Double doubleNhietDo = Double.valueOf(nhietDo);
                        String strNhietDo = doubleNhietDo</B></FONT>.intValue() + &quot;°C&quot;;

                        String <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#510',3,'match0-top.html#510',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strDoAm = jsonObjectTemp.getString(&quot;humidity&quot;).concat(&quot;%&quot;);

                        JSONObject jsonObjectWind = jsonObjectList.getJSONObject(&quot;wind&quot;);
                        String strTocDoGio = jsonObjectWind.getString(&quot;speed&quot;).concat(&quot;m/s&quot;);

                        JSONArray jsonArrayWeather = jsonObjectList.getJSONArray(&quot;weather&quot;);
                        JSONObject jsonObjectWeather = jsonArrayWeather.getJSONObject(0);
                        String strTrangThai = jsonObjectWeather.getString(&quot;description&quot;);
                        String strImage = jsonObjectWeather.getString(&quot;icon&quot;);
                        arrayListThoiTiet.add(new ClassThoiTiet(strDay, strTrangThai, strImage,strNhietDo, strTocDoGio, strDoAm));
                    }
                    adapterThoiTiet = new ListViewThoiTiet(getContext());
                    listView.setAdapter(adapterThoiTiet);
                } catch (JSONException e) {
                    e</B></FONT>.printStackTrace();
                }
            }
        }, new Response.ErrorListener() {
            @Override
            public void onErrorResponse(VolleyError error) {

            }
        });
        requestQueue.add(jsonObjectRequest);
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (strMaTinh.equals(&quot;&quot;)){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else {
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ListViewDiaDiemGan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="511"></A><FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#511',3,'match0-top.html#511',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewDiaDiemGan_Edit extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassDiaDiemGan_Edit&gt; arraylist;

    public ListViewDiaDiemGan_Edit(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDiaDiemGan_Edit.arrayListDiaDiemGan);
    }

    public static class ViewHolder {
        TextView textDiaDiemGan, textKhoangCach;
    }
    @Override
    public int getCount() {
        return FragmentDiaDiemGan_Edit.arrayListDiaDiemGan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDiaDiemGan_Edit.arrayListDiaDiemGan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;DefaultLocale&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewDiaDiemGan_Edit.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewDiaDiemGan_Edit.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_diadiemgan_edit, null);
            holder.textDiaDiemGan = convertView.findViewById(R.id.textDiaDiemGan);
            holder.textKhoangCach = convertView.findViewById(R.id.textKhoangCach);
            convertView.setTag(holder);
        } else {
            holder = (ListViewDiaDiemGan_Edit.ViewHolder) convertView.getTag();
        }

        holder.textDiaDiemGan.setText((position + 1) + &quot;. &quot; + FragmentDiaDiemGan_Edit</B></FONT>.arrayListDiaDiemGan.get(position).getStrTenDiaDiem());
        Double doubleKhoangCach = FragmentDiaDiemGan_Edit.arrayListDiaDiemGan.get(position).getDoubleKhoangCach();
        if (doubleKhoangCach &lt; 1000) {
            holder.textKhoangCach.setText(&quot;Cách khoảng: &quot; + String.format(&quot;%.0f&quot;, doubleKhoangCach) +&quot;m&quot;);
<A NAME="512"></A>        }
        else {
            holder.textKhoangCach.setText(&quot;Cách khoảng: &quot; + doubleKhoangCach/1000 +&quot;km&quot;);
        <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#512',3,'match0-top.html#512',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDiaDiemGan_Edit.arrayListDiaDiemGan.clear();
        if (charText.length() == 0) {
            FragmentDiaDiemGan_Edit.arrayListDiaDiemGan.addAll(arraylist);
        } else {
            for (ClassDiaDiemGan_Edit wp : arraylist) {
                if (wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDiaDiemGan_Edit</B></FONT>.arrayListDiaDiemGan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ListViewDiaDiemGan_View.java</CENTER></H3><HR>
<PRE>
<A NAME="513"></A><FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#513',3,'match0-top.html#513',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_Home;
import com.example.travelling.KhachSan.FragmentKhachSan_View;
import com.example.travelling.NhaHang.FragmentNhaHang_View;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDiaDiemGan_View extends BaseAdapter {
    private Context mContext;
<A NAME="514"></A>    private LayoutInflater inflater</B></FONT>;
    private ArrayList&lt;ClassDiaDiemGan_View&gt; arraylist;
    private ClassConnect classConnect;
    private ClassPublic <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#514',3,'match0-top.html#514',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic;
    public ListViewDiaDiemGan_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDiaDiemGan_View.arrayListDiaDiemGan);
    }
    public static class ViewHolder {
        TextView textTenDiaDiem, textDiaChi, textLuotThich, textKhoangCach;
        ImageView imageDiaDiem;
        ImageButton btnVideo, btnChiDuong, btnCtyDuLich, btnNhaHang, btnKhachSan, btnDiaDiemGan, btnThoiTiet, btnLike;
    }
    @Override
    public int getCount() {
        return FragmentDiaDiemGan_View.arrayListDiaDiemGan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;, &quot;DefaultLocale&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewDiaDiemGan_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewDiaDiemGan_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_diadiemgan_view, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textTenDiaDiem = convertView.findViewById(R.id.textTenDiaDiem);
            holder.imageDiaDiem = convertView.findViewById(R.id.imageDiaDiem);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.btnVideo = convertView.findViewById(R.id.btnVideo);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnCtyDuLich = convertView.findViewById(R.id.btnCtyDuLich);
            holder.btnNhaHang = convertView.findViewById(R.id.btnNhaHang);
            holder.btnKhachSan = convertView.findViewById(R.id.btnKhachSan);
            holder.btnDiaDiemGan = convertView.findViewById(R.id.btnDiaDiemGan);
            holder.btnThoiTiet = convertView.findViewById(R.id.btnThoiTiet);
            holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.textKhoangCach = convertView.findViewById(R.id.textKhoangCach);
            convertView.setTag(holder);
        } else {
<A NAME="515"></A>            holder = (ListViewDiaDiemGan_View.ViewHolder) convertView.getTag();
        }</B></FONT>

        <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#515',3,'match0-top.html#515',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTenDiaDiem.setText((position + 1) + &quot;. &quot; + FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrTenDiaDiem().toUpperCase());
<A NAME="516"></A>        String strAnh = FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrAnh();
        if</B></FONT> (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
<A NAME="517"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#516',3,'match0-top.html#516',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager</B></FONT>.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#517',3,'match0-top.html#517',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDiaDiem); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imageDiaDiem.setImageResource(R.drawable.no_image);
<A NAME="518"></A>        }

        String strDiaChi = FragmentDiaDiemGan_View</B></FONT>.arrayListDiaDiemGan.get(position).getStrTenXa();
        <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#518',3,'match0-top.html#518',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strDiaChi = strDiaChi.concat(&quot; - &quot; + FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrTenHuyen() + &quot; - &quot; + FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrTenTinh());
        holder.textDiaChi.setText(strDiaChi);
        final Integer[] intThich = {</B></FONT>FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt&quot;);
        Double doubleKhoangCach = FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getDoubleKhoangCach();
        if (doubleKhoangCach &lt; 1000) {
            holder.textKhoangCach.setText(String.format(&quot;%.0f&quot;, doubleKhoangCach) +&quot;m&quot;);
        }
        else {
            holder.textKhoangCach.setText((doubleKhoangCach/1000) +&quot;km&quot;);
        }

        holder.btnVideo.setOnClickListener(new View.OnClickListener() {
<A NAME="519"></A>            @Override
            public void onClick(View v) {
                String strMaTinh = FragmentDiaDiemGan_View.strMaTinh;
                Integer intMaDiaDiem = <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#519',3,'match0-top.html#519',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Integer.valueOf(FragmentDiaDiemGan_View.strMaDiaDiem);
                String strTenDiaDiem = FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrTenDiaDiem();
                String strYoutube = FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrYoutube();
                String strDiaChi = FragmentDiaDiemGan_View</B></FONT>.arrayListDiaDiemGan.get(position).getStrTenXa() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).strTenTinh;
                if (strYoutube.equals(&quot;&quot;)){
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật video&quot;);
                    return;
                }
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, YoutubeFragment.newInstance(intMaDiaDiem, strTenDiaDiem, strMaTinh, strYoutube, strDiaChi, 3));
                FragmentDiaDiemGan_View.fragmentTransaction.commit();
            }
        });

        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
<A NAME="520"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#520',3,'match0-top.html#520',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnCtyDuLich.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
<A NAME="521"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentCtyDuLich_Home fragment = new FragmentCtyDuLich_Home();
                Bundle <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#521',3,'match0-top.html#521',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnNhaHang.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
<A NAME="522"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentNhaHang_View fragment = new FragmentNhaHang_View();
                Bundle <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#522',3,'match0-top.html#522',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnKhachSan.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="523"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentKhachSan_View fragment = new FragmentKhachSan_View();
                Bundle <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#523',3,'match0-top.html#523',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnDiaDiemGan.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="524"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentDiaDiemGan_View fragment = new FragmentDiaDiemGan_View();
                Bundle <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#524',3,'match0-top.html#524',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnThoiTiet.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="525"></A>            public void onClick(View v) {
                FragmentDiaDiemGan_View.fragmentTransaction = FragmentDiaDiemGan_View.fragmentManager.beginTransaction();
                FragmentThoiTiet fragment = new FragmentThoiTiet();
                Bundle <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#525',3,'match0-top.html#525',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiemGan_View.strMaTinh);
                fragment.setArguments(bundle);
                FragmentDiaDiemGan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiemGan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLike.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strMaDiaDiem = FragmentDiaDiemGan_View.arrayListDiaDiemGan.get(position).getStrMaDiaDiem();
                    String sqlThich = &quot;update TB_DiaDiem set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaDiaDiem = '&quot;+ strMaDiaDiem +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
<A NAME="526"></A>            }
        });

        <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#526',3,'match0-top.html#526',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDiaDiemGan_View.arrayListDiaDiemGan.clear();
        if (charText.length() == 0) {
            FragmentDiaDiemGan_View.arrayListDiaDiemGan.addAll(arraylist);
        } else {
            for (ClassDiaDiemGan_View wp : arraylist) {
                if (wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDiaDiemGan_View</B></FONT>.arrayListDiaDiemGan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ListViewDiaDiem_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="527"></A>package com.example.travelling.DiaDiem;

<FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#527',3,'match0-top.html#527',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Context;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDiaDiem_Edit extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassDiaDiem_Edit&gt; arraylist;
    ClassPublic classPublic;

    public ListViewDiaDiem_Edit(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDiaDiem_Edit.arrayListDiaDiem);
    }

    public static class ViewHolder {
        TextView textTenDiaDiem, textDiaChi, textLuotThich;
        ImageView imageDiaDiem;
    }
    @Override
    public int getCount() {
        return FragmentDiaDiem_Edit.arrayListDiaDiem.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDiaDiem_Edit.arrayListDiaDiem.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewDiaDiem_Edit.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewDiaDiem_Edit.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_diadiem_edit, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textTenDiaDiem = convertView.findViewById(R.id.textTenDiaDiem);
            holder.imageDiaDiem = convertView.findViewById(R.id.imageDiaDiem);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            convertView.setTag(holder);
        } else {
            holder = (ListViewDiaDiem_Edit.ViewHolder) convertView.getTag();
        }</B></FONT>

        holder.textTenDiaDiem.setText((position + 1) + &quot;. &quot; + FragmentDiaDiem_Edit.arrayListDiaDiem.get(position).getStrTenDiaDiem().toUpperCase());
        String strAnh = FragmentDiaDiem_Edit.arrayListDiaDiem.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
<A NAME="528"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#528',3,'match0-top.html#528',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDiaDiem); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imageDiaDiem.setImageResource(R.drawable.no_image);
<A NAME="529"></A>        }

        String strDiaChi = FragmentDiaDiem_Edit</B></FONT>.arrayListDiaDiem.get(position).getStrTenXa();
        <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#529',3,'match0-top.html#529',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strDiaChi = strDiaChi.concat(&quot; - &quot; + FragmentDiaDiem_Edit.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + FragmentDiaDiem_Edit.arrayListDiaDiem.get(position).getStrTenTinh());
        holder.textDiaChi.setText(strDiaChi);
        holder.textLuotThich.setText(FragmentDiaDiem_Edit.arrayListDiaDiem.get(position).getIntLuotThich()+&quot; lượt thích&quot;);
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDiaDiem_Edit.arrayListDiaDiem.clear();
        if (charText.length() == 0) {
            FragmentDiaDiem_Edit.arrayListDiaDiem.addAll(arraylist);
        } else {
            for (ClassDiaDiem_Edit wp : arraylist) {
                if (wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDiaDiem_Edit.arrayListDiaDiem.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\ListViewDiaDiem_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
<A NAME="530"></A>import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
<FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#530',3,'match0-top.html#530',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLDiaDiemFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_Home;
import com.example.travelling.KhachSan.FragmentKhachSan_View;
import com.example.travelling.NhaHang.FragmentNhaHang_View;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDiaDiem_View extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassDiaDiem_View&gt; arraylist;
    ClassConnect classConnect;
    ClassPublic classPublic;

    public ListViewDiaDiem_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDiaDiem_View.arrayListDiaDiem);
    }
<A NAME="531"></A>    public static class ViewHolder {
        TextView textTenDiaDiem, textDiaChi, textLuotThich, textBinhLuan;
        ImageView imageDiaDiem</B></FONT>;
        ImageButton btnVideo, <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#531',3,'match0-top.html#531',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>btnChiDuong, btnCtyDuLich, btnNhaHang, btnKhachSan, btnDiaDiemGan, btnThoiTiet, btnLike, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentDiaDiem_View.arrayListDiaDiem.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDiaDiem_View.arrayListDiaDiem.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewDiaDiem_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewDiaDiem_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_diadiem_view, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.textTenDiaDiem = convertView.findViewById(R.id.textTenDiaDiem);
            holder.imageDiaDiem = convertView.findViewById(R.id.imageDiaDiem);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
<A NAME="532"></A>            holder.btnVideo = convertView.findViewById(R.id.btnVideo);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnCtyDuLich = convertView</B></FONT>.findViewById(R.id.btnCtyDuLich);
            <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#532',3,'match0-top.html#532',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.btnNhaHang = convertView.findViewById(R.id.btnNhaHang);
            holder.btnKhachSan = convertView.findViewById(R.id.btnKhachSan);
            holder.btnDiaDiemGan = convertView.findViewById(R.id.btnDiaDiemGan);
            holder.btnThoiTiet = convertView.findViewById(R.id.btnThoiTiet);
            holder.btnLike = convertView.findViewById(R.id.btnLike);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ListViewDiaDiem_View.ViewHolder) convertView.getTag();
        }</B></FONT>

        holder.textTenDiaDiem.setText((position + 1) + &quot;. &quot; + FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenDiaDiem().toUpperCase());
        String strAnh = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
<A NAME="533"></A>            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#533',3,'match0-top.html#533',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageDiaDiem); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imageDiaDiem.setImageResource(R.drawable.no_image);
        }

        String strDiaChi = FragmentDiaDiem_View</B></FONT>.arrayListDiaDiem.get(position).getStrTenXa();
        strDiaChi = strDiaChi.concat(&quot; - &quot; + FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenTinh());
        holder.textDiaChi.setText(strDiaChi);
        final Integer[] intThich = {FragmentDiaDiem_View.arrayListDiaDiem.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentDiaDiem_View.arrayListDiaDiem.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="534"></A>        holder.btnVideo.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String strMaTinh = <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#534',3,'match0-top.html#534',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh();
                String strTenDiaDiem = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenDiaDiem();
                String strYoutube = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrYoutube();
                String strDiaChi = FragmentDiaDiem_View</B></FONT>.arrayListDiaDiem.get(position).getStrTenXa() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).getStrTenHuyen() + &quot; - &quot; + DiaDiemYeuThichFragment.arrayListDiaDiem.get(position).strTenTinh;
                if (strYoutube.equals(&quot;&quot;)){
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật video&quot;);
                    return;
                }
                FragmentDiaDiem_View.fragmentTransaction = DiaDiemYeuThichFragment.fragmentManager.beginTransaction();
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, YoutubeFragment.newInstance(0,strTenDiaDiem, strMaTinh, strYoutube, strDiaChi, 2));
                FragmentDiaDiem_View.fragmentTransaction.commit();
            }
        });

<A NAME="535"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#535',3,'match0-top.html#535',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;TaiKhoan&quot;, &quot;&quot;);
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                bundle.putInt(&quot;DieuKien&quot;, 2);
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

<A NAME="536"></A>        holder.btnCtyDuLich.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#536',3,'match0-top.html#536',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentCtyDuLich_Home fragment = new FragmentCtyDuLich_Home();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

<A NAME="537"></A>        holder.btnNhaHang.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#537',3,'match0-top.html#537',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentNhaHang_View fragment = new FragmentNhaHang_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnKhachSan.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="538"></A>            public void onClick(View v) {
                FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentKhachSan_View fragment = new FragmentKhachSan_View();
                Bundle <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#538',3,'match0-top.html#538',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnDiaDiemGan.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="539"></A>            public void onClick(View v) {
                FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentDiaDiemGan_View fragment = new FragmentDiaDiemGan_View();
                Bundle <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#539',3,'match0-top.html#539',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnThoiTiet.setOnClickListener(new View.OnClickListener() {
            @Override
<A NAME="540"></A>            public void onClick(View v) {
                FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentThoiTiet fragment = new FragmentThoiTiet();
                Bundle <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#540',3,'match0-top.html#540',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem());
                bundle.putString(&quot;MaTinh&quot;, FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaTinh());
                fragment.setArguments(bundle);
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLike.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strMaDiaDiem = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem();
                    String sqlThich = &quot;update TB_DiaDiem set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaDiaDiem = '&quot;+ strMaDiaDiem +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="541"></A>                String strMaTinh = FragmentDiaDiem_View.strMaTinh;
                String strMaDiaDiem = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrMaDiaDiem();
                String strTenDiaDiem = FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenDiaDiem();
                String strDiaChi = <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#541',3,'match0-top.html#541',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenXa();
                strDiaChi = strDiaChi.concat(&quot; - &quot;+FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenHuyen()+&quot; - &quot;+FragmentDiaDiem_View.arrayListDiaDiem.get(position).getStrTenTinh());
                FragmentDiaDiem_View.fragmentTransaction = FragmentDiaDiem_View.fragmentManager.beginTransaction();
                FragmentDiaDiem_View.fragmentTransaction.replace(R.id.fragment_main, BLDiaDiemFragment.newInstance(strMaTinh, strTenDiaDiem, strDiaChi, Integer.parseInt(strMaDiaDiem)));
                FragmentDiaDiem_View</B></FONT>.fragmentTransaction.commit();
<A NAME="542"></A>            }
        });

        <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#542',3,'match0-top.html#542',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDiaDiem_View.arrayListDiaDiem.clear();
        if (charText.length() == 0) {
            FragmentDiaDiem_View.arrayListDiaDiem.addAll(arraylist);
        } else {
            for (ClassDiaDiem_View wp : arraylist) {
                if (wp.getStrTenDiaDiem().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDiaDiem_View</B></FONT>.arrayListDiaDiem.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>DiaDiem\ListViewThoiTiet.java</CENTER></H3><HR>
<PRE>
<A NAME="543"></A><FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#543',3,'match0-top.html#543',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.R;
import com.squareup.picasso.Picasso;

import java.util.ArrayList;

public class ListViewThoiTiet extends BaseAdapter {
    private Context mContext;
    private LayoutInflater inflater;
    private ArrayList&lt;ClassThoiTiet&gt; arraylist;
    public ListViewThoiTiet(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentThoiTiet.arrayListThoiTiet);
    }
    public static class ViewHolder {
        TextView textNgay, textTrangThai, textNhietDo, textTocDoGio, textDoAm;
        ImageView imageTrangThai;
    }
    @Override
    public int getCount() {
        return FragmentThoiTiet.arrayListThoiTiet.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentThoiTiet.arrayListThoiTiet.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewThoiTiet.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewThoiTiet.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_thoitiet, null);
            holder.textNgay = convertView.findViewById(R.id.textNgay);
            holder.imageTrangThai = convertView.findViewById(R.id.imageTrangThai);
            holder.textTrangThai = convertView.findViewById(R.id.textTrangThai);
            holder.textNhietDo = convertView.findViewById(R.id.textNhietDo);
            holder.textTocDoGio = convertView.findViewById(R.id.textTocDoGio);
            holder.textDoAm = convertView.findViewById(R.id.textDoAm);
            convertView.setTag(holder);
        } else {
            holder = (ListViewThoiTiet.ViewHolder) convertView.getTag();
        }
        holder.textNgay.setText(FragmentThoiTiet.arrayListThoiTiet.get(position).getStrNgay());
        Picasso.get().load(&quot;http://openweathermap.org/img/w/&quot; + FragmentThoiTiet.arrayListThoiTiet.get(position).getStrImage() +&quot;.png&quot;).into(holder.imageTrangThai);
        holder.textTrangThai.setText(FragmentThoiTiet.arrayListThoiTiet.get(position).getStrStatus().toUpperCase());
        holder.textNhietDo.setText(FragmentThoiTiet.arrayListThoiTiet.get(position).getStrNhietDo());
        holder.textTocDoGio.setText(FragmentThoiTiet.arrayListThoiTiet.get(position).getStrTocDoGio());
        holder.textDoAm.setText(FragmentThoiTiet.arrayListThoiTiet.get(position).getStrDoAm());
        return convertView;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>DiaDiem\YoutubeFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="544"></A><FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#544',3,'match0-top.html#544',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.DiaDiem;

import android.annotation.SuppressLint;
import android.os.Bundle;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;
import android.widget.ImageButton;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Class.MyWebViewClient;
import com.example.travelling.R;
import java.util.Objects;

public class YoutubeFragment extends Fragment {

    private static final String ARG_MaDiaDiem</B></FONT> = &quot;MaDiaDiem&quot;;
    private static final String ARG_TenDiaDiem = &quot;TenDiaDiem&quot;;
    private static final String ARG_MaTinh = &quot;MaTinh&quot;;
<A NAME="545"></A>    private static final String ARG_Youtube = &quot;Youtube&quot;;
    private static final String ARG_DiaChi = &quot;DiaChi&quot;;
    private static final String ARG_DieuKien = &quot;DieuKien&quot;;
    private Integer <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#545',3,'match0-top.html#545',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mMaDiaDiem, mDieuKien;
    private String mTenDiaDiem, mMaTinh, mYoutube, mDiaChi;
    ClassPublic classPublic = new ClassPublic();
    ClassConnect classConnect;
    FragmentManager fragmentManager</B></FONT>;
    FragmentTransaction fragmentTransaction;
    //Phần khai báo
    View view;
    ImageButton btnQuayLai;
    TextView textDiaDiem, textDiaChi;
    WebView webYoutube;

    public YoutubeFragment() {

    }
<A NAME="546"></A>
    public static YoutubeFragment newInstance(Integer maDiaDiem, String tenDiaDiem, String maTinh, String youtube, String diaChi, Integer dieuKien) {
        YoutubeFragment fragment = new YoutubeFragment();
        Bundle <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#546',3,'match0-top.html#546',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>args = new Bundle();
        args.putInt(ARG_MaDiaDiem, maDiaDiem);
        args.putString(ARG_TenDiaDiem, tenDiaDiem);
        args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_Youtube, youtube);
        args.putString(ARG_DiaChi, diaChi);
        args.putInt(ARG_DieuKien, dieuKien);
        fragment</B></FONT>.setArguments(args);
        return fragment;
    }

<A NAME="547"></A>    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (<FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#547',3,'match0-top.html#547',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments() != null) {
            mMaDiaDiem = getArguments().getInt(ARG_MaDiaDiem);
            mTenDiaDiem = getArguments().getString(ARG_TenDiaDiem);
            mMaTinh = getArguments</B></FONT>().getString(ARG_MaTinh);
            mYoutube = getArguments().getString(ARG_Youtube);
            mDiaChi = getArguments().getString(ARG_DiaChi);
            mDieuKien = getArguments().getInt(ARG_DieuKien);
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_youtube, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        layoutAnhXa();
<A NAME="548"></A>        return view;
    }

    private <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#548',3,'match0-top.html#548',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        webYoutube = view.findViewById(R.id.webYoutube);
        textDiaDiem.setText(mTenDiaDiem);
        textDiaChi</B></FONT>.setText(mDiaChi);
        String strUrl = &quot;https://www.youtube.com/watch?v=&quot; + mYoutube;
        webYoutube.setWebViewClient(new MyWebViewClient(strUrl));
        loadYoutube(mYoutube);
        clickButton();
    }
    
    @SuppressLint(&quot;SetJavaScriptEnabled&quot;)
    private void loadYoutube(String youtube) {
        String strUrl = &quot;https://www.youtube.com/watch?v=&quot; + youtube;
        if(youtube.isEmpty())  {
<A NAME="549"></A>            classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật video&quot;);
            return;
        }
        <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#549',3,'match0-top.html#549',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>webYoutube.getSettings().setLoadsImagesAutomatically(true);
        webYoutube.getSettings().setJavaScriptEnabled(true);
        webYoutube.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY);
        webYoutube.loadUrl(strUrl);
    }

    private void</B></FONT> clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (mDieuKien == 1){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else if (mDieuKien == 2){
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                else if (mDieuKien == 3){
                    FragmentDiaDiemGan_View fragment = new FragmentDiaDiemGan_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaDiaDiem&quot;, mMaDiaDiem.toString());
                    bundle.putString(&quot;MaTinh&quot;, mMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>Home\FragmentHome.java</CENTER></H3><HR>
<PRE>
<A NAME="375"></A><FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#375',3,'match0-top.html#375',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Home;

import android.annotation.SuppressLint;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ProgressBar;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.cardview.widget.CardView;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.CtyDuLich.FragmentCtyDuLich_View;
import com.example.travelling.DacSan.FragmentDacSan_View;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.KhachSan.FragmentKhachSan_Home;
import com.example.travelling.NhaHang.FragmentNhaHang_Home;
import com.example.travelling.R;
import java.util.Objects;

public class FragmentHome extends Fragment{

    //Phần khái báo
    View view;
    FragmentManager fragmentManager; //Tạo Fragment
    FragmentTransaction fragmentTransaction;
    ProgressBar progressBar;
<A NAME="376"></A>    CardView cardDiaDiemYeuThich, cardDiaDiemTheoTinh, cardCongTyDuLich, cardNhaHangQuanAn, cardNhaNghiKhachSan, cardDacSanDiaPhuong</B></FONT>;

    @SuppressLint(&quot;NewApi&quot;)
    public <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#376',3,'match0-top.html#376',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_home, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void layoutAnhXa() {
        cardDiaDiemYeuThich = view.findViewById(R.id.cardDiaDiemYeuThich);
        cardDiaDiemTheoTinh = view.findViewById(R.id.cardDiaDiemTheoTinh);
        cardCongTyDuLich = view.findViewById(R.id.cardCongTyDuLich);
        cardNhaHangQuanAn = view.findViewById(R.id.cardNhaHangQuanAn);
        cardNhaNghiKhachSan = view.findViewById(R.id.cardNhaNghiKhachSan);
        cardDacSanDiaPhuong = view</B></FONT>.findViewById(R.id.cardDacSanDiaPhuong);
        progressBar = view.findViewById(R.id.progressBar);
        clickCardView();
<A NAME="377"></A>    }

    private void clickCardView() {
        <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#377',3,'match0-top.html#377',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cardDiaDiemYeuThich.setOnClickListener(v -&gt; {
            progressBar.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
            fragmentTransaction.commit();
            progressBar.setVisibility(View.GONE);
        });

        cardDiaDiemTheoTinh.setOnClickListener(v -&gt; {
            progressBar</B></FONT>.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentDiaDiem_View());
            fragmentTransaction.commit();
<A NAME="378"></A>            progressBar.setVisibility(View.GONE);
        });

        <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#378',3,'match0-top.html#378',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cardCongTyDuLich.setOnClickListener(v -&gt; {
            progressBar.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentCtyDuLich_View());
            fragmentTransaction.commit();
            progressBar.setVisibility(View.GONE);
        });

        cardNhaHangQuanAn.setOnClickListener(v -&gt; {
            progressBar</B></FONT>.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentNhaHang_Home());
            fragmentTransaction.commit();
            progressBar.setVisibility(View.GONE);
        });

        cardNhaNghiKhachSan.setOnClickListener(v -&gt; {
            progressBar.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentKhachSan_Home());
            fragmentTransaction.commit();
            progressBar.setVisibility(View.GONE);
        });

        cardDacSanDiaPhuong.setOnClickListener(v -&gt; {
            progressBar.setVisibility(View.VISIBLE);
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentDacSan_View());
            fragmentTransaction.commit();
            progressBar.setVisibility(View.GONE);
        });

    }
}
</PRE>
<HR>
<H3><CENTER>Home\MainHomeActivity.java</CENTER></H3><HR>
<PRE>
<A NAME="379"></A><FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#379',3,'match0-top.html#379',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Home;

import androidx.appcompat.app.ActionBar;
import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import android.annotation.SuppressLint;
import android.content.Intent;
import android.graphics.Color;
import android.graphics.drawable.ColorDrawable;
import android.os.Bundle;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.Menu.FragmentListMenu;
import com.example.travelling.NguoiDung.FragmentTaiKhoan;
import com.example.travelling.R;
import com.google.android.material.bottomnavigation.BottomNavigationView;

public class MainHomeActivity extends AppCompatActivity {

    //Phần khai báo
    FragmentManager fragmentManager; //Fragment trang chủ
    FragmentTransaction fragmentTransaction;
    BottomNavigationView bottomMenu</B></FONT>;
    String strMaTinh;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_home);

        ActionBar actionBar = getSupportActionBar();
        if (actionBar != null) {
            actionBar.setTitle(&quot;Travelling&quot;); //Ẩn tiêu đề app
            actionBar.setBackgroundDrawable(new ColorDrawable(Color.parseColor(&quot;#FF3700B3&quot;))); //Đổi màu nền thanh menu
        }
        fragmentManager = getSupportFragmentManager();
        fragmentTransaction = fragmentManager.beginTransaction();
        layoutAnhXa();
<A NAME="380"></A>    }

    private void layoutAnhXa() {
        bottomMenu = <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#380',3,'match0-top.html#380',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>findViewById(R.id.bottomMenu);
        quayLaiYoutube();
        clickBottonMenu();
    }

    private void quayLaiYoutube() { //Xử lý nút quay lại từ YoutubeActivity
        Intent intent = getIntent</B></FONT>();
        if (intent != null){
            strMaTinh = intent.getStringExtra(&quot;MaTinh&quot;);
            if (strMaTinh.equals(&quot;&quot;)){
                fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
            }
            else{
                FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                fragment.setArguments(bundle);
                fragmentTransaction.replace(R.id.fragment_main, fragment);
            }
        }
<A NAME="381"></A>        else {
            fragmentTransaction.add(R.id.fragment_main, new FragmentHome());
        }
        <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#381',3,'match0-top.html#381',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentTransaction.commit();
    }

    @SuppressLint(&quot;NonConstantResourceId&quot;)
    private void clickBottonMenu() {
        bottomMenu.setOnNavigationItemSelectedListener(item -&gt; {
            switch (item.getItemId()){
                case R.id.itemHome:
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new FragmentHome());
                    fragmentTransaction.commit();
                    return true;
                case R.id.itemTaiKhoan:
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new FragmentTaiKhoan());
                    fragmentTransaction.commit();
                    return true;
                case R.id.itemMenu:
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new FragmentListMenu());
                    fragmentTransaction.commit();
                    return true;
            }
            return false;
        });
    }

    @Override
    public void onBackPressed() { //Khi nào đăng xuất mới được trở về trang MainActivity

    }
}</B></FONT>

</PRE>
<HR>
<H3><CENTER>KhachSan\ClassKhachSan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="290"></A><FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#290',3,'match0-top.html#290',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

public class ClassKhachSan_Edit {

    Integer intMaPhong, intGiaPhong;
    String strTenPhong;

    public ClassKhachSan_Edit(Integer intMaPhong, String strTenPhong, Integer intGiaPhong){
        this.intMaPhong = intMaPhong;
        this.strTenPhong = strTenPhong;
        this.intGiaPhong = intGiaPhong;
    }

    public Integer getIntMaPhong() {
        return intMaPhong;
    }

    public String getStrTenPhong() {
        return strTenPhong;
    }

    public Integer getIntGiaPhong() {
        return intGiaPhong;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhachSan\ClassKhachSan_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="291"></A><FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#291',3,'match0-top.html#291',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

public class ClassKhachSan_Home {

    //Phần khia báo
    Integer intBinhLuan, intLuotThich;
    String strTaiKhoan, strMaTinh, strTenKhachSan, strSoDienThoai, strDiaChi, strAnh</B></FONT>;
<A NAME="292"></A>
    public ClassKhachSan_Home(String strTaiKhoan, String strMaTinh, String strTenKhachSan, String strSoDienThoai,
                             String strDiaChi, Integer intBinhLuan, Integer intLuotThich, String strAnh){
        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#292',3,'match0-top.html#292',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strTaiKhoan = strTaiKhoan;
        this.strMaTinh = strMaTinh;
        this.strTenKhachSan = strTenKhachSan;
        this.strSoDienThoai = strSoDienThoai;
        this.strDiaChi = strDiaChi;
        this.intBinhLuan = intBinhLuan;
        this.intLuotThich = intLuotThich;
        this.strAnh = strAnh;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenKhachSan() {
        return strTenKhachSan;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public String getStrAnh() {
        return strAnh;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>KhachSan\ClassKhachSan_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KhachSan;

public class ClassKhachSan_View {

    Integer intBinhLuan, intLuotThich;
    Double doubleKhoangCach;
    String strTaiKhoan, strTenKhachSan, strSoDienThoai, strDiaChi, strAnh;
<A NAME="293"></A>
    public ClassKhachSan_View(String strTaiKhoan, String strTenKhachSan, Double doubleKhoangCach, String strSoDienThoai,
                              String strDiaChi, Integer intBinhLuan, Integer intLuotThich, String strAnh){
        <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#293',3,'match0-top.html#293',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strTaiKhoan = strTaiKhoan;
        this.strTenKhachSan = strTenKhachSan;
        this.doubleKhoangCach = doubleKhoangCach;
        this.strSoDienThoai = strSoDienThoai;
        this.strDiaChi = strDiaChi;
        this.intBinhLuan = intBinhLuan;
        this.intLuotThich = intLuotThich;
        this.strAnh = strAnh;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrTenKhachSan() {
        return strTenKhachSan;
    }

    public Double getDoubleKhoangCach() {
        return doubleKhoangCach;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public String getStrAnh() {
        return strAnh;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>KhachSan\ClassPhong_View.java</CENTER></H3><HR>
<PRE>
<A NAME="294"></A><FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#294',3,'match0-top.html#294',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

public class ClassPhong_View {

    Integer intMaPhong, intGiaPhong, intLuotThich, intBinhLuan;
    String strTenPhong, strAnh, strTaiKhoan;

    public ClassPhong_View(Integer intMaPhong, String strAnh, String strTenPhong, Integer intGiaPhong, Integer intLuotThich,
                           Integer intBinhLuan, String strTaiKhoan){
        this.intMaPhong = intMaPhong;
        this.strAnh = strAnh;
        this.strTenPhong = strTenPhong;
        this.intGiaPhong = intGiaPhong;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
        this.strTaiKhoan = strTaiKhoan;
    }

    public Integer getIntMaPhong() {
        return intMaPhong;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrTenPhong() {
        return strTenPhong;
    }

    public Integer getIntGiaPhong() {
        return intGiaPhong;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhachSan\FragmentKhachSan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="295"></A>package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
<FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#295',3,'match0-top.html#295',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Menu.FragmentListMenu;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;
import static java.util.Objects.requireNonNull;

public class FragmentKhachSan_Edit extends Fragment implements SearchView.OnQueryTextListener {

    //Khai báo
<A NAME="296"></A>    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    SharedPreferences <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#296',3,'match0-top.html#296',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;
    FragmentManager fragmentManager; //Tạo Fragment
    FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ImageButton btnThemMoi, btnQuayLai;
    ListView listView;
<A NAME="297"></A>    public static ArrayList&lt;ClassKhachSan_Edit&gt; arrayListKhachSan;
    ListViewKhachSan_Edit adapterKhachSan</B></FONT>;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    String <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#297',3,'match0-top.html#297',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strTaiKhoan, strHienThi;
    //Khai báo các đối tượng trên dialog
    TextView textTieuDe;
    EditText editMaPhong, editTenPhong, editGiaPhong;
    Button btnLuuLai, btnXoa, btnDong;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater</B></FONT>.inflate(R.layout.fragment_khachsan_edit, container, false);
<A NAME="298"></A>        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(<FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#298',3,'match0-top.html#298',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()).getSupportFragmentManager();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }
<A NAME="299"></A>
    private void layoutAnhXa() {
        cmdHienThi = view</B></FONT>.findViewById(R.id.cmdHienThi);
        <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#299',3,'match0-top.html#299',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>searchView = view.findViewById(R.id.searchTen);
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        listView = view.findViewById(R.id.listView);
        loadHienThi();
        clickButton();
        clickListView();
    }

    private void loadHienThi() {
        listHienThi</B></FONT>.clear();
<A NAME="300"></A>        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#300',3,'match0-top.html#300',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="301"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#301',3,'match0-top.html#301',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachPhong(strTaiKhoan, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachPhong(String taiKhoan, String hienThi) {
        arrayListKhachSan = new ArrayList&lt;&gt;();
        arrayListKhachSan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlKhachSan;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlKhachSan = &quot;select * from TB_Phong where TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
<A NAME="302"></A>            else {
                sqlKhachSan = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; * from TB_Phong where TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
            ResultSet <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#302',3,'match0-top.html#302',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetKhachSan = classConnect.selectData(getActivity(), sqlKhachSan);
            if (resultSetKhachSan != null){
                while (resultSetKhachSan.next()){
                    arrayListKhachSan.add(new ClassKhachSan_Edit(Integer.parseInt(resultSetKhachSan.getString(&quot;MaPhong&quot;)),
                            resultSetKhachSan.getString(&quot;TenPhong&quot;), Integer.parseInt(resultSetKhachSan.getString(&quot;GiaPhong&quot;))));
                }
            }
            if (arrayListKhachSan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách phòng&quot;);
            }
<A NAME="303"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#303',3,'match0-top.html#303',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterKhachSan = new ListViewKhachSan_Edit(getContext());
        listView.setAdapter(adapterKhachSan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterKhachSan.filter(newText);
        return false;
    }

    private void clickButton() {
        btnThemMoi</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                updatePhong(-1);
            }
        });

        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentListMenu());
                fragmentTransaction.commit();
            }
        });
    }

    private void clickListView() {
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
<A NAME="304"></A>            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updatePhong(position);
            <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#304',3,'match0-top.html#304',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        });
    }

    private void updatePhong(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_khachsan, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaPhong = alertLayout.findViewById(R.id.editMaPhong);
        editTenPhong = alertLayout.findViewById(R.id.editTenPhong);
        editGiaPhong = alertLayout.findViewById(R.id.editGiaPhong);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
<A NAME="305"></A>        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity</B></FONT>());
        <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#305',3,'match0-top.html#305',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
<A NAME="306"></A>        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI TÊN PHÒNG&quot;</B></FONT>;
            <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#306',3,'match0-top.html#306',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT TÊN PHÒNG&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaPhong.setText(String.valueOf(arrayListKhachSan.get(intChiSo).getIntMaPhong())); //Gán giá trị mã phòng
            editTenPhong.setText(arrayListKhachSan.get(intChiSo).getStrTenPhong()); //Gán giá trị tên phòng
            editGiaPhong.setText(String.valueOf(arrayListKhachSan</B></FONT>.get(intChiSo).getIntGiaPhong())); //Gán giá trị giá phòng
        }
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
<A NAME="307"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#307',3,'match0-top.html#307',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    if (editTenPhong.getText().length() != 0){
                        if (editGiaPhong.getText().length() != 0){
                            String sqlMonAn;
                            if (intChiSo == -1){ //Thêm mới
                                sqlMonAn = &quot;insert into TB_Phong(TaiKhoan, TenPhong, GiaPhong) &quot; +
<A NAME="308"></A>                                        &quot;values ('&quot;+ strTaiKhoan +&quot;', N'&quot;+ editTenPhong.getText() +&quot;', '&quot;+ Integer.parseInt(editGiaPhong.getText().toString()) +&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlMonAn</B></FONT> = &quot;update TB_Phong set TenPhong = N'&quot;+ editTenPhong.getText() +&quot;', GiaPhong = '&quot;+ Integer.parseInt(<FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#308',3,'match0-top.html#308',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editGiaPhong.getText().toString())+&quot;' &quot; +
                                        &quot;where MaPhong = '&quot;+ Integer.parseInt(editMaPhong.getText().toString()) +&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlMonAn) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên phòng thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên phòng thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachPhong(strTaiKhoan, strHienThi); //Load lại danh sách
                            }
<A NAME="309"></A>                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }</B></FONT>
                            <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#309',3,'match0-top.html#309',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập giá phòng&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên phòng&quot;);
                    }</B></FONT>
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="310"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#310',3,'match0-top.html#310',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaPhong.getText().length() != 0) {
                    dialogXoa(editMaPhong.getText().toString(), editTenPhong.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã phòng để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="311"></A>                dialog.cancel();
            }
        });
        <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#311',3,'match0-top.html#311',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách tỉnh
    }

    private void dialogXoa(final String maPhong, final String tenPhong){
        //Hiện hộp thoại thông báo xóa tên phòng
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN PHÒNG&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa tên phòng: &quot; + tenPhong.toUpperCase() +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="312"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#312',3,'match0-top.html#312',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlTourDuLich = &quot;delete TB_Phong where MaPhong = '&quot;+ maPhong +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlTourDuLich) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên phòng thành công&quot;);
                        loadDanhSachPhong(strTaiKhoan, strHienThi); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên phòng&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }
}
</PRE>
<HR>
<H3><CENTER>KhachSan\FragmentKhachSan_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="313"></A><FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#313',3,'match0-top.html#313',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentKhachSan_Home extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="314"></A>    ListView listView;
    public static ArrayList&lt;ClassKhachSan_Home&gt; arrayListKhachSan;
    ListViewKhachSan_Home adapterKhachSan;
    ArrayList&lt;<FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#314',3,'match0-top.html#314',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    public static String strMaTinh, ganMaTinh, strHienThi, mMaTinh;
    int intDieuKien</B></FONT> = 0;
<A NAME="315"></A>    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;

    <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#315',3,'match0-top.html#315',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_khachsan_home, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        sharedpreferences = Objects.requireNonNull(this</B></FONT>.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            ganMaTinh = bundle.getString(&quot;MaTinh&quot;); ////Lấy mã tỉnh được gửi qua từ FragmentNhaHang_View
        }
        else {
            ganMaTinh = &quot;&quot;;
        }
        mMaTinh = classPublic.layMaTinh(sharedpreferences.getString(User,&quot;&quot;), getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="316"></A>        return view;
    }

    private <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#316',3,'match0-top.html#316',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
<A NAME="317"></A>        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view</B></FONT>.findViewById(R.id.listView);
        <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#317',3,'match0-top.html#317',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadTinh(); //Load tên tỉnh
        loadHienThi();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="318"></A>                cmdTinh.setAdapter(dataTinh);
            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(<FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#318',3,'match0-top.html#318',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (ganMaTinh.equals(&quot;&quot;) &amp;&amp; intDieuKien == 0){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        intDieuKien = 1;
                    }
                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(ganMaTinh));
                        ganMaTinh = &quot;&quot;;
                    }
<A NAME="319"></A>                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachKhachSan(strMaTinh, strHienThi);
                }
            <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#319',3,'match0-top.html#319',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
<A NAME="320"></A>        listHienThi.add(&quot;40&quot;);
        listHienThi</B></FONT>.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="321"></A>        <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#320',3,'match0-top.html#320',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects</B></FONT>.requireNonNull(<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#321',3,'match0-top.html#321',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachKhachSan(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachKhachSan(String maTinh, String hienThi) {
        arrayListKhachSan = new ArrayList&lt;&gt;();
        arrayListKhachSan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlKhachSan;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlKhachSan = &quot;select TenXa, TenHuyen, TenTinh, TaiKhoan, t.MaTinh, CongTy, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 5 order by nd.LuotThich desc&quot;;
            }
            else {
                sqlKhachSan = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, TaiKhoan, t.MaTinh, CongTy, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 5 order by nd.LuotThich desc&quot;;
            }
            ResultSet resultSetKhachSan = classConnect.selectData(getActivity(), sqlKhachSan);
            if (resultSetKhachSan != null){
                while (resultSetKhachSan.next()){
                    String strDiaChi = resultSetKhachSan.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetKhachSan.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetKhachSan.getString(&quot;TenTinh&quot;));
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetKhachSan.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="322"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#322',3,'match0-top.html#322',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListKhachSan.add(new ClassKhachSan_Home(resultSetKhachSan.getString(&quot;TaiKhoan&quot;), resultSetKhachSan.getString(&quot;MaTinh&quot;),
                            resultSetKhachSan.getString(&quot;CongTy&quot;), resultSetKhachSan.getString(&quot;SoDienThoai&quot;),
                            strDiaChi, intBinhLuan, Integer.parseInt(resultSetKhachSan.getString(&quot;LuotThich&quot;)), resultSetKhachSan.getString(&quot;Anh&quot;)));
                }
            }
            if (arrayListKhachSan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách khách sạn&quot;);
<A NAME="323"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(<FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#323',3,'match0-top.html#323',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e.getMessage()));
        }
        adapterKhachSan = new ListViewKhachSan_Home(getContext());
        listView.setAdapter(adapterKhachSan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterKhachSan.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhachSan\FragmentKhachSan_View.java</CENTER></H3><HR>
<PRE>
<A NAME="324"></A><FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#324',3,'match0-top.html#324',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentKhachSan_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
<A NAME="325"></A>    View view;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic</B></FONT>();
    public static FragmentManager <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#325',3,'match0-top.html#325',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
    TextView textDiaDiem;
    public static String strMaDiaDiem, strMaTinh;
<A NAME="326"></A>    ImageButton btnQuayLai</B></FONT>;
    public static ArrayList&lt;ClassKhachSan_View&gt; arrayListKhachSan;
    ListViewKhachSan_View adapterKhachSan;
    ArrayList&lt;String&gt; listHienThi = new <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#326',3,'match0-top.html#326',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ArrayList&lt;&gt;();

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="327"></A>    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_khachsan_view, container, false);
        fragmentManager = Objects</B></FONT>.requireNonNull(<FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#327',3,'match0-top.html#327',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;); //Lấy mã địa điểm được gửi qua từ FragmentDiaDiem_View
<A NAME="328"></A>            strMaTinh = bundle</B></FONT>.getString(&quot;MaTinh&quot;); ////Lấy mã tỉnh được gửi qua từ FragmentDiaDiem_View
        }
        else {
            startActivity(new Intent(<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#328',3,'match0-top.html#328',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa();
        return view;
    }

    private void layoutAnhXa() {
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
<A NAME="329"></A>        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView</B></FONT> = view.findViewById(R.id.listView);
        btnQuayLai = <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#329',3,'match0-top.html#329',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>view.findViewById(R.id.btnQuayLai);
        layTenDiaDiem(strMaDiaDiem);
        loadHienThi();
        clickButton();
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
<A NAME="330"></A>        listHienThi</B></FONT>.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#330',3,'match0-top.html#330',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
<A NAME="331"></A>        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#331',3,'match0-top.html#331',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi</B></FONT>.isEmpty()) {
                    loadDanhSachKhachSan(strMaDiaDiem, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
<A NAME="332"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void layTenDiaDiem(String maDiaDiem) {
        <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#332',3,'match0-top.html#332',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select TenDiaDiem from TB_DiaDiem where MaDiaDiem = '&quot; + maDiaDiem + &quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()){
                textDiaDiem.setText(resultSetDiaDiem</B></FONT>.getString(&quot;TenDiaDiem&quot;).toUpperCase());
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (strMaTinh.equals(&quot;&quot;)){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else {
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachKhachSan(String maDiaDiem, String hienThi) {
        arrayListKhachSan = new ArrayList&lt;&gt;();
        arrayListKhachSan.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlKhachSan;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlKhachSan = &quot;select TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, KhoangCach, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_KinhDoanhGan kdg, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = kdg.TaiKhoan &quot; +
                        &quot;and nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and kdg.MaDiaDiem = '&quot; + maDiaDiem + &quot;' and LoaiTaiKhoan = 5 order by KhoangCach asc&quot;;
            }
            else {
                sqlKhachSan = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, KhoangCach, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_KinhDoanhGan kdg, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = kdg.TaiKhoan &quot; +
                        &quot;and nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and kdg.MaDiaDiem = '&quot; + maDiaDiem + &quot;' and LoaiTaiKhoan = 5 order by KhoangCach asc&quot;;
            }
            ResultSet resultSetKhachSan = classConnect.selectData(getActivity(), sqlKhachSan);
            if (resultSetKhachSan != null){
                while (resultSetKhachSan.next()){
                    String strDiaChi = resultSetKhachSan.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetKhachSan.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetKhachSan.getString(&quot;TenTinh&quot;));
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetKhachSan.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
<A NAME="333"></A>                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#333',3,'match0-top.html#333',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListKhachSan.add(new ClassKhachSan_View(resultSetKhachSan.getString(&quot;TaiKhoan&quot;), resultSetKhachSan.getString(&quot;CongTy&quot;),
                            Double.parseDouble(resultSetKhachSan.getString(&quot;KhoangCach&quot;)), resultSetKhachSan.getString(&quot;SoDienThoai&quot;),
                            strDiaChi, intBinhLuan, Integer.parseInt(resultSetKhachSan.getString(&quot;LuotThich&quot;)), resultSetKhachSan.getString(&quot;Anh&quot;)));
                }
            }
            if (arrayListKhachSan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách nhà nghỉ/khách sạn&quot;);
            }
<A NAME="334"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#334',3,'match0-top.html#334',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterKhachSan = new ListViewKhachSan_View(getContext());
        listView.setAdapter(adapterKhachSan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên nhà nghỉ/khách sạn
        adapterKhachSan.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhachSan\FragmentPhong_View.java</CENTER></H3><HR>
<PRE>
<A NAME="335"></A><FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#335',3,'match0-top.html#335',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentPhong_View extends Fragment {

    //Phần khai báo
    View view;
    ImageButton btnQuayLai, btnLienHe;
    TextView textTenKhachSan, textDiaChi;
    ListView listView;
    ClassConnect classConnect</B></FONT>;
    @SuppressLint(&quot;StaticFieldLeak&quot;)
<A NAME="336"></A>    public static ClassPublic classPublic = new ClassPublic();
    public static ArrayList&lt;ClassPhong_View&gt; arrayListPhong;
    ListViewPhong_View adapterPhong;
    public static String strTaiKhoan, strMaDiaDiem, strMaTinh, <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#336',3,'match0-top.html#336',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strSoDienThoai, strTenKhachSan;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_phong_view, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strTaiKhoan = bundle.getString(&quot;TaiKhoan&quot;); //Lấy tài khoản được gửi qua từ FragmentKhachSan_View
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;); //Lấy mã địa điểm được gửi qua từ FragmentKhachSan_View
<A NAME="337"></A>            strMaTinh = bundle.getString(&quot;MaTinh&quot;); //Lấy mã tỉnh được gửi qua từ FragmentKhachSan_View
        }
        else</B></FONT> {
            startActivity(new Intent(<FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#337',3,'match0-top.html#337',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnLienHe = view.findViewById(R.id.btnLienHe);
        textTenKhachSan = view</B></FONT>.findViewById(R.id.textTenKhachSan);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        listView = view.findViewById(R.id.listView);
        layTenKhachSan(strTaiKhoan);
        loadDanhSachPhong(strTaiKhoan);
        clickButton();
<A NAME="338"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#338',3,'match0-top.html#338',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layTenKhachSan(String taiKhoan) {
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTenKhachSan = &quot;select CongTy, TenXa, TenHuyen, TenTinh, SoDienThoai from TB_NguoiDung nd, TB_Xa x, TB_Huyen h, TB_Tinh t &quot; +
                    &quot;where nd.MaXa = x.MaXa and nd.MaHuyen = h.MaHuyen and nd.MaTinh = t.MaTinh and LoaiTaiKhoan = 5 and TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetTenKhachSan = classConnect.selectData(getActivity(), sqlTenKhachSan);
            if (resultSetTenKhachSan != null &amp;&amp; resultSetTenKhachSan.next()){
                strTenKhachSan = resultSetTenKhachSan</B></FONT>.getString(&quot;CongTy&quot;).toUpperCase();
                textTenKhachSan.setText(strTenKhachSan);
<A NAME="339"></A>                String strDiaChi = resultSetTenKhachSan.getString(&quot;TenXa&quot;);
                strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetTenKhachSan.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetTenKhachSan.getString(&quot;TenTinh&quot;));
                textDiaChi.setText(strDiaChi);
                strSoDienThoai = <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#339',3,'match0-top.html#339',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetTenKhachSan.getString(&quot;SoDienThoai&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }</B></FONT>
    }

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="340"></A>    private void loadDanhSachPhong(String taiKhoan) {
        arrayListPhong = new ArrayList&lt;&gt;();
        arrayListPhong.clear();
        <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#340',3,'match0-top.html#340',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlPhong = &quot;select MaPhong, Anh, TenPhong, GiaPhong, LuotThich from TB_Phong where TaiKhoan = '&quot;+ taiKhoan +&quot;' order by GiaPhong asc&quot;;
            ResultSet resultSetPhong = classConnect.selectData(getActivity(), sqlPhong);
            if (resultSetPhong != null){
                while (resultSetPhong.next()){
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+taiKhoan+&quot;' and MaSo = '&quot;+resultSetPhong.getInt(&quot;MaPhong&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
<A NAME="341"></A>                    }
                    arrayListPhong.add(new ClassPhong_View(resultSetPhong.getInt(&quot;MaPhong&quot;), resultSetPhong.getString(&quot;Anh&quot;), resultSetPhong.getString(&quot;TenPhong&quot;),
                            resultSetPhong.getInt(&quot;GiaPhong&quot;), resultSetPhong</B></FONT>.getInt(&quot;LuotThich&quot;), intBinhLuan, taiKhoan));
                <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#341',3,'match0-top.html#341',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            }
            if (arrayListPhong.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách phòng&quot;);
            }
<A NAME="342"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#342',3,'match0-top.html#342',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterPhong = new ListViewPhong_View(getContext());
        listView.setAdapter(adapterPhong);
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
<A NAME="343"></A>            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (<FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#343',3,'match0-top.html#343',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh.isEmpty()) {
                    FragmentKhachSan_View fragment = new FragmentKhachSan_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                else</B></FONT> {
                    FragmentKhachSan_Home fragment = new FragmentKhachSan_Home();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });

<A NAME="344"></A>        btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#344',3,'match0-top.html#344',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (strSoDienThoai.length() != 0) {
                    //Hiện hộp thoại thông báo
                    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
                    builder.setTitle(&quot;THÔNG BÁO&quot;);
                    builder.setMessage(&quot;Bạn muốn gọi cho &quot; + strTenKhachSan);
                    builder.setCancelable(false);
                    builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                        @SuppressLint(&quot;NewApi&quot;)
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            Objects.requireNonNull(getActivity()).startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + strSoDienThoai)));
                        }
                    });
                    builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            //Đóng hộp thoại thông báo
                            dialogInterface.dismiss();
                        }
                    });
                    AlertDialog alertDialog = builder.create();
                    alertDialog.show();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>KhachSan\ListViewKhachSan_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="345"></A>package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
<FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#345',3,'match0-top.html#345',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewKhachSan_Edit extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassKhachSan_Edit&gt; arraylist;

    public ListViewKhachSan_Edit(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentKhachSan_Edit.arrayListKhachSan);
    }
    public static class ViewHolder {
        TextView textTenPhong, textGiaPhong;
    }
    @Override
    public int getCount() {
        return FragmentKhachSan_Edit.arrayListKhachSan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentKhachSan_Edit.arrayListKhachSan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewKhachSan_Edit.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewKhachSan_Edit.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_khachsan_edit, null);
            holder.textTenPhong = convertView.findViewById(R.id.textTenPhong);
            holder.textGiaPhong = convertView.findViewById(R.id.textGiaPhong);
            convertView.setTag(holder);
        } else {
            holder = (ListViewKhachSan_Edit.ViewHolder) convertView.getTag();
        }
<A NAME="346"></A>
        holder.textTenPhong.setText((position + 1) + &quot;. &quot; + FragmentKhachSan_Edit</B></FONT>.arrayListKhachSan.get(position).getStrTenPhong());
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#346',3,'match0-top.html#346',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textGiaPhong.setText(&quot;Giá phòng: &quot; + formatter.format(FragmentKhachSan_Edit.arrayListKhachSan.get(position).getIntGiaPhong()) + &quot;đ&quot;);
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentKhachSan_Edit.arrayListKhachSan.clear();
        if (charText.length() == 0) {
            FragmentKhachSan_Edit.arrayListKhachSan.addAll(arraylist);
        } else {
            for (ClassKhachSan_Edit wp : arraylist) {
                if (wp.getStrTenPhong().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentKhachSan_Edit.arrayListKhachSan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhachSan\ListViewKhachSan_Home.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KhachSan;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
<A NAME="347"></A>import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
<FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#347',3,'match0-top.html#347',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.net.ConnectivityManager;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.FragmentChiDuong;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewKhachSan_Home extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassKhachSan_Home&gt; arraylist;
    ClassConnect classConnect;
    ClassPublic classPublic;

    public ListViewKhachSan_Home(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentKhachSan_Home.arrayListKhachSan);
<A NAME="348"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView textTenKhachSan, textDiaChi, <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#348',3,'match0-top.html#348',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textLuotThich, textBinhLuan;
        ImageView imageKhachSan;
        ImageButton btnDanhSach, btnLienHe, btnChiDuong, btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentKhachSan_Home.arrayListKhachSan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentKhachSan_Home.arrayListKhachSan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_khachsan_home, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.textTenKhachSan = convertView.findViewById(R.id.textTenKhachSan);
            holder.imageKhachSan = convertView.findViewById(R.id.imageKhachSan);
<A NAME="349"></A>            holder.btnDanhSach = convertView.findViewById(R.id.btnDanhSach);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnLienHe = convertView</B></FONT>.findViewById(R.id.btnLienHe);
            <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#349',3,'match0-top.html#349',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.textTenKhachSan.setText((position + 1) + &quot;. &quot; + FragmentKhachSan_Home</B></FONT>.arrayListKhachSan.get(position).getStrTenKhachSan().toUpperCase());
<A NAME="350"></A>        String strAnh = FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#350',3,'match0-top.html#350',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageKhachSan); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }</B></FONT>
        }
        else {
            holder.imageKhachSan.setImageResource(R.drawable.no_image);
        }
        holder.textDiaChi.setText(FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrDiaChi());
        final Integer[] intThich = {FragmentKhachSan_Home.arrayListKhachSan.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentKhachSan_Home.arrayListKhachSan.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="351"></A>        holder.btnDanhSach.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#351',3,'match0-top.html#351',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_Home.fragmentTransaction = FragmentKhachSan_Home.fragmentManager.beginTransaction();
                FragmentPhong_View fragment = new FragmentPhong_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;,&quot;&quot;);
                bundle.putString(&quot;MaTinh&quot;, FragmentKhachSan_Home.strMaTinh);
                bundle.putString(&quot;TaiKhoan&quot;, FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTaiKhoan());
                bundle.putInt(&quot;DieuKien&quot;, 2);
                fragment.setArguments(bundle);
                FragmentKhachSan_Home.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentKhachSan_Home</B></FONT>.fragmentTransaction.commit();
            }
        });

<A NAME="352"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#352',3,'match0-top.html#352',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_Home.arrayListKhachSan.get(position) != null) {
                    if (FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTenKhachSan());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="353"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#353',3,'match0-top.html#353',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

<A NAME="354"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#354',3,'match0-top.html#354',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_Home.fragmentTransaction = FragmentKhachSan_Home.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaGan&quot;,&quot;&quot;);
                bundle.putString(&quot;MaDiaDiem&quot;,&quot;&quot;);
                bundle.putString(&quot;MaTinh&quot;, FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrMaTinh());
                bundle.putString(&quot;TaiKhoan&quot;, FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTaiKhoan());
                bundle.putInt(&quot;DieuKien&quot;, 6);
                fragment.setArguments(bundle);
                FragmentKhachSan_Home.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentKhachSan_Home</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

<A NAME="355"></A>        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#355',3,'match0-top.html#355',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strTaiKhoan = FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTaiKhoan();
                String strTenKhachSan = FragmentKhachSan_Home.arrayListKhachSan.get(position).getStrTenKhachSan();
                String strDiaChi = FragmentKhachSan_Home</B></FONT>.arrayListKhachSan.get(position).getStrDiaChi();
                FragmentKhachSan_Home.fragmentTransaction = FragmentKhachSan_Home.fragmentManager.beginTransaction();
                FragmentKhachSan_Home.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(&quot;&quot;,&quot;&quot;, strTenKhachSan, strDiaChi, strTaiKhoan, 3));
                FragmentKhachSan_Home.fragmentTransaction.commit();
            }
        });
<A NAME="356"></A>        return convertView;
    }

    public <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#356',3,'match0-top.html#356',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentKhachSan_Home.arrayListKhachSan.clear();
        if (charText.length() == 0) {
            FragmentKhachSan_Home.arrayListKhachSan.addAll(arraylist);
        } else {
            for (ClassKhachSan_Home wp : arraylist) {
                if (wp.getStrTenKhachSan().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentKhachSan_Home.arrayListKhachSan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>KhachSan\ListViewKhachSan_View.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KhachSan;
<A NAME="357"></A>
import android.annotation.SuppressLint;
import android.app.Activity;
<FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#357',3,'match0-top.html#357',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.FragmentChiDuong;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewKhachSan_View extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassKhachSan_View&gt; arraylist;
<A NAME="358"></A>    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();

    public <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#358',3,'match0-top.html#358',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ListViewKhachSan_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="359"></A>        this.arraylist.addAll(FragmentKhachSan_View.arrayListKhachSan);
    }</B></FONT>

    public static <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#359',3,'match0-top.html#359',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class ViewHolder {
        TextView textTenKhachSan, textKhoangCach, textSoDienThoai, textDiaChi, textBinhLuan, textLuotThich;
        ImageView imageKhachSan;
        ImageButton btnDanhSach, btnLienHe, btnChiDuong, btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentKhachSan_View.arrayListKhachSan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentKhachSan_View.arrayListKhachSan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;DefaultLocale&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewKhachSan_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewKhachSan_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_khachsan_view, null);
            holder.textTenKhachSan = convertView.findViewById(R.id.textTenKhachSan);
            holder.textKhoangCach = convertView.findViewById(R.id.textKhoangCach);
            holder.textSoDienThoai = convertView.findViewById(R.id.textSoDienThoai);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.imageKhachSan = convertView.findViewById(R.id.imageKhachSan);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnDanhSach = convertView.findViewById(R.id.btnDanhSach);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnLienHe = convertView.findViewById(R.id.btnLienHe);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ListViewKhachSan_View.ViewHolder) convertView.getTag();
        }

<A NAME="360"></A>        String strAnh = FragmentKhachSan_View</B></FONT>.arrayListKhachSan.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#360',3,'match0-top.html#360',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageKhachSan); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }</B></FONT>
        }
        else {
<A NAME="361"></A>            holder.imageKhachSan.setImageResource(R.drawable.no_image);
        }

        <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#361',3,'match0-top.html#361',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTenKhachSan.setText((position + 1) + &quot;. &quot; + FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTenKhachSan().toUpperCase());
        Double doubleKhoangCach = FragmentKhachSan_View.arrayListKhachSan.get(position).getDoubleKhoangCach();
<A NAME="362"></A>        if</B></FONT> (doubleKhoangCach &lt; 1000) {
            holder.textKhoangCach.setText(&quot;Cách điểm du lịch: &quot; + String.format(&quot;%.0f&quot;, doubleKhoangCach) +&quot;m (mét)&quot;);
        }
        <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#362',3,'match0-top.html#362',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
            holder.textKhoangCach.setText(&quot;Cách điểm du lịch: &quot; + doubleKhoangCach/1000 +&quot;km (Kilômét)&quot;);
        }
        holder.textSoDienThoai.setText(&quot;Điện thoại: &quot; + FragmentKhachSan_View.arrayListKhachSan.get(position).getStrSoDienThoai());
        holder.textDiaChi.setText(FragmentKhachSan_View.arrayListKhachSan.get(position).getStrDiaChi());
        final Integer[] intThich = {</B></FONT>FragmentKhachSan_View.arrayListKhachSan.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentKhachSan_View.arrayListKhachSan.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="363"></A>        holder.btnDanhSach.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#363',3,'match0-top.html#363',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_View.fragmentTransaction = FragmentKhachSan_View.fragmentManager.beginTransaction();
                FragmentPhong_View fragment = new FragmentPhong_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentKhachSan_View.strMaDiaDiem);
                bundle.putString(&quot;MaTinh&quot;, FragmentKhachSan_View.strMaTinh);
                bundle.putString(&quot;TaiKhoan&quot;, FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTaiKhoan());
                fragment.setArguments(bundle);
                FragmentKhachSan_View</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentKhachSan_View.fragmentTransaction.commit();
            }
        });

<A NAME="364"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#364',3,'match0-top.html#364',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_View.arrayListKhachSan.get(position) != null) {
                    if (FragmentKhachSan_View.arrayListKhachSan.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTenKhachSan());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentKhachSan_View.arrayListKhachSan.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="365"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#365',3,'match0-top.html#365',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

<A NAME="366"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#366',3,'match0-top.html#366',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentKhachSan_View.fragmentTransaction = FragmentKhachSan_View.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;TaiKhoan&quot;, FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTaiKhoan());
                bundle.putString(&quot;MaDiaDiem&quot;,FragmentKhachSan_View.strMaDiaDiem);
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                bundle.putInt(&quot;DieuKien&quot;, 4);
                fragment.setArguments(bundle);
                FragmentKhachSan_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentKhachSan_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String strMaDiaDiem = FragmentKhachSan_View.strMaDiaDiem;
                String strTaiKhoan = FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTaiKhoan();
                String strTenKhachSan = FragmentKhachSan_View.arrayListKhachSan.get(position).getStrTenKhachSan();
                String strDiaChi = FragmentKhachSan_View.arrayListKhachSan.get(position).getStrDiaChi();
                FragmentKhachSan_View.fragmentTransaction = FragmentKhachSan_View.fragmentManager.beginTransaction();
                FragmentKhachSan_View.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(&quot;&quot;, strMaDiaDiem, strTenKhachSan, strDiaChi, strTaiKhoan,3));
<A NAME="367"></A>                FragmentKhachSan_View.fragmentTransaction.commit();
            }
        });
        <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#367',3,'match0-top.html#367',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentKhachSan_View.arrayListKhachSan.clear();
        if (charText.length() == 0) {
            FragmentKhachSan_View.arrayListKhachSan.addAll(arraylist);
        } else {
            for (ClassKhachSan_View wp : arraylist) {
                if (wp.getStrTenKhachSan().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentKhachSan_View</B></FONT>.arrayListKhachSan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>KhachSan\ListViewPhong_View.java</CENTER></H3><HR>
<PRE>
<A NAME="368"></A>package com.example.travelling.KhachSan;

<FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#368',3,'match0-top.html#368',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;

import com.example.travelling.BinhLuan.BLPhongFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewPhong_View extends BaseAdapter {

<A NAME="369"></A>    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassPhong_View&gt; arraylist;
    ClassConnect <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#369',3,'match0-top.html#369',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;

    public ListViewPhong_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="370"></A>        this.arraylist.addAll(FragmentPhong_View.arrayListPhong);
    }
    public static class</B></FONT> ViewHolder {
        ImageView <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#370',3,'match0-top.html#370',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>imagePhong;
        TextView textTenPhong, textGiaPhong, textLuotThich, textBinhLuan;
        ImageButton btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentPhong_View.arrayListPhong.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentPhong_View.arrayListPhong.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewPhong_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewPhong_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_phong_view, null);
            holder.imagePhong = convertView.findViewById(R.id.imagePhong);
            holder.textTenPhong = convertView.findViewById(R.id.textTenPhong);
            holder.textGiaPhong = convertView.findViewById(R.id.textGiaPhong);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnBinhLuan = convertView</B></FONT>.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
            holder = (ListViewPhong_View.ViewHolder) convertView.getTag();
<A NAME="371"></A>        }

        String strAnh = FragmentPhong_View.arrayListPhong.get(position).getStrAnh();
        if (!<FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#371',3,'match0-top.html#371',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
<A NAME="372"></A>            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager</B></FONT>.getActiveNetworkInfo().isConnected()) {
                FragmentPhong_View.classPublic = new ClassPublic();
                <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#372',3,'match0-top.html#372',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentPhong_View.classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imagePhong); //Load ảnh phòngtừ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }
        }
        else {
            holder.imagePhong.setImageResource(R.drawable.no_image);
        }

        holder.textTenPhong.setText((position + 1) + &quot;. &quot; + FragmentPhong_View</B></FONT>.arrayListPhong.get(position).getStrTenPhong());
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        holder.textGiaPhong.setText(&quot;Giá phòng: &quot; + formatter.format(FragmentPhong_View.arrayListPhong.get(position).getIntGiaPhong()) + &quot;đ&quot;);
        final Integer[] intThich = {FragmentPhong_View.arrayListPhong.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentPhong_View.arrayListPhong.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    Integer intMaPhong = FragmentPhong_View.arrayListPhong.get(position).getIntMaPhong();
                    String sqlThich = &quot;update TB_Phong set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaPhong = '&quot;+ intMaPhong +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

<A NAME="373"></A>        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#373',3,'match0-top.html#373',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh = FragmentPhong_View.strMaTinh;
                String strMaDiaDiem = FragmentPhong_View.strMaDiaDiem;
                String strTaiKhoan = FragmentPhong_View.strTaiKhoan;
                String strTenPhong = FragmentPhong_View</B></FONT>.arrayListPhong.get(position).getStrTenPhong();
                Integer intMaPhong = FragmentPhong_View.arrayListPhong.get(position).getIntMaPhong();
                FragmentPhong_View.fragmentTransaction = FragmentPhong_View.fragmentManager.beginTransaction();
                FragmentPhong_View.fragmentTransaction.replace(R.id.fragment_main, BLPhongFragment.newInstance(strMaTinh, strMaDiaDiem, strTenPhong, strTaiKhoan,intMaPhong,3));
<A NAME="374"></A>                FragmentPhong_View.fragmentTransaction.commit();
            }
        });
        <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#374',3,'match0-top.html#374',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentPhong_View.arrayListPhong.clear();
        if (charText.length() == 0) {
            FragmentPhong_View.arrayListPhong.addAll(arraylist);
        } else {
            for (ClassPhong_View wp : arraylist) {
                if (wp.getStrTenPhong().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentPhong_View</B></FONT>.arrayListPhong.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}
</PRE>
<HR>
<H3><CENTER>KhaiBao\ClassTinh.java</CENTER></H3><HR>
<PRE>
<A NAME="240"></A><FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#240',3,'match0-top.html#240',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhaiBao;

public class ClassTinh {

    String strMa, strTen;

    public ClassTinh(String strMa, String strTen){
        this.strMa = strMa;
        this.strTen = strTen;
    }

    public String getStrMa() {
        return strMa;
    }

    public String getStrTen() {
        return strTen;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhaiBao\FragmentHuyen.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KhaiBao;
<A NAME="241"></A>
import android.annotation.SuppressLint;
import android.app.AlertDialog;
<FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#241',3,'match0-top.html#241',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.DialogInterface;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentHuyen extends Fragment implements SearchView.OnQueryTextListener {

    //Phần khai báo
    View view;
    SearchView searchView;
    ImageButton btnThemMoi;
    Spinner cmdTinh;
    ListView listView;
    public static ArrayList&lt;ClassTinh&gt; arrayListHuyen;
<A NAME="242"></A>    ListViewHuyen adapterHuyen;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic</B></FONT>();
    ArrayList&lt;<FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#242',3,'match0-top.html#242',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    String strMaTinh;
    TextView textTieuDe;
    EditText editMaHuyen, editTenHuyen;
    Button btnLuuLai, btnXoa, btnDong</B></FONT>;

    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_huyen, container, false);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        loadTinh(); //Load tên tỉnh
<A NAME="243"></A>        return view;
    }

    private <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#243',3,'match0-top.html#243',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        clickListView(); //Chọn huyện trên listview
        clickButton(); //Click nút thêm mới
<A NAME="244"></A>    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#244',3,'match0-top.html#244',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadTinh(){
        //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
<A NAME="245"></A>            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#245',3,'match0-top.html#245',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
                    loadDanhSachHuyen(strMaTinh); //Load danh sách huyện
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void</B></FONT> clickListView(){
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateHuyen(position);
            }
        });
    }

    private void clickButton() {
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                updateHuyen(-1);
            }
        });
<A NAME="246"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#246',3,'match0-top.html#246',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadDanhSachHuyen(String maTinh) {
        arrayListHuyen = new ArrayList&lt;&gt;();
        arrayListHuyen.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+maTinh+&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
<A NAME="247"></A>            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    arrayListHuyen.add(new ClassTinh(resultSetHuyen.getString(&quot;MaHuyen&quot;), resultSetHuyen</B></FONT>.getString(&quot;TenHuyen&quot;)));
                <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#247',3,'match0-top.html#247',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            }
            if (arrayListHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
<A NAME="248"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log</B></FONT>.e(&quot;TAG&quot;, <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#248',3,'match0-top.html#248',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterHuyen = new ListViewHuyen(getContext());
        listView.setAdapter(adapterHuyen);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    private void updateHuyen(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_huyen, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaHuyen = alertLayout.findViewById(R.id.editMaHuyen);
        editTenHuyen = alertLayout.findViewById(R.id.editTenHuyen);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            editMaHuyen.setEnabled(true); //Cho phép nhập mã huyện
            String strTieuDe = &quot;THÊM MỚI TÊN QUẬN/HUYỆN&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            editMaHuyen.setEnabled(false); //Không cho phép nhập mã huyện
            String strTieuDe = &quot;CẬP NHẬT TÊN QUẬN/HUYỆN&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaHuyen.setText(arrayListHuyen.get(intChiSo).getStrMa()); //Gán giá trị mã huyện
            editTenHuyen.setText(arrayListHuyen.get(intChiSo).getStrTen()); //Gán giá trị tên huyện
        }
        btnLuuLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
<A NAME="249"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#249',3,'match0-top.html#249',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    if (editMaHuyen.getText().length() != 0){
                        if (editTenHuyen.getText().length() != 0){
                            String sqlHuyen;
                            if (intChiSo == -1){ //Thêm mới
                                sqlHuyen = &quot;insert into TB_Huyen(MaTinh, MaHuyen, TenHuyen) values ('&quot;+strMaTinh+&quot;', '&quot;+editMaHuyen.getText()+&quot;', N'&quot;+editTenHuyen.getText()+&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlHuyen = &quot;update TB_Huyen set TenHuyen = N'&quot;+editTenHuyen.getText()+&quot;' where MaHuyen = '&quot;+editMaHuyen.getText()+&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlHuyen) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên quận/huyện thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên quận/huyện thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachHuyen(strMaTinh); //Load lại danh sách
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }
                            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên quận/huyện&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập mã quận/huyện&quot;);
                    }

                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="250"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#250',3,'match0-top.html#250',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaHuyen.getText().length() != 0) {
                    dialogXoa(editMaHuyen.getText().toString(), editTenHuyen.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã quận/huyện để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="251"></A>                dialog.cancel();
            }
        });
        <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#251',3,'match0-top.html#251',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách huyện
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên huyện
        adapterHuyen.filter(newText);
        return false;
    }

    private void dialogXoa(final String maHuyen, final String tenHuyen){
        //Hiện hộp thoại thông báo xóa huyện
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN QUẬN/HUYỆN&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa &quot;+tenHuyen+&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="252"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#252',3,'match0-top.html#252',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlHuyen = &quot;delete TB_Huyen where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlHuyen) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên quận/huyện thành công&quot;);
                        loadDanhSachHuyen(strMaTinh); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên quận/huyện&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }
}
</PRE>
<HR>
<H3><CENTER>KhaiBao\FragmentTinh.java</CENTER></H3><HR>
<PRE>
<A NAME="253"></A>package com.example.travelling.KhaiBao;

<FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#253',3,'match0-top.html#253',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import static java.util.Objects.requireNonNull;

public class FragmentTinh extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
    SearchView searchView;
    ImageButton btnThemMoi;
    ListView listView;
    public static ArrayList&lt;ClassTinh&gt; arrayListTinh;
    ListViewTinh adapterTinh;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();
    TextView textTieuDe;
    EditText editMaTinh, editTenTinh;
<A NAME="254"></A>    Button btnLuuLai, btnXoa, btnDong</B></FONT>;

    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#254',3,'match0-top.html#254',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_tinh, container, false);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        loadDanhSachTinh(); //Load danh sách tỉnh
        return view;
    }

    private void layoutAnhXa() {
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        clickListView</B></FONT>(); //Chọn tỉnh trên listview
        clickButton(); //Click nút thêm mới
<A NAME="255"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#255',3,'match0-top.html#255',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadDanhSachTinh(){
        arrayListTinh = new ArrayList&lt;&gt;();
        arrayListTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    arrayListTinh.add(new ClassTinh(resultSetTinh.getString(&quot;MaTinh&quot;), resultSetTinh.getString(&quot;TenTinh&quot;)));
                }
            }
            if (arrayListTinh.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
<A NAME="256"></A>            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
        <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#256',3,'match0-top.html#256',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        adapterTinh = new ListViewTinh(getContext());
        listView.setAdapter(adapterTinh);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }
    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên tỉnh
        adapterTinh.filter(newText);
        return false;
    }
    private void clickListView(){
        listView</B></FONT>.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateTinh(position);
            }
        });
    }
    private void clickButton(){
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
<A NAME="257"></A>                updateTinh(-1);
            }
        });
    <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#257',3,'match0-top.html#257',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
    private void updateTinh(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_tinh, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaTinh = alertLayout.findViewById(R.id.editMaTinh);
        editTenTinh = alertLayout.findViewById(R.id.editTenTinh);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            editMaTinh.setEnabled(true); //Cho phép nhập mã tỉnh
            String strTieuDe = &quot;THÊM MỚI TÊN TỈNH/THÀNH PHỐ&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            editMaTinh.setEnabled(false); //Không cho phép nhập mã tỉnh
            String strTieuDe = &quot;CẬP NHẬT TÊN TỈNH/THÀNH PHỐ&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaTinh.setText(arrayListTinh.get(intChiSo).getStrMa()); //Gán giá trị mã tỉnh
            editTenTinh.setText(arrayListTinh.get(intChiSo).getStrTen()); //Gán giá trị tên tỉnh
        }
        btnLuuLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
<A NAME="258"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#258',3,'match0-top.html#258',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    if (editMaTinh.getText().length() != 0){
                        if (editTenTinh.getText().length() != 0){
                            String sqlTinh;
                            if (intChiSo == -1){ //Thêm mới
                                sqlTinh = &quot;insert into TB_Tinh(MaTinh, TenTinh) values ('&quot;+editMaTinh.getText()+&quot;', N'&quot;+editTenTinh.getText()+&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlTinh = &quot;update TB_Tinh set TenTinh = N'&quot;+editTenTinh.getText()+&quot;' where MaTinh = '&quot;+editMaTinh.getText()+&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlTinh) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên tỉnh/thành phố thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên tỉnh/thành phố thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachTinh(); //Load lại danh sách
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
                            }
                            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên tỉnh/thành phố&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập mã tỉnh/thành phố&quot;);
                    }

                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
                }
            }
        });
<A NAME="259"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#259',3,'match0-top.html#259',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaTinh.getText().length() != 0) {
                    dialogXoa(editMaTinh.getText().toString(), editTenTinh.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã tỉnh/thành phố để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="260"></A>                dialog.cancel();
            }
        });
        <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#260',3,'match0-top.html#260',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách tỉnh
    }

    private void dialogXoa(final String maTinh, final String tenTinh){
        //Hiện hộp thoại thông báo xóa tỉnh
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN TỈNH/THÀNH PHỐ&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa &quot;+ tenTinh +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="261"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#261',3,'match0-top.html#261',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlTinh = &quot;delete TB_Tinh where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlTinh) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên tỉnh/thành phố thành công&quot;);
                        loadDanhSachTinh(); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên tỉnh/thành phố&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }
}
</PRE>
<HR>
<H3><CENTER>KhaiBao\FragmentXa.java</CENTER></H3><HR>
<PRE>
<A NAME="262"></A>package com.example.travelling.KhaiBao;

<FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#262',3,'match0-top.html#262',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentXa extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
    SearchView searchView;
    ImageButton btnThemMoi;
    Spinner cmdTinh, cmdHuyen;
    ListView listView;
    public static ArrayList&lt;ClassTinh&gt; arrayListXa;
    ListViewXa adapterXa;
    ClassConnect classConnect;
<A NAME="263"></A>    ClassPublic classPublic = new ClassPublic();
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList</B></FONT>&lt;&gt;();
    ArrayList&lt;<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#263',3,'match0-top.html#263',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    String strMaTinh, strMaHuyen;
    TextView textTieuDe;
    EditText editMaXa, editTenXa;
    Button btnLuuLai, btnXoa, btnDong</B></FONT>;

    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_xa, container, false);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
<A NAME="264"></A>        loadTinh(); //Load tên tỉnh
        return view;
    }
    private <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#264',3,'match0-top.html#264',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
<A NAME="265"></A>        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        btnThemMoi</B></FONT> = <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#265',3,'match0-top.html#265',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>view.findViewById(R.id.btnThemMoi);
        clickListView(); //Chọn xã trên listview
        clickButton(); //Click nút thêm mới
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }</B></FONT>
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
<A NAME="266"></A>                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#266',3,'match0-top.html#266',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
<A NAME="267"></A>        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#267',3,'match0-top.html#267',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
                    loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+maTinh+&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="268"></A>                cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(<FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#268',3,'match0-top.html#268',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
<A NAME="269"></A>        if (listMaHuyen.isEmpty()){
            loadDanhSachXa(&quot;&quot;);
        }
        cmdHuyen</B></FONT>.setOnItemSelectedListener(new <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#269',3,'match0-top.html#269',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()) {
                    strMaHuyen = listMaHuyen.get(position);
                    loadDanhSachXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    private void</B></FONT> clickListView(){
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                updateXa(position);
            }
        });
    }

    private void clickButton() {
        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                updateXa(-1);
            }
        });
<A NAME="270"></A>    }
    private void updateXa(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#270',3,'match0-top.html#270',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>inflater.inflate(R.layout.dialog_xa, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaXa = alertLayout.findViewById(R.id.editMaXa);
        editTenXa = alertLayout.findViewById(R.id.editTenXa);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            editMaXa.setEnabled(true); //Cho phép nhập mã xã
            String strTieuDe = &quot;THÊM MỚI TÊN PHƯỜNG/XÃ&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            editMaXa.setEnabled(false); //Không cho phép nhập mã xã
            String strTieuDe = &quot;CẬP NHẬT TÊN PHƯỜNG/XÃ&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaXa.setText(arrayListXa.get(intChiSo).getStrMa()); //Gán giá trị mã mã
            editTenXa.setText(arrayListXa</B></FONT>.get(intChiSo).getStrTen()); //Gán giá trị tên xã
        }
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
<A NAME="271"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#271',3,'match0-top.html#271',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    if (editMaXa.getText().length() != 0){
                        if (editTenXa.getText().length() != 0){
                            String sqlXa;
                            if (intChiSo == -1){ //Thêm mới
<A NAME="272"></A>                                sqlXa = &quot;insert into TB_Xa(MaHuyen, MaXa, TenXa) values ('&quot;+strMaHuyen+&quot;', '&quot;+editMaXa.getText()+&quot;', N'&quot;+editTenXa.getText()+&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlXa</B></FONT> = &quot;update TB_Xa set TenXa = N'&quot;+<FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#272',3,'match0-top.html#272',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editTenXa.getText()+&quot;' where MaXa = '&quot;+editMaXa.getText()+&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlXa) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên phường/xã thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên phường/xã thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachXa</B></FONT>(strMaHuyen); //Load lại danh sách
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
<A NAME="273"></A>                            }
                            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#273',3,'match0-top.html#273',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên phường/xã&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập mã phường/xã&quot;);
                    }

                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
<A NAME="274"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#274',3,'match0-top.html#274',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaXa.getText().length() != 0) {
                    dialogXoa(editMaXa.getText().toString(), editTenXa.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã phường/xã để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="275"></A>                dialog.cancel();
            }
        });
        <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#275',3,'match0-top.html#275',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách tỉnh
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachXa(String maHuyen) {
        arrayListXa = new ArrayList&lt;&gt;();
        arrayListXa.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+maHuyen+&quot;'&quot;;
<A NAME="276"></A>            ResultSet resultSetXa = classConnect.selectData(getActivity(), sqlXa);
            if (resultSetXa != null){
                while (resultSetXa</B></FONT>.next()){
                    arrayListXa.add(new ClassTinh(<FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#276',3,'match0-top.html#276',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetXa.getString(&quot;MaXa&quot;), resultSetXa.getString(&quot;TenXa&quot;)));
                }
            }
            if (arrayListXa.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
<A NAME="277"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log</B></FONT>.e(&quot;TAG&quot;, <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#277',3,'match0-top.html#277',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(e.getMessage()));
        }
        adapterXa = new ListViewXa(getContext());
        listView.setAdapter(adapterXa);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên xã
        adapterXa.filter(newText);
        return false;
    }

    private void dialogXoa(final String maXa, final String tenXa){
        //Hiện hộp thoại thông báo xóa xã
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN PHƯỜNG/XÃ&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa &quot;+ tenXa +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="278"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#278',3,'match0-top.html#278',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlXa = &quot;delete TB_Xa where MaXa = '&quot;+ maXa +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlXa) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên phường/xã thành công&quot;);
                        loadDanhSachXa(strMaHuyen); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên phường/xã&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }
}
</PRE>
<HR>
<H3><CENTER>KhaiBao\ListViewHuyen.java</CENTER></H3><HR>
<PRE>
<A NAME="279"></A>package com.example.travelling.KhaiBao;

import android.annotation.SuppressLint;
<FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#279',3,'match0-top.html#279',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewHuyen extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassTinh&gt; arraylist;

    public ListViewHuyen(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentHuyen.arrayListHuyen);
<A NAME="280"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#280',3,'match0-top.html#280',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTen;
    }
    @Override
    public int getCount() {
        return FragmentHuyen.arrayListHuyen.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentHuyen.arrayListHuyen.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_tinh, null);
            holder.textTen = convertView</B></FONT>.findViewById(R.id.textTen);
            convertView.setTag(holder);
        } else {
<A NAME="281"></A>            holder = (ViewHolder) convertView.getTag();
        }

        <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#281',3,'match0-top.html#281',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTen.setText((position + 1) + &quot;. &quot; + FragmentHuyen.arrayListHuyen.get(position).getStrTen());
        return convertView;
    }
    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentHuyen.arrayListHuyen.clear();
        if (charText.length() == 0) {
            FragmentHuyen.arrayListHuyen.addAll(arraylist);
        } else {
            for (ClassTinh wp : arraylist) {
                if (wp.getStrTen().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentHuyen.arrayListHuyen.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhaiBao\ListViewTinh.java</CENTER></H3><HR>
<PRE>
<A NAME="282"></A><FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#282',3,'match0-top.html#282',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhaiBao;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewTinh extends BaseAdapter {
<A NAME="283"></A>
    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassTinh</B></FONT>&gt; <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#283',3,'match0-top.html#283',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arraylist;

    public ListViewTinh(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentTinh.arrayListTinh);
<A NAME="284"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#284',3,'match0-top.html#284',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTen;
    }
    @Override
    public int getCount() {
        return FragmentTinh.arrayListTinh.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentTinh.arrayListTinh.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_tinh, null);
            holder.textTen = convertView</B></FONT>.findViewById(R.id.textTen);
            convertView.setTag(holder);
        } else {
<A NAME="285"></A>            holder = (ViewHolder) convertView.getTag();
        }

        <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#285',3,'match0-top.html#285',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTen.setText((position + 1) + &quot;. &quot; + FragmentTinh.arrayListTinh.get(position).getStrTen());
        return convertView;
    }
    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentTinh.arrayListTinh.clear();
        if (charText.length() == 0) {
            FragmentTinh.arrayListTinh.addAll(arraylist);
        } else {
            for (ClassTinh wp : arraylist) {
                if (wp.getStrTen().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentTinh.arrayListTinh.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KhaiBao\ListViewXa.java</CENTER></H3><HR>
<PRE>
<A NAME="286"></A><FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#286',3,'match0-top.html#286',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KhaiBao;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.util.ArrayList;
import</B></FONT> java.util.Locale;
<A NAME="287"></A>
public class ListViewXa extends BaseAdapter {

    Context <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#287',3,'match0-top.html#287',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassTinh&gt; arraylist;

    public ListViewXa(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentXa.arrayListXa);
<A NAME="288"></A>    }

    public static class</B></FONT> ViewHolder {
        TextView <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#288',3,'match0-top.html#288',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>textTen;
    }
    @Override
    public int getCount() {
        return FragmentXa.arrayListXa.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentXa.arrayListXa.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_tinh, null);
            holder.textTen = convertView</B></FONT>.findViewById(R.id.textTen);
            convertView.setTag(holder);
        } else {
<A NAME="289"></A>            holder = (ViewHolder) convertView.getTag();
        }

        <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#289',3,'match0-top.html#289',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTen.setText((position + 1) + &quot;. &quot; + FragmentXa.arrayListXa.get(position).getStrTen());
        return convertView;
    }
    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentXa.arrayListXa.clear();
        if (charText.length() == 0) {
            FragmentXa.arrayListXa.addAll(arraylist);
        } else {
            for (ClassTinh wp : arraylist) {
                if (wp.getStrTen().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentXa.arrayListXa.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KinhDoanh\ClassKinhDoanhGan.java</CENTER></H3><HR>
<PRE>
<A NAME="219"></A><FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#219',3,'match0-top.html#219',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.KinhDoanh;

public class ClassKinhDoanhGan {
    private Integer intSTT, intMaGan;
    private Double doubleKhoangCach;
    private String strTenDiaDiem, strDiaChi;
    public ClassKinhDoanhGan(Integer intSTT, Integer intMaGan, String strTenDiaDiem, String strDiaChi, Double doubleKhoangCach){
        this.intSTT = intSTT;
        this.intMaGan = intMaGan;
        this.strTenDiaDiem = strTenDiaDiem;
        this.strDiaChi = strDiaChi;
        this.doubleKhoangCach = doubleKhoangCach;
    }

    public Integer getIntSTT() {
        return intSTT;
    }

    public Integer getIntMaGan() {
        return intMaGan;
    }

    public String getStrTenDiaDiem() {
        return strTenDiaDiem;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Double getDoubleKhoangCach() {
        return doubleKhoangCach;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>KinhDoanh\KinhDoanhGanFragment.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KinhDoanh;
<A NAME="220"></A>
import android.annotation.SuppressLint;
import android.content.Context;
<FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#220',3,'match0-top.html#220',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.SharedPreferences;
import android.os.Bundle;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.Spinner;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.ClassDiaDiemGan_View;
import com.example.travelling.DiaDiem.ListViewDiaDiemGan_View;
import com.example.travelling.Home.FragmentHome;
import com.example.travelling.Menu.FragmentListMenu;
import com.example.travelling.R;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class KinhDoanhGanFragment extends Fragment {

    //Khai báo
    private View view;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
    private SharedPreferences.Editor editor;
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
<A NAME="221"></A>    private ClassPublic classPublic = new ClassPublic();
    private ClassConnect classConnect;
    private String mTaiKhoan</B></FONT>;
    private String strMaTinh, strMaHuyen, strMaDiaDiem, ganMaTinh, <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#221',3,'match0-top.html#221',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaHuyen;
    private Spinner cmdTinh, cmdHuyen, cmdDiaDiem;
    private EditText editKhoangCach;
    private ImageButton btnQuayLai, btnThemMoi;
    private ListView listView;
    public static ArrayList&lt;ClassKinhDoanhGan&gt; arrayListDiaDiemGan;
    private ListViewKinhDoanhGan adapterDiaDiemGan;
    private ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    private ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    private ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
<A NAME="222"></A>    private ArrayList&lt;String&gt; listMaDiaDiem = new ArrayList&lt;&gt;(); //Khai báo danh sách địa điểm du lịch
    private ArrayList&lt;String&gt; listTenDiaDiem = new ArrayList</B></FONT>&lt;&gt;();

    <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#222',3,'match0-top.html#222',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_kinh_doanh_gan, container, false);
        sharedpreferences = Objects</B></FONT>.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
<A NAME="223"></A>        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        mTaiKhoan = <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#223',3,'match0-top.html#223',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sharedpreferences.getString(User,&quot;&quot;);
        layoutAnhXa(); //Ánh xạ các đối tượng Layout
        return view;
    }

    private void layoutAnhXa() {
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        cmdDiaDiem = view.findViewById(R.id.cmdDiaDiem);
        editKhoangCach = view.findViewById(R.id.editKhoangCach);
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        listView = view</B></FONT>.findViewById(R.id.listView);
<A NAME="224"></A>        loadDanhSachDiaDiemGan(mTaiKhoan);
        ganDuLieu(mTaiKhoan); //Gán dữ liệu cho các đối tượng
        loadTinh();
        <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#224',3,'match0-top.html#224',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>clickButton();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDanhSachDiaDiemGan(String taiKhoan) {
        arrayListDiaDiemGan = new ArrayList&lt;&gt;();
        arrayListDiaDiemGan.clear();
        int intSTT = 0;
        try{
<A NAME="225"></A>            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select * from TB_DiaDiem dd, TB_KinhDoanhGan kdg, TB_Tinh t, TB_Huyen h, TB_Xa x &quot;</B></FONT> +
                    &quot;where dd.MaDiaDiem = kdg.MaDiaDiem and dd.MaTinh = t.MaTinh and dd.MaHuyen = h.MaHuyen and dd.MaXa = x.MaXa and kdg.TaiKhoan = '&quot;+taiKhoan+&quot;'&quot;;
            ResultSet <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#225',3,'match0-top.html#225',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null){
                while (resultSetDiaDiem.next()){
                    String strDiaChi = resultSetDiaDiem.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetDiaDiem.getString(&quot;TenHuyen&quot;)+&quot; - &quot;+resultSetDiaDiem.getString(&quot;TenTinh&quot;));
                    arrayListDiaDiemGan.add(new ClassKinhDoanhGan(++intSTT, Integer.parseInt(resultSetDiaDiem.getString(&quot;MaGan&quot;)), resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;),
                            strDiaChi, Double.parseDouble(resultSetDiaDiem.getString(&quot;KhoangCach&quot;))));
                }
            }
            if (arrayListDiaDiemGan.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
<A NAME="226"></A>            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        adapterDiaDiemGan = new ListViewKinhDoanhGan(getContext());
        <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#226',3,'match0-top.html#226',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listView.setAdapter(adapterDiaDiemGan);
    }

    private void ganDuLieu(String taiKhoan) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTaiKhoan = &quot;select * from TB_NguoiDung where TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetTaiKhoan = classConnect.selectData(getActivity(), sqlTaiKhoan);
            if (resultSetTaiKhoan != null &amp;&amp; resultSetTaiKhoan.next()){
                ganMaTinh = resultSetTaiKhoan.getString(&quot;MaTinh&quot;);
                ganMaHuyen = resultSetTaiKhoan</B></FONT>.getString(&quot;MaHuyen&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
<A NAME="227"></A>        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#227',3,'match0-top.html#227',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void loadTinh() {
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
<A NAME="228"></A>                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#228',3,'match0-top.html#228',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listMaHuyen.clear(); // Xóa danh sách huyện
<A NAME="229"></A>            listTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
            dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#229',3,'match0-top.html#229',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setAdapter(dataHuyen);
            loadDiaDiem(strMaHuyen); //Load danh sách xã
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
<A NAME="230"></A>                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh</B></FONT>.setSelection(listMaTinh.indexOf(ganMaTinh));
                        strMaTinh = ganMaTinh;
                        <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#230',3,'match0-top.html#230',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaTinh = &quot;&quot;;
                    }
                    loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
<A NAME="231"></A>                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#231',3,'match0-top.html#231',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaDiaDiem.clear(); // Xóa danh sách xã
            listTenDiaDiem.clear();
            ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenDiaDiem);
<A NAME="232"></A>            dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdDiaDiem.setAdapter(dataDiaDiem);
        }
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#232',3,'match0-top.html#232',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()) {
                    strMaHuyen = listMaHuyen.get(position);
<A NAME="233"></A>                    if (!ganMaHuyen.equals(&quot;&quot;)) {
                        cmdHuyen.setSelection(listMaHuyen.indexOf(ganMaHuyen));
                        strMaHuyen</B></FONT> = ganMaHuyen;
                        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#233',3,'match0-top.html#233',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaHuyen = &quot;&quot;;
                    }
                    loadDiaDiem(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadDiaDiem(String maHuyen) { //Danh sách địa điểm
        listMaDiaDiem.clear(); // Xóa danh sách địa điểm
        listTenDiaDiem.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlDiaDiem = &quot;select MaDiaDiem, TenDiaDiem from TB_DiaDiem where MaHuyen = '&quot; + maHuyen + &quot;'&quot;;
            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null) {
                while (resultSetDiaDiem.next()) {
                    listMaDiaDiem.add(resultSetDiaDiem.getString(&quot;MaDiaDiem&quot;));
                    listTenDiaDiem.add(resultSetDiaDiem.getString(&quot;TenDiaDiem&quot;));
                }
                ArrayAdapter&lt;String&gt; dataDiaDiem = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item, listTenDiaDiem);
                dataDiaDiem</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="234"></A>                cmdDiaDiem.setAdapter(dataDiaDiem);
            }
            if (listMaDiaDiem.isEmpty()) {
                classPublic.ThongBao(<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#234',3,'match0-top.html#234',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách địa điểm&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        } catch (Exception e) {
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdDiaDiem.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaDiaDiem.isEmpty()) {
                    strMaDiaDiem = listMaDiaDiem.get(position);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentListMenu());
                fragmentTransaction.commit();
            }
        });

        btnThemMoi.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="235"></A>                if (!listMaDiaDiem.isEmpty()){
                    if (editKhoangCach.getText().length() != 0){
                        try {
<A NAME="236"></A>                            <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#235',3,'match0-top.html#235',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlDiaDiem = &quot;insert into TB_KinhDoanhGan(TaiKhoan, MaDiaDiem, KhoangCach) values('&quot;+mTaiKhoan+&quot;', '&quot;+strMaDiaDiem+&quot;', '&quot;+Float.parseFloat(editKhoangCach.getText().toString())+&quot;')&quot;;
                            if (classConnect</B></FONT>.updateData(getActivity(), sqlDiaDiem) == 1){
                                <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#236',3,'match0-top.html#236',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.ThongBao(getActivity(), &quot;Thông báo! Thêm địa điểm thành công&quot;);
                                loadDanhSachDiaDiemGan(mTaiKhoan);
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Thông báo! Không thêm được địa điểm&quot;);
                            }
                            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;ATG&quot;, e.getMessage());
                        }
                    }
                    else {
                        classPublic</B></FONT>.ThongBao(getActivity(),&quot;Thông báo! Bạn chưa nhập khoảng cách&quot;);
                    }
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Bạn chưa chọn địa điểm&quot;);
                }
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>KinhDoanh\ListViewKinhDoanhGan.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.KinhDoanh;
<A NAME="237"></A>
import android.annotation.SuppressLint;
import android.app.Activity;
<FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#237',3,'match0-top.html#237',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;

public class ListViewKinhDoanhGan extends BaseAdapter {
    private Context mContext;
    private LayoutInflater inflater;
<A NAME="238"></A>    private ArrayList&lt;ClassKinhDoanhGan&gt; arraylist;
    private ClassConnect classConnect</B></FONT>;
    private ClassPublic classPublic = new ClassPublic();
    public <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#238',3,'match0-top.html#238',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ListViewKinhDoanhGan(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(KinhDoanhGanFragment.arrayListDiaDiemGan);
    }
    public static class ViewHolder {
        TextView textSTT, textDiaDiem, textDiaChi, textKhoangCach;
        ImageButton btnDelete;
    }
    @Override
    public int getCount() {
        return KinhDoanhGanFragment.arrayListDiaDiemGan.size();
    }

    @Override
    public Object getItem(int position) {
        return KinhDoanhGanFragment.arrayListDiaDiemGan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;, &quot;DefaultLocale&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewKinhDoanhGan.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewKinhDoanhGan.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_kinhdoanh_gan, null);
            holder.textSTT = convertView.findViewById(R.id.textSTT);
            holder.textDiaDiem = convertView.findViewById(R.id.textDiaDiem);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.textKhoangCach = convertView.findViewById(R.id.textKhoangCach);
            holder.btnDelete = convertView.findViewById(R.id.btnDelete);
            convertView.setTag(holder);
        } else {
            holder = (ListViewKinhDoanhGan.ViewHolder) convertView.getTag();
        }

        holder.textSTT.setText(&quot;[&quot;+KinhDoanhGanFragment.arrayListDiaDiemGan.get(position).getIntSTT()+&quot;]&quot;);
        holder.textDiaDiem.setText(KinhDoanhGanFragment.arrayListDiaDiemGan.get(position).getStrTenDiaDiem());
        holder.textDiaChi.setText(KinhDoanhGanFragment</B></FONT>.arrayListDiaDiemGan.get(position).getStrDiaChi());
        Double doubleKhoangCach = KinhDoanhGanFragment.arrayListDiaDiemGan.get(position).getDoubleKhoangCach();
        if (doubleKhoangCach &lt; 1000) {
            holder.textKhoangCach.setText(&quot;Cách khoảng: &quot; + String.format(&quot;%.0f&quot;, doubleKhoangCach) +&quot;m&quot;);
        }
        else {
            holder.textKhoangCach.setText(&quot;Cách khoảng: &quot; + (doubleKhoangCach/1000) +&quot;km&quot;);
        }

        holder.btnDelete.setOnClickListener(new View.OnClickListener() {
<A NAME="239"></A>            @Override
            public void onClick(View v) {
                //Hiện hộp thoại thông báo thay đổi trạng thái tài khoản
                final Integer <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#239',3,'match0-top.html#239',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>intMaGan = KinhDoanhGanFragment.arrayListDiaDiemGan.get(position).getIntMaGan();
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa &quot;+KinhDoanhGanFragment.arrayListDiaDiemGan.get(position).getStrTenDiaDiem()+&quot; không?&quot;);
                builder.setCancelable(false);
                builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlKinhDoanh = &quot;delete TB_KinhDoanhGan where MaGan = '&quot;+intMaGan+&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlKinhDoanh) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa thành công&quot;);
                                KinhDoanhGanFragment.fragmentTransaction = KinhDoanhGanFragment.fragmentManager.beginTransaction();
                                KinhDoanhGanFragment.fragmentTransaction.replace(R.id.fragment_main, new KinhDoanhGanFragment());
                                KinhDoanhGanFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        return convertView;
    }
}
</PRE>
<HR>
<H3><CENTER>MainActivity.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>package com.example.travelling;

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#0',3,'match0-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import androidx.appcompat.app.AppCompatActivity;
import android.annotation.SuppressLint;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Class.ConnectionReceiver;
import com.example.travelling.NguoiDung.DangKyActivity;
import com.example.travelling.Home.MainHomeActivity;
import java.sql.ResultSet;
import java.util.Objects;

public class MainActivity extends AppCompatActivity {
    //Khai báo biến
    EditText editTaiKhoan, editMatKhau;
    Button btnDangNhap, btnDangKy, btnDong;
    ImageButton btnView;
    ClassPublic classPublic</B></FONT> = new ClassPublic();
<A NAME="1"></A>    ClassConnect classConnect;
    public static final String MyPREFERENCES = &quot;MyPrefs&quot;; //Nhớ tài khoản đăng nhập
    public static final String User = &quot;userKey&quot;;
    public static final String <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#1',3,'match0-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Pass = &quot;passKey&quot;;
    SharedPreferences sharedpreferences;
    SharedPreferences.Editor editor;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //Kiểm tra thiết bị có kết nối Internet hay không
        if (ConnectionReceiver.isConnected()){
            sharedpreferences = getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
            editor = sharedpreferences.edit();
            editor.apply();
            if (sharedpreferences.getString(User, &quot;&quot;).equals(&quot;&quot;) || sharedpreferences.getString(Pass, &quot;&quot;).equals(&quot;&quot;)){
                layoutAnhXa(); //Ánh xạ các đối tượng Layout
            }
            else</B></FONT> {
                Intent intent = new Intent(MainActivity.this, MainHomeActivity.class);
                intent.putExtra(&quot;MaTinh&quot;,&quot;&quot;);
                startActivity(intent); //Nếu chưa đăng xuất chuyển qua trang MainHome khoogn cần đăng nhập
            }
        }
        else {
            classPublic.ThongBao(MainActivity.this, &quot;Thông báo! Bạn chưa kết nối Internet&quot;);
            finish(); //Đóng phần mềm
<A NAME="2"></A>        }
    }
    private void layoutAnhXa() {
        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#2',3,'match0-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editTaiKhoan = findViewById(R.id.editTaiKhoan);
        editMatKhau = findViewById(R.id.editMatKhau);
        btnDangNhap = findViewById(R.id.btnDangNhap);
        btnDangKy = findViewById(R.id.btnDangKy);
        btnDong = findViewById(R.id.btnDong);
        btnView = findViewById(R.id.btnView);
        clickButton(); //Click nút
    }
    private void clickButton() {
        //Click đăng nhập
        btnDangNhap</B></FONT>.setOnClickListener(new View.OnClickListener() {
<A NAME="3"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#3',3,'match0-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editTaiKhoan.getText().length() != 0){ //Kiểm tra rỗng tài khoản
                    if (editMatKhau.getText().length() != 0){ //Kiểm tra rỗng mật khẩu
                        classConnect = new ClassConnect(); //Tạo kết nối đến SQL
                        //Kiểm tra tên tài khoản
                        String sqlTaiKhoan = &quot;select TaiKhoan from TB_NguoiDung where TaiKhoan = '&quot;+editTaiKhoan.getText()+&quot;'&quot;;
                        ResultSet resultSetTaiKhoan = classConnect.selectData(MainActivity.this, sqlTaiKhoan);
                        try {
                            if (resultSetTaiKhoan != null &amp;&amp; resultSetTaiKhoan.next()){
                                //Kiểm tra mật khẩu
                                String sqlMatKhau = &quot;select TaiKhoan from TB_NguoiDung where &quot; +
                                        &quot;TaiKhoan = '&quot;+editTaiKhoan.getText()+&quot;' and MatKhau = '&quot;+editMatKhau.getText()+&quot;'&quot;;
                                ResultSet resultSetMatKhau = classConnect.selectData(MainActivity.this,sqlMatKhau);
                                if (resultSetMatKhau != null &amp;&amp; resultSetMatKhau.next()){
                                    //Kiểm tra trạng thái
                                    String sqlTrangThai = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where &quot; +
                                            &quot;TaiKhoan = '&quot;+editTaiKhoan.getText()+&quot;' and MatKhau = '&quot;+editMatKhau.getText()+&quot;' and &quot; +
                                            &quot;TrangThai = 1&quot;;
                                    ResultSet resultSetTrangThai = classConnect.selectData(MainActivity.this,sqlTrangThai);
                                    if (resultSetTrangThai != null &amp;&amp; resultSetTrangThai.next()){
                                        //Nhớ tài khoản đăng nhập
                                        editor.putString(User, editTaiKhoan.getText().toString()); //Lưu tên tài khoản
                                        editor.putString(Pass, editMatKhau.getText().toString()); //Lưu mật khẩu
                                        editor.commit();
                                        //Đăng nhập thành công
                                        classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Đăng nhập thành công&quot;);
                                        Intent intent = new Intent(MainActivity.this, MainHomeActivity.class);
<A NAME="4"></A>                                        intent</B></FONT>.putExtra(&quot;MaTinh&quot;,&quot;&quot;);
                                        startActivity(intent); //Nếu chưa đăng xuất chuyển qua trang MainHome khoogn cần đăng nhập
                                    }
                                    <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#4',3,'match0-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                                        classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Tài khoản đang bị khóa&quot;);
                                    }
                                }
                                else {
                                    classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Mật khẩu chưa đúng&quot;);
                                }
                            }
                            else {
                                classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Tên tài khoản chưa đúng&quot;);
                            }
                            classConnect.CONN(MainActivity.this).close(); //Đóng kết nối SQL
                        }catch (Exception e){
                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                    else</B></FONT> {
                        classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Vui lòng nhập mật khẩu&quot;);
                    }
                }
                else {
                    classPublic.ThongBao(MainActivity.this,&quot;Thông báo! Vui lòng nhập tài khoản&quot;);
                }
            }
        });

        //Click đăng ký
        btnDangKy.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                startActivity(new Intent(MainActivity.this, DangKyActivity.class)); //Chuyên qua trang đăng ký tài khoản
            }
        });

        //Click đóng
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                System.exit(0);
            }
        });

        //Hiển thị mật khẩu
        btnView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                editMatKhau.setInputType(1); //Hiển thị và cho phép thay đổi mật khẩu
            }
        });
    }

    @Override
    public void onBackPressed() {

    }

    @Override
    protected void onStop() {
        super.onStop();
        finish();
    }
}
</PRE>
<HR>
<H3><CENTER>Menu\ClassMenu.java</CENTER></H3><HR>
<PRE>
<A NAME="210"></A><FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#210',3,'match0-top.html#210',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Menu;

public class ClassMenu {
    private String strAnh, strMenu;
    public ClassMenu(String strAnh, String strMenu){
        this.strAnh = strAnh;
        this.strMenu = strMenu;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrMenu() {
        return strMenu;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>Menu\FragmentListMenu.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.Menu;

import android.annotation.SuppressLint;
<A NAME="211"></A>import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
<FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#211',3,'match0-top.html#211',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ListView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.CtyDuLich.FragmentTourDuLich_Edit;
import com.example.travelling.DacSan.FragmentDacSan_Edit;
import com.example.travelling.DiaDiem.FragmentDiaDiemGan_Edit;
import com.example.travelling.DiaDiem.FragmentDiaDiem_Edit;
import com.example.travelling.KhachSan.FragmentKhachSan_Edit;
import com.example.travelling.KhaiBao.FragmentHuyen;
import com.example.travelling.KhaiBao.FragmentTinh;
import com.example.travelling.KhaiBao.FragmentXa;
import com.example.travelling.KinhDoanh.KinhDoanhGanFragment;
import com.example.travelling.MainActivity;
import com.example.travelling.NguoiDung.FragmentDanhSachTaiKhoan;
import com.example.travelling.NguoiDung.FragmentDoiMatKhau;
import com.example.travelling.NguoiDung.QuanTriTinhFragment;
import com.example.travelling.NhaHang.FragmentNhaHang_Edit;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentListMenu extends Fragment {

    //Phần khai báo
    View view;
    ListView listView;
    static ArrayList&lt;ClassMenu&gt; arrayListListMenu;
    ListViewListMenu adapterListMenu;
    FragmentManager fragmentManager; //Tạo Fragment
    FragmentTransaction fragmentTransaction;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;
<A NAME="212"></A>    String strLoaiTaiKhoan, strTaiKhoan;
    final ClassPublic classPublic</B></FONT> = new ClassPublic();

    <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#212',3,'match0-top.html#212',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_listmenu, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE); //Nhớ tài khoản
        editor = sharedpreferences.edit();
<A NAME="213"></A>        editor.apply();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        strLoaiTaiKhoan = classPublic.layLoaiTaiKhoan(strTaiKhoan, getActivity</B></FONT>());
        <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#213',3,'match0-top.html#213',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>layoutDoiTuong(); //Ánh xạ các đối tượng trên frame_listmenu
        showMenu(); //Hiển thị các menu list
        return view;
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void layoutDoiTuong() {
        listView = view.findViewById(R.id.listView);
        clickListView(); //Khi người dùng click trên listview
    }

    private void clickListView() {
        listView</B></FONT>.setOnItemClickListener(new AdapterView.OnItemClickListener() {
<A NAME="214"></A>            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                switch (arrayListListMenu.get(position).getStrMenu()){
                    case &quot;Danh sách tài khoản người dùng&quot;<FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#214',3,'match0-top.html#214',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>: //Khi người dùng chọn danh sách tài khoản người dùng
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Quản trị tỉnh&quot;: //Khi người dùng chọn quản trị tỉnh
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách địa điểm du lịch&quot;: //Khi người dùng chọn danh sách địa điểm du lịch
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentDiaDiem_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách điểm du lịch gần nhau&quot;: //Khi người dùng chọn danh sách điểm du lịch gần nhau
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentDiaDiemGan_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách tour du lịch&quot;: //Danh sách tour du lịch
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentTourDuLich_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách món ăn&quot;: //Danh sách món ăn
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentNhaHang_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách phòng&quot;: //Danh sách phòng
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentKhachSan_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Khoảng cách đến điểm du lịch&quot;: //Danh sách khoảng cách đến điểm du lịch
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new KinhDoanhGanFragment());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách đặc sản&quot;: //Danh sách đặc sản
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentDacSan_Edit());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách tỉnh/thành phố&quot;: //Khi người dùng chọn danh sách tỉnh/thành phố
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentTinh());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách quận/huyện&quot;: //Khi người dùng chọn danh sách quận/huyện
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentHuyen());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Danh sách phường/xã&quot;: //Khi người dùng chọn danh sách phường/xã
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentXa());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Đổi mật khẩu&quot;: //Khi người dùng chọn đổi mật khẩu
                        fragmentTransaction = fragmentManager.beginTransaction();
                        fragmentTransaction.replace(R.id.fragment_main, new FragmentDoiMatKhau());
                        fragmentTransaction.commit();
                        break;
                    case &quot;Đăng xuất&quot;: //Khi người dùng chọn đăng xuất
                        //Hiện hộp thoại thông báo đăng xuất
                        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn có muốn đăng xuất không?&quot;);
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @SuppressLint(&quot;NewApi&quot;)
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                editor.clear(); //Xóa tài khoản đã nhớ
                                editor.commit();
                                startActivity(new Intent(getActivity(), MainActivity.class));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                dialogInterface.dismiss(); //Đóng hộp thoại thông báo
                            }
                        });
                        AlertDialog alertDialog = builder.create();
                        alertDialog.show(); //Hiển thị hộp thoại thông báo
                        break;
<A NAME="215"></A>                }
            }
        });
    <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#215',3,'match0-top.html#215',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void showMenu() {
        arrayListListMenu = new ArrayList&lt;&gt;();
        arrayListListMenu.clear();
        switch (strLoaiTaiKhoan){
            case &quot;1&quot;: //Quản trị phần mềm
                //Danh sách đặc sản
                arrayListListMenu.add(new ClassMenu(&quot;ic_dacsan_white_24&quot;, &quot;Danh sách đặc sản&quot;));
                //Danh sách tài khoản người dùng
                arrayListListMenu.add(new ClassMenu(&quot;ic_person_white_24&quot;, &quot;Danh sách tài khoản người dùng&quot;));
                //Quản trị tỉnh
                arrayListListMenu.add(new ClassMenu(&quot;ic_person_white_24&quot;, &quot;Quản trị tỉnh&quot;));
                //Danh sách địa điểm du lịch
                arrayListListMenu.add(new ClassMenu(&quot;ic_diadiem_white_24&quot;, &quot;Danh sách địa điểm du lịch&quot;));
<A NAME="216"></A>                //Danh sách điểm du lịch gần nhau
                arrayListListMenu.add(new ClassMenu</B></FONT>(&quot;ic_diadiem_white_24&quot;, &quot;Danh sách điểm du lịch gần nhau&quot;));
                //Danh sách tỉnh/thành phố
                <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#216',3,'match0-top.html#216',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListListMenu.add(new ClassMenu(&quot;ic_danhsach_white&quot;, &quot;Danh sách tỉnh/thành phố&quot;));
                //Danh sách quận/huyện
                arrayListListMenu.add(new ClassMenu(&quot;ic_danhsach_white&quot;, &quot;Danh sách quận/huyện&quot;));
                //Danh sách phường/xã
                arrayListListMenu.add(new ClassMenu(&quot;ic_danhsach_white&quot;, &quot;Danh sách phường/xã&quot;));
                break;
            case &quot;3&quot;: //Công ty du lịch
                //Danh sách tour du lịch
                arrayListListMenu.add(new ClassMenu(&quot;ic_danhsach_white&quot;, &quot;Danh sách tour du lịch&quot;));
                break;
            case &quot;4&quot;: //Quán án - nhà hàng
                //Danh sách món ăn
                arrayListListMenu.add(new ClassMenu</B></FONT>(&quot;ic_danhsach_white&quot;, &quot;Danh sách món ăn&quot;));
                //Khoảng cách đến điểm du lịch
                arrayListListMenu.add(new ClassMenu(&quot;ic_ganke_white_24&quot;, &quot;Khoảng cách đến điểm du lịch&quot;));
                break;
            case &quot;5&quot;: //Nhà nghỉ - khách sạn
                //Danh sách phòng
                arrayListListMenu.add(new ClassMenu(&quot;ic_danhsach_white&quot;, &quot;Danh sách phòng&quot;));
                //Khoảng cách đến điểm du lịch
                arrayListListMenu.add(new ClassMenu(&quot;ic_ganke_white_24&quot;, &quot;Khoảng cách đến điểm du lịch&quot;));
                break;
            case &quot;6&quot;: //Quản trị tỉnh
                //Danh sách đặc sản
                arrayListListMenu.add(new ClassMenu(&quot;ic_dacsan_white_24&quot;, &quot;Danh sách đặc sản&quot;));
                //Danh sách tài khoản người dùng
                arrayListListMenu.add(new ClassMenu(&quot;ic_person_white_24&quot;, &quot;Danh sách tài khoản người dùng&quot;));
<A NAME="217"></A>                //Danh sách địa điểm du lịch
                arrayListListMenu.add(new ClassMenu(&quot;ic_diadiem_white_24&quot;, &quot;Danh sách địa điểm du lịch&quot;));
                //Danh sách điểm du lịch gần nhau
                <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#217',3,'match0-top.html#217',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListListMenu.add(new ClassMenu(&quot;ic_diadiem_white_24&quot;, &quot;Danh sách điểm du lịch gần nhau&quot;));
                break;
        }

        //Đổi mật khẩu
        arrayListListMenu.add(new ClassMenu(&quot;ic_key_white_24&quot;, &quot;Đổi mật khẩu&quot;));
        //Đăng xuất
        arrayListListMenu.add(new ClassMenu(&quot;ic_logout&quot;, &quot;Đăng xuất&quot;));
        adapterListMenu = new ListViewListMenu(getContext());
        listView.setAdapter(adapterListMenu);
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>Menu\ListViewListMenu.java</CENTER></H3><HR>
<PRE>
<A NAME="218"></A><FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#218',3,'match0-top.html#218',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.Menu;

import android.annotation.SuppressLint;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.R;
import java.util.ArrayList;

public class ListViewListMenu extends BaseAdapter {
    private Context mContext;
    private LayoutInflater inflater;
    private ArrayList&lt;ClassMenu&gt; arraylist;
    public ListViewListMenu(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentListMenu.arrayListListMenu);
    }
    public static class ViewHolder {
        ImageView imageMenu;
        TextView textMenu;
    }
    @Override
    public int getCount() {
        return FragmentListMenu.arrayListListMenu.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentListMenu.arrayListListMenu.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint(&quot;InflateParams&quot;)
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_menu, null);
            holder.imageMenu = convertView.findViewById(R.id.imageMenu);
            holder.textMenu = convertView.findViewById(R.id.textMenu);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }
        // Set the results into TextViews
        holder.imageMenu.setImageResource(convertView.getResources().getIdentifier(&quot;@drawable/&quot;+FragmentListMenu.arrayListListMenu.get(position).getStrAnh(),&quot;drawable&quot;,parent.getContext().getPackageName()));
        holder.textMenu.setText(FragmentListMenu.arrayListListMenu.get(position).getStrMenu());
        return convertView;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\ClassDanhSachTaiKhoan.java</CENTER></H3><HR>
<PRE>
<A NAME="93"></A><FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#93',3,'match0-top.html#93',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

public class ClassDanhSachTaiKhoan {

    String strTaiKhoan, strHoTen, strCongTy, strMaTinh, strMaHuyen, strMaXa, strEmail, strDienThoai;
    Integer intLoaiTaiKhoan;
    Boolean booleanTrangThai;

    public ClassDanhSachTaiKhoan(String strTaiKhoan, String strHoTen, String strCongTy, String strMaTinh, String strMaHuyen, String strMaXa, String strEmail, String strDienThoai, Integer intLoaiTaiKhoan, Boolean booleanTrangThai) {
        this.strTaiKhoan = strTaiKhoan;
        this.strHoTen = strHoTen;
        this.strCongTy = strCongTy;
        this.strMaTinh = strMaTinh;
        this.strMaHuyen = strMaHuyen;
        this.strMaXa = strMaXa;
        this.strEmail = strEmail;
        this.strDienThoai = strDienThoai;
        this.intLoaiTaiKhoan = intLoaiTaiKhoan;
        this.booleanTrangThai = booleanTrangThai;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrHoTen() {
        return strHoTen;
    }

    public String getStrCongTy() {
        return strCongTy;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrMaHuyen() {
        return strMaHuyen;
    }

    public String getStrMaXa() {
        return strMaXa;
    }

    public String getStrEmail() {
        return strEmail;
    }

    public String getStrDienThoai() {
        return strDienThoai;
    }

    public Integer getIntLoaiTaiKhoan() {
        return intLoaiTaiKhoan;
    }

    public Boolean getBooleanTrangThai() {
        return booleanTrangThai;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\DangKyActivity.java</CENTER></H3><HR>
<PRE>
<A NAME="94"></A>package com.example.travelling.NguoiDung;

<FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#94',3,'match0-top.html#94',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import androidx.appcompat.app.AppCompatActivity;
import android.annotation.SuppressLint;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.Spinner;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.MainActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class DangKyActivity extends AppCompatActivity {
    //Khai báo
    private EditText editTaiKhoan, editMatKhau, editXacNhanMatKhau, editHoTen, editCongTy, editSoDienThoai, editEmail;
    private TextView textCongTy, textDiaChi;
    private Spinner cmdLoaiTaiKhoan, cmdTinh, cmdHuyen, cmdXa;
    private Button btnDangKy, btnQuayLai;
    private ImageButton btnViewMatKhau, btnViewXacNhan;
<A NAME="95"></A>    private ClassPublic classPublic</B></FONT> = new ClassPublic();
    private ClassConnect classConnect;
    private String strLoaiTaiKhoan, strMaTinh, strMaHuyen, strMaXa;
    private ArrayList&lt;<FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#95',3,'match0-top.html#95',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaLoaiTaiKhoan = new ArrayList&lt;&gt;(); //Khai báo danh sách loại tài khoản
    private ArrayList&lt;String&gt; listTenLoaiTaiKhoan = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    private ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    private ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaXa = new ArrayList&lt;&gt;(); //Khai báo danh sách xã
    private ArrayList&lt;String&gt; listTenXa = new ArrayList&lt;&gt;();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dang_ky);
        layoutAnhXa(); //Ánh xạ các đối tượng Layout
    }

    private void layoutAnhXa() {
        editTaiKhoan = findViewById(R.id.editTaiKhoan);
        editMatKhau = findViewById(R.id.editMatKhau);
        editXacNhanMatKhau = findViewById(R.id.editXacNhanMatKhau);
        cmdLoaiTaiKhoan = findViewById(R.id.cmdLoaiTaiKhoan);
        editHoTen = findViewById(R.id.editHoTen);
        textCongTy = findViewById(R.id.textCongTy);
        editCongTy = findViewById(R.id.editCongTy);
        textDiaChi = findViewById(R.id.textDiaChi);
        cmdTinh = findViewById(R.id.cmdTinh);
        cmdHuyen = findViewById(R.id.cmdHuyen);
        cmdXa = findViewById(R.id.cmdXa);
        editSoDienThoai = findViewById(R.id.editSoDienThoai);
        editEmail = findViewById(R.id.editEmail);
        btnQuayLai = findViewById(R.id.btnQuayLai);
        btnDangKy = findViewById(R.id.btnDangKy);
        btnViewMatKhau = findViewById(R.id.btnViewMatKhau);
        btnViewXacNhan = findViewById</B></FONT>(R.id.btnViewXacNhan);
        loadLoaiTaiKhoan(); //Load danh sách loại tài khoản
        loadTinh(); //Load danh sách tỉnh
        clickButton(); //Click button
<A NAME="96"></A>    }

    private void loadLoaiTaiKhoan() { //Danh sách loại tài khoản
        <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#96',3,'match0-top.html#96',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaLoaiTaiKhoan.clear(); //Xóa danh sách đang có
        listTenLoaiTaiKhoan.clear();
        listMaLoaiTaiKhoan.add(&quot;2&quot;);
        listTenLoaiTaiKhoan.add(&quot;Khách du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;3&quot;);
        listTenLoaiTaiKhoan.add(&quot;Công ty du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;4&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quán ăn/nhà hàng&quot;);
        listMaLoaiTaiKhoan.add(&quot;5&quot;);
        listTenLoaiTaiKhoan.add(&quot;Nhà nghỉ/khách sạn&quot;);
        ArrayAdapter&lt;String&gt; dataLoaiTaiKhoan = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenLoaiTaiKhoan);
        dataLoaiTaiKhoan.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdLoaiTaiKhoan.setAdapter(dataLoaiTaiKhoan);
        cmdLoaiTaiKhoan.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @</B></FONT>SuppressLint(&quot;SetTextI18n&quot;)
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaLoaiTaiKhoan.isEmpty()) {
                    strLoaiTaiKhoan = listMaLoaiTaiKhoan.get(position);
                    String strDiaChi = null;
                    switch (strLoaiTaiKhoan){
                        case &quot;1&quot;:
                        case &quot;2&quot;:
                            strDiaChi = &quot;Địa chỉ thường trú&quot;;
                            textCongTy.setVisibility(View.GONE);
                            editCongTy.setVisibility(View.GONE);
                            break;
                        case &quot;3&quot;:
                            strDiaChi = &quot;Địa chỉ công ty&quot;;
                            textCongTy.setText(&quot;Tên công ty&quot;);
                            editCongTy.setHint(&quot;Nhập tên công ty&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                        case &quot;4&quot;:
                            strDiaChi = &quot;Địa chỉ quán ăn/nhà hàng&quot;;
                            textCongTy.setText(&quot;Tên quán ăn/nhà hàng&quot;);
                            editCongTy.setHint(&quot;Nhập tên quán ăn/nhà hàng&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                        case &quot;5&quot;:
                            strDiaChi = &quot;Địa chỉ nhà nghỉ/khách sạn&quot;;
                            textCongTy.setText(&quot;Tên nhà nghỉ/khách sạn&quot;);
                            editCongTy.setHint(&quot;Nhập tên nhà nghỉ/khách sạn&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                    }
<A NAME="97"></A>                    textDiaChi.setText(strDiaChi);
                }
                else {
                    <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#97',3,'match0-top.html#97',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Đang cập nhật loại tài khoản&quot;);
                }
            }
            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(DangKyActivity.this, sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh</B></FONT>.setAdapter(dataTinh);
            }
<A NAME="98"></A>            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#98',3,'match0-top.html#98',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(DangKyActivity.this).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listMaHuyen.clear(); // Xóa danh sách huyện
            listTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenHuyen);
            dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdHuyen.setAdapter(dataHuyen);
            loadXa(strMaHuyen); //Load danh sách xã
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
                    loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
<A NAME="99"></A>            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+maTinh+&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect</B></FONT>.selectData(DangKyActivity.this, sqlHuyen);
            <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#99',3,'match0-top.html#99',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter</B></FONT>&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenHuyen);
<A NAME="100"></A>                dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
            }
            if (<FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#100',3,'match0-top.html#100',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaHuyen.isEmpty()){
                classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(DangKyActivity.this).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaXa.clear(); // Xóa danh sách xã
            listTenXa.clear();
            ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenXa);
            dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdXa.setAdapter(dataXa);
        }
        cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()) {
                    strMaHuyen = listMaHuyen.get(position);
                    loadXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadXa(String maHuyen){ //Danh sách huyện
        listMaXa.clear(); // Xóa danh sách huyện
        listTenXa.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
            ResultSet resultSetXa = classConnect.selectData(DangKyActivity.this, sqlXa);
            if (resultSetXa != null){
                while (resultSetXa.next()){
                    listMaXa.add(resultSetXa.getString(&quot;MaXa&quot;));
                    listTenXa.add(resultSetXa.getString(&quot;TenXa&quot;));
                }
                ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(this, android.R.layout.simple_spinner_item,listTenXa);
                dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="101"></A>                cmdXa</B></FONT>.setAdapter(dataXa);
            }
            if (listMaXa.isEmpty()){
                <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#101',3,'match0-top.html#101',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
            }
            classConnect.CONN(DangKyActivity.this).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdXa.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaXa.isEmpty()) {
                    strMaXa = listMaXa.get(position);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void clickButton() {
        btnDangKy</B></FONT>.setOnClickListener(new View.OnClickListener() {
<A NAME="102"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
<A NAME="103"></A>                String strPass = <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#102',3,'match0-top.html#102',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editMatKhau.getText().toString();
                if (editTaiKhoan.getText().length() != 0){
                    if (editMatKhau.getText().length() &gt;= 8){
                        if (<FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#103',3,'match0-top.html#103',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editXacNhanMatKhau</B></FONT>.getText().toString().equals(strPass)) {
                            if (!listMaLoaiTaiKhoan.isEmpty()) {
                                if (editHoTen.getText().length() != 0) {
<A NAME="104"></A>                                    if (!listMaTinh.isEmpty()) { //Kiểm tra tỉnh rỗng
                                        if (!listMaHuyen.isEmpty()) { //Kiểm tra huyện rỗng
                                            if (!listMaXa.isEmpty()) { //Kiểm tra xã rỗng
                                                if</B></FONT> (<FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#104',3,'match0-top.html#104',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editSoDienThoai.getText().length() != 0) {
                                                    try {
                                                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                                                        String sqlKiemTra = &quot;select TaiKhoan from TB_NguoiDung where TaiKhoan = '&quot; + editTaiKhoan.getText() + &quot;'&quot;;
                                                        ResultSet resultSet = classConnect.selectData(DangKyActivity.this, sqlKiemTra);
                                                        if (resultSet != null &amp;&amp; resultSet.next()) {
                                                            classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Tài khoản này đã tồn tại&quot;);
                                                        } else {
                                                            String sqlTaiKhoan = null;
                                                            switch (strLoaiTaiKhoan){
<A NAME="105"></A>                                                                case &quot;1&quot;:</B></FONT>
                                                                case &quot;2&quot;:
                                                                    sqlTaiKhoan = &quot;insert into TB_NguoiDung(TaiKhoan, MatKhau, LoaiTaiKhoan, HoTen, MaTinh, MaHuyen, MaXa, Email, SoDienThoai) &quot; +
                                                                            &quot;values('&quot; + editTaiKhoan.getText() + &quot;', '&quot; + editMatKhau.getText() + &quot;', '&quot; + strLoaiTaiKhoan + &quot;', N'&quot; + <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#105',3,'match0-top.html#105',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editHoTen.getText() + &quot;',&quot; +
                                                                            &quot; '&quot;+ strMaTinh +&quot;', '&quot;+ strMaHuyen +&quot;', '&quot;+ strMaXa +&quot;','&quot; + editEmail.getText() + &quot;', '&quot; + editSoDienThoai.getText() + &quot;')&quot;;
                                                                    break;
                                                                case &quot;3&quot;:
                                                                    sqlTaiKhoan = &quot;insert into TB_NguoiDung(TaiKhoan, MatKhau, LoaiTaiKhoan, HoTen, CongTy, MaTinh, MaHuyen, MaXa, Email, SoDienThoai) &quot; +
<A NAME="106"></A>                                                                            &quot;values('&quot; + editTaiKhoan.getText() + &quot;', '&quot; + editMatKhau.getText() + &quot;', '&quot; + strLoaiTaiKhoan + &quot;', N'&quot; + editHoTen.getText() + &quot;',&quot; +
                                                                            &quot; N'&quot; + editCongTy.getText() + &quot;', '&quot;+ strMaTinh +&quot;', '&quot;+ strMaHuyen +&quot;', '&quot;+ strMaXa +&quot;', '&quot; + editEmail</B></FONT>.getText() + &quot;', '&quot; + editSoDienThoai.getText() + &quot;')&quot;;
                                                                    break;
                                                                case &quot;4&quot;<FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#106',3,'match0-top.html#106',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>:
                                                                case &quot;5&quot;:
                                                                    sqlTaiKhoan = &quot;insert into TB_NguoiDung(TaiKhoan, MatKhau, LoaiTaiKhoan, HoTen, CongTy, MaTinh, MaHuyen, MaXa, Email, SoDienThoai) &quot; +
                                                                            &quot;values('&quot; + editTaiKhoan.getText() + &quot;', '&quot; + editMatKhau.getText() + &quot;', '&quot; + strLoaiTaiKhoan + &quot;', N'&quot; + editHoTen.getText() + &quot;',&quot; +
                                                                            &quot; N'&quot; + editCongTy.getText() + &quot;', '&quot;+ strMaTinh +&quot;', '&quot;+ strMaHuyen +&quot;', '&quot;+ strMaXa +&quot;', '&quot; + editEmail.getText() + &quot;', '&quot; + editSoDienThoai.getText() + &quot;')&quot;;
                                                                    break</B></FONT>;
                                                            }
<A NAME="107"></A>                                                            if (classConnect.updateData(DangKyActivity.this, sqlTaiKhoan) == 1) {
                                                                classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Đăng ký thành công. Vui lòng đăng nhập để sử dụng phần mềm&quot;);
                                                                startActivity(new Intent(DangKyActivity.this, MainActivity.class)); //Quay lại trang đăng nhập//Quay lại trang đăng nhập
                                                            } <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#107',3,'match0-top.html#107',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                                                                classPublic.ThongBao(DangKyActivity.this, &quot;Lỗi! Đăng ký không thành công&quot;);
                                                            }
                                                        }
                                                        classConnect.CONN(DangKyActivity.this).close(); //Đóng kết nối đến SQL
                                                    } catch (Exception e) {
                                                        Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                                                    }
                                                }
                                                else {
                                                    classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng nhập số điện thoại hoặc Số điện thoại không đúng&quot;);
                                                }
                                            }
                                            else {
                                                classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng chọn phường/xã&quot;);
                                            }
                                        }
                                        else {
                                            classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng chọn quận/huyện&quot;);
                                        }
                                    }
                                    else {
                                        classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng chọn tỉnh/thành phố&quot;);
                                    }
                                }
                                else {
                                        classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng nhập họ và tên&quot;);
                                }
                            }
                            else {
                                classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng chọn loại tài khoản&quot;);
                            }
                        }
                        else {
                            classPublic.ThongBao(DangKyActivity.this,&quot;Thông báo! Mật khẩu và mật khẩu xác nhận phải giống nhau.&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Mật khẩu ít nhất 8 kí tự&quot;);
                    }
                }
                else {
                    classPublic.ThongBao(DangKyActivity.this, &quot;Thông báo! Vui lòng nhập tài khoản&quot;);
                }</B></FONT>
            }
        });
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                finish();
                startActivity(new Intent(DangKyActivity.this, MainActivity.class)); //Quay lại trang đăng nhập
            }
        });
        btnViewMatKhau.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                editMatKhau.setInputType(1); //Hiển thị mật khẩu
            }
        });
        btnViewXacNhan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                editXacNhanMatKhau.setInputType(1); //Hiển thị mật khẩu
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>NguoiDung\DanhSachTaiKhoanEditFragment.java</CENTER></H3><HR>
<PRE>
package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
import android.content.Context;
<A NAME="108"></A>import android.content.SharedPreferences;
import android.os.Bundle;

<FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#108',3,'match0-top.html#108',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.TextView;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class DanhSachTaiKhoanEditFragment extends Fragment {

    private static final String ARG_TaiKhoan</B></FONT> = &quot;Taikhoan&quot;;
    private static final String ARG_LoaiTaiKhoan = &quot;LoaiTaikhoan&quot;;
    private static final String ARG_HoTen = &quot;HoTen&quot;;
    private static final String ARG_CongTy = &quot;CongTy&quot;;
    private static final String ARG_MaTinh = &quot;MaTinh&quot;;
    private static final String ARG_MaHuyen = &quot;MaHuyen&quot;;
<A NAME="109"></A>    private static final String ARG_MaXa = &quot;MaXa&quot;;
    private static final String ARG_Email = &quot;Email&quot;;
    private static final String ARG_DienThoai = &quot;DienThoai&quot;;
    private String <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#109',3,'match0-top.html#109',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mTaiKhoan, mHoTen, mCongTy, mMaTinh, mMaHuyen, mMaXa, mEmail, mDienThoai;
    private Integer mLoaiTaiKhoan;
    //Phần khai báo
<A NAME="110"></A>    FragmentManager fragmentManager;
    FragmentTransaction fragmentTransaction;
    ClassPublic classPublic = new ClassPublic</B></FONT>();
    ClassConnect <FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#110',3,'match0-top.html#110',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;
    View view;
    TextView textCongTy, textDiaChi;
    EditText editTaiKhoan, editHoTen, editCongTy, editEmail, editDienThoai;
    Spinner cmdLoaiTaiKhoan, cmdTinh, cmdHuyen, cmdXa;
    Button btnBack, btnSave;
    ArrayList&lt;String&gt; listMaLoaiTaiKhoan = new ArrayList&lt;&gt;(); //Khai báo danh sách loại tài khoản
    ArrayList&lt;String&gt; listTenLoaiTaiKhoan = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaXa = new ArrayList&lt;&gt;(); //Khai báo danh sách xã
    ArrayList&lt;String&gt; listTenXa = new ArrayList</B></FONT>&lt;&gt;();
    String strLoaiTaiKhoan, strMaTinh, strMaHuyen, strMaXa, quyenLoaiTaiKhoan, quyenMaTinh;
    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;

    public DanhSachTaiKhoanEditFragment() {

    }
<A NAME="111"></A>
    public static DanhSachTaiKhoanEditFragment newInstance(String taiKhoan, Integer loaiTaiKhoan, String hoTen, String congTy, String maTinh, String maHuyen, String maXa, String email, String dienThoai) {
        DanhSachTaiKhoanEditFragment fragment = new DanhSachTaiKhoanEditFragment();
        Bundle <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#111',3,'match0-top.html#111',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>args = new Bundle();
        args.putString(ARG_TaiKhoan, taiKhoan);
        args.putInt(ARG_LoaiTaiKhoan, loaiTaiKhoan);
        args.putString(ARG_HoTen, hoTen);
        args.putString(ARG_CongTy, congTy);
        args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_MaHuyen, maHuyen);
        args.putString(ARG_MaXa, maXa);
        args.putString(ARG_Email, email);
        args.putString(ARG_DienThoai, dienThoai);
        fragment</B></FONT>.setArguments(args);
        return fragment;
    }

<A NAME="112"></A>    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (<FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#112',3,'match0-top.html#112',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments() != null) {
            mTaiKhoan = getArguments().getString(ARG_TaiKhoan);
<A NAME="113"></A>            mLoaiTaiKhoan = getArguments().getInt(ARG_LoaiTaiKhoan);
            mHoTen = getArguments().getString(ARG_HoTen);
            mCongTy = getArguments</B></FONT>().getString(ARG_CongTy);
            mMaTinh = <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#113',3,'match0-top.html#113',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments().getString(ARG_MaTinh);
            mMaHuyen = getArguments().getString(ARG_MaHuyen);
            mMaXa = getArguments().getString(ARG_MaXa);
            mEmail = getArguments().getString(ARG_Email);
            mDienThoai = getArguments</B></FONT>().getString(ARG_DienThoai);
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_danh_sach_tai_khoan_edit, container, false);
<A NAME="114"></A>        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#114',3,'match0-top.html#114',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editor.apply();
        loadPhanQuyen(sharedpreferences.getString(User,&quot;&quot;));
        layoutAnhXa();
        return view;
    }

    private void loadPhanQuyen(String mTaiKhoan) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sql = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+mTaiKhoan+&quot;'&quot;;
            ResultSet resultSet = classConnect.selectData(getActivity</B></FONT>(), sql);
            while (resultSet != null &amp;&amp; resultSet.next()){
                quyenLoaiTaiKhoan = resultSet.getString(&quot;LoaiTaiKhoan&quot;);
                quyenMaTinh = resultSet.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e) {
            Log.d(&quot;TAG&quot;, e.getMessage());
<A NAME="115"></A>        }
    }

    private <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#115',3,'match0-top.html#115',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        editTaiKhoan = view.findViewById(R.id.editTaiKhoan);
        cmdLoaiTaiKhoan = view.findViewById(R.id.cmdLoaiTaiKhoan);
        editHoTen = view.findViewById(R.id.editHoTen);
        textCongTy = view.findViewById(R.id.textCongTy);
        editCongTy = view.findViewById(R.id.editCongTy);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        cmdXa = view.findViewById(R.id.cmdXa);
        editEmail = view.findViewById(R.id.editEmail);
        editDienThoai = view.findViewById(R.id.editSoDienThoai);
        btnBack = view.findViewById(R.id.btnBack);
        btnSave = view.findViewById(R.id.btnSave);
<A NAME="116"></A>        loadLoaiTaiKhoan(); //Load danh sách loại tài khoản
        loadTinh();
        clickButton</B></FONT>();
        if (<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#116',3,'match0-top.html#116',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mTaiKhoan.equals(&quot;&quot;)){
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
            fragmentTransaction.commit();
        }
        else {
            editTaiKhoan.setText(mTaiKhoan);
            editTaiKhoan</B></FONT>.setEnabled(false);
            editHoTen.setText(mHoTen);
            editCongTy.setText(mCongTy);
            editEmail.setText(mEmail);
            editDienThoai.setText(mDienThoai);
        }
    }

    private void loadLoaiTaiKhoan() {
        listMaLoaiTaiKhoan.clear(); //Xóa danh sách đang có
<A NAME="117"></A>        listTenLoaiTaiKhoan.clear();
        listMaLoaiTaiKhoan.add(&quot;2&quot;);
        listTenLoaiTaiKhoan.add(&quot;Khách du lịch&quot;);
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#117',3,'match0-top.html#117',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaLoaiTaiKhoan.add(&quot;3&quot;);
        listTenLoaiTaiKhoan.add(&quot;Công ty du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;4&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quán ăn/nhà hàng&quot;);
        listMaLoaiTaiKhoan.add(&quot;5&quot;);
        listTenLoaiTaiKhoan.add(&quot;Nhà nghỉ/khách sạn&quot;);
        ArrayAdapter&lt;String&gt; dataLoaiTaiKhoan = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenLoaiTaiKhoan);
        dataLoaiTaiKhoan.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdLoaiTaiKhoan.setAdapter(dataLoaiTaiKhoan);
        cmdLoaiTaiKhoan.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @</B></FONT>SuppressLint(&quot;SetTextI18n&quot;)
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaLoaiTaiKhoan.isEmpty()) {
                    if (mLoaiTaiKhoan != 0){
                        cmdLoaiTaiKhoan.setSelection(listMaLoaiTaiKhoan.indexOf(mLoaiTaiKhoan.toString()));
                        mLoaiTaiKhoan = 0;
                    }
                    strLoaiTaiKhoan = listMaLoaiTaiKhoan.get(position);
                    String strDiaChi = null;
                    switch (strLoaiTaiKhoan){
                        case &quot;1&quot;:
                        case &quot;2&quot;:
                            strDiaChi = &quot;Địa chỉ thường trú&quot;;
                            textCongTy.setVisibility(View.GONE);
                            editCongTy.setVisibility(View.GONE);
                            break;
                        case &quot;3&quot;:
                            strDiaChi = &quot;Địa chỉ công ty&quot;;
                            textCongTy.setText(&quot;Tên công ty&quot;);
                            editCongTy.setHint(&quot;Nhập tên công ty&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                        case &quot;4&quot;:
                            strDiaChi = &quot;Địa chỉ quán ăn/nhà hàng&quot;;
                            textCongTy.setText(&quot;Tên quán ăn/nhà hàng&quot;);
                            editCongTy.setHint(&quot;Nhập tên quán ăn/nhà hàng&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                        case &quot;5&quot;:
                            strDiaChi = &quot;Địa chỉ nhà nghỉ/khách sạn&quot;;
                            textCongTy.setText(&quot;Tên nhà nghỉ/khách sạn&quot;);
                            editCongTy.setHint(&quot;Nhập tên nhà nghỉ/khách sạn&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            break;
                    }
<A NAME="118"></A>                    textDiaChi.setText(strDiaChi);
                }
                else {
                    classPublic.ThongBao(<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#118',3,'match0-top.html#118',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật loại tài khoản&quot;);
                }
            }
            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listMaHuyen.clear(); // Xóa danh sách huyện
            listTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenHuyen);
<A NAME="119"></A>            dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdHuyen</B></FONT>.setAdapter(dataHuyen);
            loadXa(strMaHuyen); //Load danh sách xã
        <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#119',3,'match0-top.html#119',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (quyenLoaiTaiKhoan.equals(&quot;6&quot;) &amp;&amp; !quyenMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        cmdTinh.setEnabled(false);
                    }
                    else if (!mMaTinh.equals(&quot;&quot;)){
<A NAME="120"></A>                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        mMaTinh = &quot;&quot;;
                    }
                    <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#120',3,'match0-top.html#120',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh = listMaTinh.get(position);
                    loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+maTinh+&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaXa.clear(); // Xóa danh sách xã
            listTenXa.clear();
            ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenXa);
            dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdXa.setAdapter(dataXa);
        }
        cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen</B></FONT>.isEmpty()) {
                    if (!mMaHuyen.equals(&quot;&quot;)){
                        cmdHuyen.setSelection(listMaHuyen.indexOf(mMaHuyen));
<A NAME="121"></A>                        mMaHuyen = &quot;&quot;;
                    }
                    strMaHuyen = listMaHuyen.get(position);
                    <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#121',3,'match0-top.html#121',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadXa(String maHuyen){ //Danh sách huyện
        listMaXa.clear(); // Xóa danh sách huyện
        listTenXa.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
            ResultSet resultSetXa = classConnect.selectData(getActivity(), sqlXa);
            if (resultSetXa != null){
                while (resultSetXa.next()){
                    listMaXa.add(resultSetXa.getString(&quot;MaXa&quot;));
                    listTenXa.add(resultSetXa.getString(&quot;TenXa&quot;));
                }
                ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenXa);
                dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdXa.setAdapter(dataXa);
            }
            if (listMaXa.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdXa.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaXa</B></FONT>.isEmpty()) {
                    if (!mMaXa.equals(&quot;&quot;)){
                        cmdXa.setSelection(listMaXa.indexOf(mMaXa));
                        mMaXa = &quot;&quot;;
<A NAME="122"></A>                    }
                    strMaXa = listMaXa.get(position);
                }
            <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#122',3,'match0-top.html#122',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void clickButton() {
        btnBack.setOnClickListener(view -&gt; {
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
            fragmentTransaction.commit();
        });

        btnSave</B></FONT>.setOnClickListener(view -&gt; {
            try {
                if (editTaiKhoan.getText().length() == 0){
                    editTaiKhoan.setError(&quot;Thông báo! Chưa nhập tài khoản&quot;);
                    editTaiKhoan.requestFocus();
                    return;
                }
                if (editHoTen.getText().length() == 0){
                    editHoTen.setError(&quot;Thông báo! Chưa nhập họ tên&quot;);
                    editHoTen.requestFocus();
<A NAME="123"></A>                    return;
                }
                classConnect = new ClassConnect(); //Mở kết nối đến SQL
                String <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#123',3,'match0-top.html#123',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sql = &quot;update TB_NguoiDung set LoaiTaiKhoan = '&quot;+Integer.valueOf(strLoaiTaiKhoan)+&quot;', HoTen = N'&quot;+editHoTen.getText().toString()+&quot;', CongTy = N'&quot;+editCongTy.getText().toString()+&quot;', MaTinh = '&quot;+strMaTinh+&quot;', MaHuyen = '&quot;+strMaHuyen+&quot;', MaXa = '&quot;+strMaXa+&quot;', Email = '&quot;+editEmail.getText().toString()+&quot;', SoDienThoai = '&quot;+editDienThoai.getText().toString()+&quot;' where TaiKhoan = '&quot;+editTaiKhoan</B></FONT>.getText().toString()+&quot;'&quot;;
                if (classConnect.updateData(getActivity(), sql) == 1){
                    if (mTaiKhoan.equals(&quot;&quot;)){
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Thêm mới thành công&quot;);
                    }
                    else {
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Cập nhật thành công&quot;);
                    }
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
                    fragmentTransaction.commit();
<A NAME="124"></A>                }
                else {
                    if (mTaiKhoan.equals(&quot;&quot;)){
                        classPublic.ThongBao(<FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#124',3,'match0-top.html#124',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Không thêm mới được&quot;);
                    }
                    else {
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Không cập nhật được&quot;);
                    }
                }
                classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
            }catch (Exception e){
                Log.d(&quot;TAG&quot;,e</B></FONT>.getMessage());
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>NguoiDung\FragmentDanhSachTaiKhoan.java</CENTER></H3><HR>
<PRE>
<A NAME="125"></A><FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#125',3,'match0-top.html#125',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

<A NAME="126"></A>public class</B></FONT> FragmentDanhSachTaiKhoan extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#126',3,'match0-top.html#126',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>view;
    SearchView searchView;
    Spinner cmdTinh, cmdLoaiTaiKhoan, cmdTrangThai;
    ListView listView;
    public static ArrayList&lt;ClassDanhSachTaiKhoan&gt; arrayListDanhSachTaiKhoan;
    ListViewDanhSachTaiKhoan adapterDanhSachTaiKhoan;
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaLoaiTaiKhoan = new ArrayList&lt;&gt;(); //Khai báo danh sách loại tài khoản
    ArrayList&lt;String&gt; listTenLoaiTaiKhoan = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaTrangThai = new ArrayList&lt;&gt;(); //Khai báo danh sách trạng thái
    ArrayList&lt;String&gt; listTenTrangThai = new ArrayList&lt;&gt;();
    String strMaTinh, strMaTrangThai</B></FONT>;
    ClassConnect classConnect;
<A NAME="127"></A>    ClassPublic classPublic = new ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    SharedPreferences <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#127',3,'match0-top.html#127',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;
    String mTaiKhoan, mLoaiTaiKhoan, mMaTinh, strLoaiTaiKhoan;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_danhsachtaikhoan, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        mTaiKhoan = sharedpreferences</B></FONT>.getString(User,&quot;&quot;);
<A NAME="128"></A>        loadPhanQuyen(mTaiKhoan);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#128',3,'match0-top.html#128',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void loadPhanQuyen(String mTaiKhoan) {
        try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sql = &quot;select LoaiTaiKhoan, MaTinh from TB_NguoiDung where TaiKhoan = '&quot;+mTaiKhoan+&quot;'&quot;;
            ResultSet resultSet = classConnect.selectData(getActivity</B></FONT>(), sql);
            while (resultSet != null &amp;&amp; resultSet.next()){
                mLoaiTaiKhoan = resultSet.getString(&quot;LoaiTaiKhoan&quot;);
<A NAME="129"></A>                mMaTinh = resultSet.getString(&quot;MaTinh&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }<FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#129',3,'match0-top.html#129',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>catch (Exception e) {
            Log.d(&quot;TAG&quot;, e.getMessage());
        }
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void layoutAnhXa() {
        listView = view.findViewById(R.id.listView);
        searchView = view.findViewById(R.id.searchTen);
        cmdTinh = view.findViewById(R.id.cmdTinh);
<A NAME="130"></A>        cmdLoaiTaiKhoan = view.findViewById(R.id.cmdLoaiTaiKhoan);
        cmdTrangThai = view.findViewById(R.id.cmdTrangThai);
        loadTinh</B></FONT>(); //Load tên tỉnh
    <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#130',3,'match0-top.html#130',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="131"></A>                cmdTinh.setAdapter(dataTinh);
            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(<FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#131',3,'match0-top.html#131',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (mLoaiTaiKhoan.equals(&quot;6&quot;) &amp;&amp; !mMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        cmdTinh.setEnabled(false);
                    }
<A NAME="132"></A>                    strMaTinh = listMaTinh.get(position);
                    loadLoaiTaiKhoan();
                }
            <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#132',3,'match0-top.html#132',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void loadLoaiTaiKhoan() {
        listMaLoaiTaiKhoan.clear(); //Xóa danh sách đang có
<A NAME="133"></A>        listTenLoaiTaiKhoan.clear();
        listMaLoaiTaiKhoan</B></FONT>.add(&quot;2&quot;);
        listTenLoaiTaiKhoan.add(&quot;Khách du lịch&quot;);
        <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#133',3,'match0-top.html#133',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaLoaiTaiKhoan.add(&quot;3&quot;);
        listTenLoaiTaiKhoan.add(&quot;Công ty du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;4&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quán ăn/nhà hàng&quot;);
        listMaLoaiTaiKhoan.add(&quot;5&quot;);
        listTenLoaiTaiKhoan.add(&quot;Nhà nghỉ/khách sạn&quot;);
        ArrayAdapter&lt;String&gt; dataLoaiTaiKhoan = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenLoaiTaiKhoan);
        dataLoaiTaiKhoan.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdLoaiTaiKhoan.setAdapter(dataLoaiTaiKhoan);
        cmdLoaiTaiKhoan.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @</B></FONT>SuppressLint(&quot;SetTextI18n&quot;)
            @Override
<A NAME="134"></A>            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaLoaiTaiKhoan.isEmpty()) {
                    strLoaiTaiKhoan = listMaLoaiTaiKhoan.get(position);
                    <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#134',3,'match0-top.html#134',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadTrangThai();
                }
            }
            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTrangThai(){
        listMaTrangThai.clear(); // Xóa danh sách trạng thái
        listTenTrangThai.clear();
        listMaTrangThai.add(&quot;1&quot;);
        listTenTrangThai.add(&quot;Hoạt động&quot;);
        listMaTrangThai.add(&quot;0&quot;);
        listTenTrangThai.add(&quot;Bị khóa&quot;);
<A NAME="135"></A>        ArrayAdapter&lt;String&gt; dataTrangThai = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTrangThai);
        dataTrangThai.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdTrangThai</B></FONT>.setAdapter(dataTrangThai);
        <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#135',3,'match0-top.html#135',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTrangThai.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTrangThai.isEmpty()) {
<A NAME="136"></A>                    strMaTrangThai = listMaTrangThai</B></FONT>.get(position);
                    loadDanhSachTaiKhoan(strMaTinh, Integer.parseInt(strLoaiTaiKhoan), Integer.parseInt(strMaTrangThai)); //Load danh sách tai khoản
                }
            <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#136',3,'match0-top.html#136',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="137"></A>    private void</B></FONT> loadDanhSachTaiKhoan(String maTinh, Integer loaiTaiKhoan, Integer trangThai){
        arrayListDanhSachTaiKhoan = new ArrayList&lt;&gt;();
        arrayListDanhSachTaiKhoan.clear();
        <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#137',3,'match0-top.html#137',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDanhSachTaiKhoan = &quot;select * from TB_NguoiDung where HienThi = 1 and MaTinh = '&quot;+maTinh+&quot;' and LoaiTaiKhoan = '&quot;+loaiTaiKhoan+&quot;' and TrangThai = '&quot;+trangThai+&quot;' and MaTinh is not null&quot;;
            ResultSet resultSetDanhSachTaiKhoan = classConnect.selectData(getActivity(), sqlDanhSachTaiKhoan);
            if (resultSetDanhSachTaiKhoan != null){
                while (resultSetDanhSachTaiKhoan.next()){
                    arrayListDanhSachTaiKhoan.add(new ClassDanhSachTaiKhoan(resultSetDanhSachTaiKhoan.getString(&quot;TaiKhoan&quot;),
                            resultSetDanhSachTaiKhoan.getString(&quot;HoTen&quot;), resultSetDanhSachTaiKhoan.getString(&quot;CongTy&quot;), resultSetDanhSachTaiKhoan.getString(&quot;MaTinh&quot;),
                            resultSetDanhSachTaiKhoan.getString(&quot;MaHuyen&quot;), resultSetDanhSachTaiKhoan.getString(&quot;MaXa&quot;), resultSetDanhSachTaiKhoan.getString(&quot;Email&quot;),
                            resultSetDanhSachTaiKhoan.getString(&quot;SoDienThoai&quot;), resultSetDanhSachTaiKhoan.getInt(&quot;LoaiTaiKhoan&quot;), resultSetDanhSachTaiKhoan.getBoolean(&quot;TrangThai&quot;)));
                }
            }
            else {
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Chưa cập nhật danh sách tài khoản&quot;);
<A NAME="138"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(<FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#138',3,'match0-top.html#138',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e.getMessage()));
        }
        adapterDanhSachTaiKhoan = new ListViewDanhSachTaiKhoan(getContext());
        listView.setAdapter(adapterDanhSachTaiKhoan);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }
    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên tỉnh
        adapterDanhSachTaiKhoan.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\FragmentDoiMatKhau.java</CENTER></H3><HR>
<PRE>
<A NAME="139"></A>package com.example.travelling.NguoiDung;

<FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#139',3,'match0-top.html#139',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.MainActivity;
import com.example.travelling.Menu.FragmentListMenu;
import com.example.travelling.R;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.Pass;
import static com.example.travelling.MainActivity.User;

public class FragmentDoiMatKhau extends Fragment {
    //Khai báo
    private View view;
    private EditText editMatKhauCu, editMatKhauMoi, editXacNhanMatKhau;
    private ImageButton btnMatKhauCu, btnMatKhauMoi, btnXacNhanMatKhau;
    private Button btnQuayLai, btnThayDoi;
    private ClassPublic classPublic = new ClassPublic();
    private ClassConnect classConnect;
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="140"></A>    private SharedPreferences.Editor editor;
    private FragmentManager fragmentManager; //Tạo Fragment
    private FragmentTransaction fragmentTransaction</B></FONT>;
    private String strTaiKhoan, <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#140',3,'match0-top.html#140',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMatKhau;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_doimatkhau, container, false);
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(getActivity</B></FONT>()).getSupportFragmentManager();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        strMatKhau = sharedpreferences.getString(Pass,&quot;&quot;);
<A NAME="141"></A>        layoutAnhXa(); //Ánh xạ các đối tượng Layout
        return view;
    }
    private <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#141',3,'match0-top.html#141',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        editMatKhauCu = view.findViewById(R.id.editMatKhauCu);
        editMatKhauMoi = view.findViewById(R.id.editMatKhauMoi);
        editXacNhanMatKhau = view.findViewById(R.id.editXacNhanMatKhau);
        btnMatKhauCu = view.findViewById(R.id.btnMatKhauCu);
        btnMatKhauMoi = view.findViewById(R.id.btnMatKhauMoi);
        btnXacNhanMatKhau = view.findViewById(R.id.btnXacNhanMatKhau);
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnThayDoi = view.findViewById(R.id.btnThayDoi);
        clickButton(); //Click button
    }
    private void clickButton(){
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) { //Quay lại trang chủ
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentListMenu());
                fragmentTransaction.commit();
            }
        });
        btnThayDoi.setOnClickListener(new View.OnClickListener() {
<A NAME="142"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                String strPass = <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#142',3,'match0-top.html#142',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editMatKhauCu.getText().toString();
                if (strPass.length() &gt;= 8 &amp;&amp; strMatKhau.equals(strPass)){
                    if (editMatKhauMoi.getText().toString().length() &gt;= 8){
<A NAME="143"></A>                        if (editMatKhauMoi</B></FONT>.getText().toString().equals(editXacNhanMatKhau.getText().toString())){
                            try {
                                String strUser = sharedpreferences.getString(User,&quot;&quot;);
                                <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#143',3,'match0-top.html#143',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect = new ClassConnect(); //Mở kết nối đến SQL
                                String sqlDoiMatKhau = &quot;UPDATE TB_NguoiDung SET MatKhau = '&quot; + editMatKhauMoi.getText() + &quot;' WHERE TaiKhoan = '&quot; + strTaiKhoan + &quot;'&quot;;
                                if (classConnect.updateData(getActivity(), sqlDoiMatKhau) == 1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Đổi mật khẩu thành công.&quot;);
                                    editor.clear(); //Xóa tài khoản đã nhớ
<A NAME="144"></A>                                    editor.commit();
                                    startActivity(new Intent</B></FONT>(getActivity(), MainActivity.class));
                                }
                                <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#144',3,'match0-top.html#144',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                                    classPublic.ThongBao(getActivity(),&quot;LỖI! Không đổi được mật khẩu.&quot;);
                                }
                                classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                            }catch (Exception e){
<A NAME="145"></A>                                Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                            }
                        }
                        <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#145',3,'match0-top.html#145',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Mật khẩu mới và mật khẩu xác nhận phải giống nhau.&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Mật khẩu mới ít nhất 8 kí tự.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Mật khẩu cũ ít nhất 8 kí tự hoặc mật khẩu cũ không đúng.&quot;);
                }</B></FONT>
            }
        });
        btnMatKhauCu.setOnClickListener(new View.OnClickListener() { //Click ImageButton hiển mật khẩu cũ
            @Override
            public void onClick(View v) {
                editMatKhauCu.setInputType(1); //Hiện mật khẩu
            }
        });
        btnMatKhauMoi.setOnClickListener(new View.OnClickListener() { //Click ImageButton hiển mật khẩu mới
            @Override
            public void onClick(View v) {
                editMatKhauMoi.setInputType(1); //Hiện mật khẩu
            }
        });
        btnXacNhanMatKhau.setOnClickListener(new View.OnClickListener() { //Click ImageButton hiển xác nhận mật khẩu
            @Override
            public void onClick(View v) {
                editXacNhanMatKhau.setInputType(1); //Hiện mật khẩu
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>NguoiDung\FragmentTaiKhoan.java</CENTER></H3><HR>
<PRE>
<A NAME="146"></A>package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
<FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#146',3,'match0-top.html#146',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.FragmentHome;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentTaiKhoan extends Fragment {
    //Khai báo
    private View view;
    private EditText editTaiKhoan, editHoTen, editCongTy, editSoDienThoai, editEmail, editKinhDo, editViDo;
    private TextView textCongTy, textDiaChi;
    private Spinner cmdLoaiTaiKhoan, cmdTinh, cmdHuyen, cmdXa;
    private LinearLayout layoutViTri;
<A NAME="147"></A>    private Button btnQuayLai, btnThayDoi;
    private ClassPublic classPublic</B></FONT> = new ClassPublic();
    private ClassConnect classConnect;
    private String strTaiKhoan, strLoaiTaiKhoan, <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#147',3,'match0-top.html#147',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh, strMaHuyen, strMaXa, ganMaTinh, ganMaHuyen, ganMaXa;
    private ArrayList&lt;String&gt; listMaLoaiTaiKhoan = new ArrayList&lt;&gt;(); //Khai báo danh sách loại tài khoản
    private ArrayList&lt;String&gt; listTenLoaiTaiKhoan = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    private ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    private ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    private ArrayList&lt;String&gt; listMaXa = new ArrayList&lt;&gt;(); //Khai báo danh sách xã
    private ArrayList&lt;String&gt; listTenXa = new ArrayList&lt;&gt;();
    private SharedPreferences sharedpreferences; //Nhớ tài khoản
<A NAME="148"></A>    private SharedPreferences.Editor editor;
    private FragmentManager fragmentManager; //Tạo Fragment
    private FragmentTransaction fragmentTransaction</B></FONT>;
    <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#148',3,'match0-top.html#148',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_taikhoan, container, false);
<A NAME="149"></A>        sharedpreferences = Objects</B></FONT>.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#149',3,'match0-top.html#149',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        strTaiKhoan = sharedpreferences.getString(User,&quot;&quot;);
        strLoaiTaiKhoan = classPublic.layLoaiTaiKhoan(strTaiKhoan, getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng Layout
        return view;
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void layoutAnhXa() {
        editTaiKhoan = view.findViewById(R.id.editTaiKhoan);
        cmdLoaiTaiKhoan = view.findViewById(R.id.cmdLoaiTaiKhoan);
        editHoTen = view.findViewById(R.id.editHoTen);
        textCongTy = view.findViewById(R.id.textCongTy);
        editCongTy = view.findViewById(R.id.editCongTy);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        cmdXa = view.findViewById(R.id.cmdXa);
        editSoDienThoai = view.findViewById(R.id.editSoDienThoai);
        editEmail = view.findViewById(R.id.editEmail);
        layoutViTri = view.findViewById(R.id.layoutViTri);
        editKinhDo = view.findViewById(R.id.editKinhDo);
        editViDo = view.findViewById(R.id.editViDo);
        btnQuayLai = view</B></FONT>.findViewById(R.id.btnQuayLai);
        btnThayDoi = view.findViewById(R.id.btnThayDoi);
        ganDuLieu(); //Gán dữ liệu cho các đối tượng
        loadLoaiTaiKhoan(); //Load danh sách loại tài khoản
        loadTinh(); //Load danh sách tỉnh, huyện, xã
        clickButton(); //Click button
<A NAME="150"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#150',3,'match0-top.html#150',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void ganDuLieu() {
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTaiKhoan = &quot;select * from TB_NguoiDung where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
            ResultSet resultSetTaiKhoan = classConnect.selectData(getActivity(), sqlTaiKhoan);
            if (resultSetTaiKhoan != null &amp;&amp; resultSetTaiKhoan.next()){
                editTaiKhoan.setText(resultSetTaiKhoan.getString(&quot;TaiKhoan&quot;));
                editHoTen.setText(resultSetTaiKhoan</B></FONT>.getString(&quot;HoTen&quot;));
<A NAME="151"></A>                if (strLoaiTaiKhoan.equals(&quot;3&quot;) || strLoaiTaiKhoan.equals(&quot;4&quot;) || strLoaiTaiKhoan.equals(&quot;5&quot;)){
                    editCongTy.setText(resultSetTaiKhoan.getString(&quot;CongTy&quot;));
                }
                <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#151',3,'match0-top.html#151',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaTinh = resultSetTaiKhoan.getString(&quot;MaTinh&quot;);
<A NAME="152"></A>                ganMaHuyen = resultSetTaiKhoan.getString(&quot;MaHuyen&quot;);
                ganMaXa = resultSetTaiKhoan.getString(&quot;MaXa&quot;);
                editSoDienThoai.setText(resultSetTaiKhoan.getString(&quot;SoDienThoai&quot;));
                editEmail</B></FONT>.setText(<FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#152',3,'match0-top.html#152',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetTaiKhoan.getString(&quot;Email&quot;));
                editKinhDo.setText(resultSetTaiKhoan.getString(&quot;KinhDo&quot;));
                editViDo.setText(resultSetTaiKhoan.getString(&quot;ViDo&quot;));
            }
            else { //Quay lại trang chủ
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentHome());
                fragmentTransaction.commit();
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
    }
<A NAME="153"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void loadLoaiTaiKhoan() { //Danh sách loại tài khoản
        <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#153',3,'match0-top.html#153',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaLoaiTaiKhoan.clear(); //Xóa danh sách đang có
        listTenLoaiTaiKhoan.clear();
        listMaLoaiTaiKhoan.add(&quot;1&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quản trị phần mềm&quot;);
        listMaLoaiTaiKhoan.add(&quot;2&quot;);
        listTenLoaiTaiKhoan.add(&quot;Khách du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;3&quot;);
        listTenLoaiTaiKhoan.add(&quot;Công ty du lịch&quot;);
        listMaLoaiTaiKhoan.add(&quot;4&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quán ăn/nhà hàng&quot;);
        listMaLoaiTaiKhoan.add(&quot;5&quot;);
        listTenLoaiTaiKhoan.add(&quot;Nhà nghỉ/khách sạn&quot;);
        listMaLoaiTaiKhoan.add(&quot;6&quot;);
        listTenLoaiTaiKhoan.add(&quot;Quản trị tỉnh&quot;);
        ArrayAdapter&lt;String&gt; dataLoaiTaiKhoan = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenLoaiTaiKhoan);
        dataLoaiTaiKhoan.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdLoaiTaiKhoan</B></FONT>.setAdapter(dataLoaiTaiKhoan);
        cmdLoaiTaiKhoan.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @SuppressLint(&quot;SetTextI18n&quot;)
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaLoaiTaiKhoan.isEmpty()) {
<A NAME="154"></A>                    strLoaiTaiKhoan = listMaLoaiTaiKhoan.get(position);
                    String strDiaChi = null;
                    switch (strLoaiTaiKhoan){
                        case &quot;1&quot;<FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#154',3,'match0-top.html#154',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>:
                        case &quot;2&quot;:
                        case &quot;6&quot;:
                            strDiaChi = &quot;Địa chỉ thường trú&quot;;
                            textCongTy.setVisibility(View.GONE);
                            editCongTy.setVisibility(View.GONE);
                            layoutViTri.setVisibility(View.GONE);
                            break;
                        case &quot;3&quot;:
                            strDiaChi = &quot;Địa chỉ công ty&quot;;
                            textCongTy.setText(&quot;Tên công ty&quot;);
                            editCongTy.setHint(&quot;Nhập tên công ty&quot;);
                            textCongTy</B></FONT>.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            layoutViTri.setVisibility(View.GONE);
                            break;
                        case &quot;4&quot;:
                            strDiaChi = &quot;Địa chỉ quán ăn/nhà hàng&quot;;
                            textCongTy.setText(&quot;Tên quán ăn/nhà hàng&quot;);
                            editCongTy.setHint(&quot;Nhập tên quán ăn/nhà hàng&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            layoutViTri.setVisibility(View.VISIBLE);
                            break;
                        case &quot;5&quot;:
                            strDiaChi = &quot;Địa chỉ nhà nghỉ/khách sạn&quot;;
                            textCongTy.setText(&quot;Tên nhà nghỉ/khách sạn&quot;);
                            editCongTy.setHint(&quot;Nhập tên nhà nghỉ/khách sạn&quot;);
                            textCongTy.setVisibility(View.VISIBLE);
                            editCongTy.setVisibility(View.VISIBLE);
                            layoutViTri.setVisibility(View.VISIBLE);
                            break;
                    }
                    textDiaChi.setText(strDiaChi);
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật loại tài khoản&quot;);
                }
            }
            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {
<A NAME="155"></A>
            }
        });
        <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#155',3,'match0-top.html#155',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdLoaiTaiKhoan.setSelection(Integer.parseInt(strLoaiTaiKhoan) - 1); //Gán loại tài khoản đã đăng ký
        cmdLoaiTaiKhoan.setEnabled(false); //Không được thay đổi loại tài khoản
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
<A NAME="156"></A>                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#156',3,'match0-top.html#156',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listMaHuyen.clear(); // Xóa danh sách huyện
<A NAME="157"></A>            listTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
            dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#157',3,'match0-top.html#157',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setAdapter(dataHuyen);
            loadXa(strMaHuyen); //Load danh sách xã
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh.isEmpty()) {
                    strMaTinh = listMaTinh.get(position);
<A NAME="158"></A>                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh</B></FONT>.setSelection(listMaTinh.indexOf(ganMaTinh));
                        strMaTinh = ganMaTinh;
                        <FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#158',3,'match0-top.html#158',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaTinh = &quot;&quot;;
                    }
                    loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+ maTinh +&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
<A NAME="159"></A>                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                <FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#159',3,'match0-top.html#159',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaXa.clear(); // Xóa danh sách xã
            listTenXa.clear();
            ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenXa);
<A NAME="160"></A>            dataXa</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdXa.setAdapter(dataXa);
        }
        <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#160',3,'match0-top.html#160',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen.isEmpty()) {
                    strMaHuyen = listMaHuyen.get(position);
<A NAME="161"></A>                    if (!ganMaHuyen.equals(&quot;&quot;)) {
                        cmdHuyen.setSelection(listMaHuyen.indexOf(ganMaHuyen));
                        strMaHuyen</B></FONT> = ganMaHuyen;
                        <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#161',3,'match0-top.html#161',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ganMaHuyen = &quot;&quot;;
                    }
                    loadXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadXa(String maHuyen){ //Danh sách huyện
        listMaXa.clear(); // Xóa danh sách huyện
        listTenXa.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
            ResultSet resultSetXa = classConnect.selectData(getActivity(), sqlXa);
            if (resultSetXa != null){
                while (resultSetXa.next()){
                    listMaXa.add(resultSetXa.getString(&quot;MaXa&quot;));
                    listTenXa.add(resultSetXa.getString(&quot;TenXa&quot;));
                }
<A NAME="162"></A>                ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenXa);
                dataXa</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdXa.setAdapter(dataXa);
            <FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#162',3,'match0-top.html#162',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            if (listMaXa.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdXa.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaXa.isEmpty()) {
                    strMaXa = listMaXa.get(position);
                    if (!ganMaXa.equals(&quot;&quot;)){
                        cmdXa</B></FONT>.setSelection(listMaXa.indexOf(ganMaXa));
                        strMaXa = ganMaXa;
<A NAME="163"></A>                        ganMaXa = &quot;&quot;;
                    }
                }
            <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#163',3,'match0-top.html#163',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void clickButton() {
        btnQuayLai</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) { //Quay lại trang chủ
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentHome());
                fragmentTransaction.commit();
            }
        });
        btnThayDoi.setOnClickListener(new View.OnClickListener() {
<A NAME="164"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#164',3,'match0-top.html#164',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editTaiKhoan.getText().length() != 0){
                    if (editHoTen.getText().length() != 0) {
                        if (!listMaTinh.isEmpty()) { //Kiểm tra tỉnh rỗng
                            if (!listMaHuyen.isEmpty()) { //Kiểm tra huyện rỗng
                                if (!listMaXa.isEmpty()) { //Kiểm tra xã rỗng
                                    if (editSoDienThoai</B></FONT>.getText().length() == 10) {
                                        try {
<A NAME="165"></A>                                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                                            String sqlTaiKhoan = null;
                                            switch (strLoaiTaiKhoan){
                                                case &quot;1&quot;<FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#165',3,'match0-top.html#165',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>:
                                                case &quot;2&quot;:
                                                    sqlTaiKhoan = &quot;update TB_NguoiDung set HoTen = N'&quot;+ editHoTen.getText() +&quot;', MaTinh = '&quot;+ strMaTinh +&quot;', &quot; +
                                                            &quot;MaHuyen = '&quot;+ strMaHuyen +&quot;', MaXa = '&quot;+ strMaXa +&quot;', Email = '&quot;+ editEmail.getText() +&quot;', SoDienThoai = '&quot;+ editSoDienThoai.getText() +&quot;' &quot; +
                                                            &quot;where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                                                    break;
                                                case &quot;3&quot;:
                                                    sqlTaiKhoan = &quot;update TB_NguoiDung set HoTen = N'&quot;+ editHoTen.getText() +&quot;', CongTy = N'&quot;+ editCongTy.getText() +&quot;', MaTinh = '&quot;+ strMaTinh +&quot;', &quot; +
                                                            &quot;MaHuyen = '&quot;+ strMaHuyen +&quot;', MaXa = '&quot;+ strMaXa +&quot;', Email = '&quot;+ editEmail</B></FONT>.getText() +&quot;', SoDienThoai = '&quot;+ editSoDienThoai.getText() +&quot;' &quot; +
                                                            &quot;where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                                                    break;
                                                case &quot;4&quot;:
<A NAME="166"></A>                                                case &quot;5&quot;:
                                                    sqlTaiKhoan = &quot;update TB_NguoiDung set HoTen = N'&quot;+ editHoTen.getText() +&quot;', CongTy = N'&quot;+ editCongTy.getText() +&quot;', MaTinh = '&quot;+ strMaTinh +&quot;', &quot; +
                                                            &quot;MaHuyen = '&quot;+ strMaHuyen +&quot;', MaXa = '&quot;+ strMaXa +&quot;', Email = '&quot;+ editEmail.getText() +&quot;', SoDienThoai = '&quot;+ editSoDienThoai.getText() +&quot;', &quot; +
                                                            &quot;KinhDo = '&quot;+ Float.parseFloat(<FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#166',3,'match0-top.html#166',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editKinhDo.getText().toString())+&quot;', ViDo = '&quot;+Float.parseFloat(editViDo.getText().toString()) +&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                                                    break;
                                            }
                                            if (classConnect.updateData(getActivity(), sqlTaiKhoan) == 1) {
                                                classPublic.ThongBao(getActivity(), &quot;Thông báo! Thay đổi tài khoản thành công&quot;);
<A NAME="167"></A>                                            } else {
                                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không thay đổi được thông tin tài khoản&quot;);
                                            }</B></FONT>
                                            <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#167',3,'match0-top.html#167',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
                                        } catch (Exception e) {
                                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                                        }
                                    }
                                    else {
                                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập số điện thoại hoặc Số điện thoại không đúng&quot;);
                                    }
                                }
                                else {
                                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng chọn phường/xã&quot;);
                                }
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng chọn quận/huyện&quot;);
                            }
                        }
                        else {
                            classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng chọn tỉnh/thành phố&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập họ và tên&quot;);
                    }
                }
                else {
                    classPublic.ThongBao(getActivity(), &quot;Thông báo! Vui lòng nhập tài khoản&quot;);
                }</B></FONT>
            }
        });
    }
}
</PRE>
<HR>
<H3><CENTER>NguoiDung\ListViewDanhSachTaiKhoan.java</CENTER></H3><HR>
<PRE>
<A NAME="168"></A><FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#168',3,'match0-top.html#168',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.CompoundButton;
import android.widget.ImageButton;
import android.widget.Switch;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewDanhSachTaiKhoan extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassDanhSachTaiKhoan&gt; arraylist;
<A NAME="169"></A>    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();

    public <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#169',3,'match0-top.html#169',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ListViewDanhSachTaiKhoan(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan);
    }
    public static class ViewHolder {
        TextView textTaiKhoan, textHoTen;
        Switch btnTrangThai;
        ImageButton btnPass, btnEdit, btnDelete;
    }
    @Override
    public int getCount() {
        return FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_danhsachtaikhoan, null);
            holder.textTaiKhoan = convertView.findViewById(R.id.textTaiKhoan);
            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.btnTrangThai = convertView.findViewById(R.id.btnTrangThai);
            holder.btnPass = convertView.findViewById(R.id.btnPass);
            holder.btnEdit = convertView.findViewById(R.id.btnEdit);
            holder.btnDelete = convertView.findViewById(R.id.btnDelete);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }
        holder.textHoTen.setText((position + 1) + &quot;. &quot; + FragmentDanhSachTaiKhoan</B></FONT>.arrayListDanhSachTaiKhoan.get(position).getStrHoTen());
        holder.textTaiKhoan.setText(&quot;Tài khoản: &quot; + FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrTaiKhoan());
        holder.btnTrangThai.setChecked(FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getBooleanTrangThai());
        holder.btnTrangThai.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
<A NAME="170"></A>            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                //Hiện hộp thoại thông báo thay đổi trạng thái tài khoản
                final String <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#170',3,'match0-top.html#170',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strTaiKhoan = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrTaiKhoan();
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn thay đổi trạng thái tài khoản: &quot; + strTaiKhoan + &quot; này không?&quot;);
                builder.setCancelable(false);
                builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlTaiKhoan;
                            if (holder.btnTrangThai.isChecked()){
                                sqlTaiKhoan = &quot;update TB_NguoiDung set TrangThai = 1 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            }
                            else {
                                sqlTaiKhoan = &quot;update TB_NguoiDung set TrangThai = 0 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            }
                            if (classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Thay đổi trạng thái thành công&quot;);
                                FragmentDanhSachTaiKhoan.fragmentTransaction = FragmentDanhSachTaiKhoan.fragmentManager.beginTransaction();
<A NAME="171"></A>                                FragmentDanhSachTaiKhoan.fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
                                FragmentDanhSachTaiKhoan.fragmentTransaction.commit();
                            }
                            <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#171',3,'match0-top.html#171',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không thay đổi được trạng thái&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }</B></FONT>
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        FragmentDanhSachTaiKhoan.fragmentTransaction = FragmentDanhSachTaiKhoan.fragmentManager.beginTransaction();
                        FragmentDanhSachTaiKhoan.fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
                        FragmentDanhSachTaiKhoan.fragmentTransaction.commit();
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        holder.btnPass.setOnClickListener(view -&gt; {
            String strTaiKhoan = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrTaiKhoan();
            String strMatKhau = classPublic.setPass();
            AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
            builder.setTitle(&quot;THÔNG BÁO&quot;);
            builder.setMessage(&quot;Bạn có muốn Reset mật khẩu tài khoản: &quot; + strTaiKhoan + &quot; không?&quot;);
            builder.setCancelable(false);
            builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                @SuppressLint(&quot;NewApi&quot;)
                @Override
                public void onClick(DialogInterface dialogInterface, int i) {
<A NAME="172"></A>                    try{
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String sqlTaiKhoan = &quot;update TB_NguoiDung set MatKhau = '&quot;+strMatKhau+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                        if (<FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#172',3,'match0-top.html#172',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                            showPass(strMatKhau);
                        }
                        else {
                            classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không Reset được mật khẩu&quot;);
                        }
                        classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
                    }
                }
            });
            builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialogInterface, int i) {
<A NAME="173"></A>                    dialogInterface.dismiss();
                }
            });
            AlertDialog alertDialog = <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#173',3,'match0-top.html#173',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>builder.create();
            alertDialog.show();
        });

        holder.btnEdit.setOnClickListener(view -&gt; {
<A NAME="174"></A>            String strTaiKhoan = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrTaiKhoan();
            Integer intLoaiTaiKhoan = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getIntLoaiTaiKhoan();
            String strHoTen = FragmentDanhSachTaiKhoan</B></FONT>.arrayListDanhSachTaiKhoan.get(position).getStrHoTen();
            String strCongTy = <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#174',3,'match0-top.html#174',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrCongTy();
            String strMaTinh = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrMaTinh();
            String strMaHuyen = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrMaHuyen();
            String strMaXa = FragmentDanhSachTaiKhoan</B></FONT>.arrayListDanhSachTaiKhoan.get(position).getStrMaXa();
            String strEmail = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrEmail();
            String strDienThoai = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrDienThoai();
            FragmentDanhSachTaiKhoan.fragmentTransaction = FragmentDanhSachTaiKhoan.fragmentManager.beginTransaction();
            FragmentDanhSachTaiKhoan.fragmentTransaction.replace(R.id.fragment_main, DanhSachTaiKhoanEditFragment.newInstance(strTaiKhoan, intLoaiTaiKhoan, strHoTen, strCongTy,strMaTinh, strMaHuyen, strMaXa, strEmail, strDienThoai));
            FragmentDanhSachTaiKhoan.fragmentTransaction.commit();
        });

        holder.btnDelete.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) { //Hiện hộp thoại thông báo xóa tài khoản
                final String strTaiKhoan = FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.get(position).getStrTaiKhoan();
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa tài khoản: &quot; + strTaiKhoan + &quot; không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="175"></A>                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#175',3,'match0-top.html#175',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try{
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlTaiKhoan = &quot;update TB_NguoiDung set HienThi = 0, TrangThai = 0 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa tài khoản thành công&quot;);
                                FragmentDanhSachTaiKhoan</B></FONT>.fragmentTransaction = FragmentDanhSachTaiKhoan.fragmentManager.beginTransaction();
<A NAME="176"></A>                                FragmentDanhSachTaiKhoan.fragmentTransaction.replace(R.id.fragment_main, new FragmentDanhSachTaiKhoan());
                                FragmentDanhSachTaiKhoan.fragmentTransaction.commit();
                            }
                            <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#176',3,'match0-top.html#176',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }</B></FONT>
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });
        return convertView;
    }

    private void showPass(String pass) {
        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
        builder.setTitle(&quot;THÔNG BÁO&quot;);
        builder.setMessage(&quot;Mật khẩu mới: &quot; + pass);
        builder.setCancelable(false);
        builder.setNegativeButton(&quot;Đóng&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
<A NAME="177"></A>        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#177',3,'match0-top.html#177',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.clear();
        if (charText.length() == 0) {
            FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.addAll(arraylist);
        } else {
            for (ClassDanhSachTaiKhoan wp : arraylist) {
                if (wp.getStrTaiKhoan().toLowerCase(Locale.getDefault()).contains(charText) || wp.getStrHoTen().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentDanhSachTaiKhoan.arrayListDanhSachTaiKhoan.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\QuanTriTinhClass.java</CENTER></H3><HR>
<PRE>
<A NAME="178"></A><FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#178',3,'match0-top.html#178',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

public class QuanTriTinhClass {

    String strTaiKhoan, strHoTen, strMaTinh, strMaHuyen, strMaXa, strEmail, strDienThoai;
<A NAME="179"></A>    Boolean booleanTrangThai</B></FONT>;

    public QuanTriTinhClass(String strTaiKhoan, String strHoTen, String strMaTinh, String strMaHuyen, String strMaXa, String strEmail, String strDienThoai, Boolean booleanTrangThai) {
        <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#179',3,'match0-top.html#179',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strTaiKhoan = strTaiKhoan;
        this.strHoTen = strHoTen;
        this.strMaTinh = strMaTinh;
        this.strMaHuyen = strMaHuyen;
        this.strMaXa = strMaXa;
        this.strEmail = strEmail;
        this.strDienThoai = strDienThoai;
        this.booleanTrangThai = booleanTrangThai;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrHoTen() {
        return strHoTen;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrMaHuyen() {
        return strMaHuyen;
    }

    public String getStrMaXa() {
        return strMaXa;
    }

    public String getStrEmail() {
        return strEmail;
    }

    public String getStrDienThoai() {
        return strDienThoai;
    }

    public Boolean getBooleanTrangThai() {
        return booleanTrangThai;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>NguoiDung\QuanTriTinhEditFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="180"></A><FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#180',3,'match0-top.html#180',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
import android.os.Bundle;

import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.TextView;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class QuanTriTinhEditFragment extends Fragment {

    private static final String ARG_TaiKhoan</B></FONT> = &quot;Taikhoan&quot;;
    private static final String ARG_HoTen = &quot;HoTen&quot;;
    private static final String ARG_MaTinh = &quot;MaTinh&quot;;
    private static final String ARG_MaHuyen = &quot;MaHuyen&quot;;
<A NAME="181"></A>    private static final String ARG_MaXa = &quot;MaXa&quot;;
    private static final String ARG_Email = &quot;Email&quot;;
    private static final String ARG_DienThoai = &quot;DienThoai&quot;;
    private String mTaiKhoan, mHoTen, mMaTinh, <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#181',3,'match0-top.html#181',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>mMaHuyen, mMaXa, mEmail, mDienThoai;
    //Phần khai báo
    FragmentManager fragmentManager;
    FragmentTransaction fragmentTransaction;
    ClassPublic classPublic = new ClassPublic();
    ClassConnect classConnect;
<A NAME="182"></A>    View view;
    TextView txtTieuDe;
    EditText editTaiKhoan, editHoTen, editEmail</B></FONT>, editDienThoai;
    Spinner cmdTinh, cmdHuyen, <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#182',3,'match0-top.html#182',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdXa;
    Button btnBack, btnSave;
    ArrayList&lt;String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaHuyen = new ArrayList&lt;&gt;(); //Khai báo danh sách huyện
    ArrayList&lt;String&gt; listTenHuyen = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listMaXa = new ArrayList&lt;&gt;(); //Khai báo danh sách xã
    ArrayList&lt;String&gt; listTenXa = new ArrayList</B></FONT>&lt;&gt;();
    String strMaTinh, strMaHuyen, strMaXa;

    public QuanTriTinhEditFragment() {
    }
<A NAME="183"></A>
    public static QuanTriTinhEditFragment newInstance(String taiKhoan, String hoTen, String maTinh, String maHuyen, String maXa, String email, String dienThoai) {
        QuanTriTinhEditFragment fragment = new QuanTriTinhEditFragment();
        Bundle <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#183',3,'match0-top.html#183',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>args = new Bundle();
        args.putString(ARG_TaiKhoan, taiKhoan);
        args.putString(ARG_HoTen, hoTen);
        args.putString(ARG_MaTinh, maTinh);
        args.putString(ARG_MaHuyen, maHuyen);
        args.putString(ARG_MaXa, maXa);
        args.putString(ARG_Email, email);
        args.putString(ARG_DienThoai, dienThoai);
        fragment</B></FONT>.setArguments(args);
        return fragment;
    }

<A NAME="184"></A>    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (<FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#184',3,'match0-top.html#184',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments() != null) {
<A NAME="185"></A>            mTaiKhoan = getArguments().getString(ARG_TaiKhoan);
            mHoTen = getArguments().getString(ARG_HoTen);
            mMaTinh = getArguments</B></FONT>().getString(ARG_MaTinh);
            mMaHuyen = <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#185',3,'match0-top.html#185',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getArguments().getString(ARG_MaHuyen);
            mMaXa = getArguments().getString(ARG_MaXa);
            mEmail = getArguments().getString(ARG_Email);
            mDienThoai = getArguments</B></FONT>().getString(ARG_DienThoai);
        }
        else {
            mTaiKhoan = &quot;&quot;;
            mMaTinh = &quot;&quot;;
            mMaHuyen = &quot;&quot;;
            mMaXa = &quot;&quot;;
        }
    }

    @Override
<A NAME="186"></A>    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_quan_tri_tinh_edit, container, false);
        fragmentManager = <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#186',3,'match0-top.html#186',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        layoutAnhXa();
        return view;
    }

    @SuppressLint(&quot;SetTextI18n&quot;)
    private void layoutAnhXa() {
        txtTieuDe = view.findViewById(R.id.textTieuDe);
        editTaiKhoan = view.findViewById(R.id.editTaiKhoan);
        editHoTen = view.findViewById(R.id.editHoTen);
        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHuyen = view.findViewById(R.id.cmdHuyen);
        cmdXa = view.findViewById(R.id.cmdXa);
        editEmail = view.findViewById(R.id.editEmail);
        editDienThoai = view.findViewById(R.id.editSoDienThoai);
        btnBack = view</B></FONT>.findViewById(R.id.btnQuayLai);
        btnSave = view.findViewById(R.id.btnLuuLai);
        loadTinh();
        clickButton();
        if (mTaiKhoan.equals(&quot;&quot;)){
            txtTieuDe.setText(&quot;THÊM MỚI QUẢN TRỊ TỈNH&quot;);
        }
        else {
            txtTieuDe.setText(&quot;CẬP NHẬT QUẢN TRỊ TỈNH&quot;);
            editTaiKhoan.setText(mTaiKhoan);
            editTaiKhoan.setEnabled(false);
            editHoTen.setText(mHoTen);
<A NAME="187"></A>            editEmail.setText(mEmail);
            editDienThoai.setText(mDienThoai);
        }
    <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#187',3,'match0-top.html#187',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){ //Danh sách tỉnh
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdTinh.setAdapter(dataTinh);
            }
            if (listMaTinh.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
<A NAME="188"></A>        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }</B></FONT>
        <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#188',3,'match0-top.html#188',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (listMaTinh.isEmpty()){ //Nếu chưa nhập tỉnh thì không hiển thị huyện
            listMaHuyen.clear(); // Xóa danh sách huyện
<A NAME="189"></A>            listTenHuyen.clear();
            ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(getActivity</B></FONT>(), android.R.layout.simple_spinner_item,listTenHuyen);
            dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#189',3,'match0-top.html#189',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHuyen.setAdapter(dataHuyen);
            loadXa(strMaHuyen); //Load danh sách xã
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (!mMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
<A NAME="190"></A>                        mMaTinh = &quot;&quot;;
                    }
                    strMaTinh = listMaTinh.get(position);
                    <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#190',3,'match0-top.html#190',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadHuyen(strMaTinh);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadHuyen(String maTinh){ //Danh sách huyện
        listMaHuyen.clear(); // Xóa danh sách huyện
        listTenHuyen.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlHuyen = &quot;select MaHuyen, TenHuyen from TB_Huyen where MaTinh = '&quot;+maTinh+&quot;'&quot;;
            ResultSet resultSetHuyen = classConnect.selectData(getActivity(), sqlHuyen);
            if (resultSetHuyen != null){
                while (resultSetHuyen.next()){
                    listMaHuyen.add(resultSetHuyen.getString(&quot;MaHuyen&quot;));
                    listTenHuyen.add(resultSetHuyen.getString(&quot;TenHuyen&quot;));
                }
                ArrayAdapter&lt;String&gt; dataHuyen = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenHuyen);
                dataHuyen.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdHuyen.setAdapter(dataHuyen);
            }
            if (listMaHuyen.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách quận/huyện&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        if (listMaHuyen.isEmpty()){ //Nếu chưa nhập huyện thì không hiển thị xã
            listMaXa.clear(); // Xóa danh sách xã
            listTenXa.clear();
            ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenXa);
            dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
            cmdXa.setAdapter(dataXa);
        }
        cmdHuyen.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaHuyen</B></FONT>.isEmpty()) {
                    if (!mMaHuyen.equals(&quot;&quot;)){
                        cmdHuyen.setSelection(listMaHuyen.indexOf(mMaHuyen));
<A NAME="191"></A>                        mMaHuyen = &quot;&quot;;
                    }
                    strMaHuyen = listMaHuyen.get(position);
                    <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#191',3,'match0-top.html#191',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadXa(strMaHuyen);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }
    @SuppressLint(&quot;NewApi&quot;)
    private void loadXa(String maHuyen){ //Danh sách huyện
        listMaXa.clear(); // Xóa danh sách huyện
        listTenXa.clear();
        try {
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlXa = &quot;select MaXa, TenXa from TB_Xa where MaHuyen = '&quot;+ maHuyen +&quot;'&quot;;
            ResultSet resultSetXa = classConnect.selectData(getActivity(), sqlXa);
            if (resultSetXa != null){
                while (resultSetXa.next()){
                    listMaXa.add(resultSetXa.getString(&quot;MaXa&quot;));
                    listTenXa.add(resultSetXa.getString(&quot;TenXa&quot;));
                }
                ArrayAdapter&lt;String&gt; dataXa = new ArrayAdapter&lt;&gt;(getActivity(), android.R.layout.simple_spinner_item,listTenXa);
                dataXa.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
                cmdXa.setAdapter(dataXa);
            }
            if (listMaXa.isEmpty()){
                classPublic.ThongBao(getActivity(), &quot;Thông báo! Đang cập nhật danh sách phường/xã&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdXa.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaXa</B></FONT>.isEmpty()) {
                    if (!mMaXa.equals(&quot;&quot;)){
<A NAME="192"></A>                        cmdXa.setSelection(listMaXa.indexOf(mMaXa));
                        mMaXa = &quot;&quot;;
                    }
                    strMaXa = <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#192',3,'match0-top.html#192',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listMaXa.get(position);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
<A NAME="193"></A>        });
    }</B></FONT>

    private <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#193',3,'match0-top.html#193',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void clickButton() {
        btnBack.setOnClickListener(view -&gt; {
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
            fragmentTransaction.commit();
        });

        btnSave</B></FONT>.setOnClickListener(view -&gt; {
            try {
                if (editTaiKhoan.getText().length() == 0){
                    editTaiKhoan.setError(&quot;Thông báo! Chưa nhập tài khoản&quot;);
                    editTaiKhoan.requestFocus();
                    return;
                }
                if (editHoTen.getText().length() == 0){
                    editHoTen.setError(&quot;Thông báo! Chưa nhập họ tên&quot;);
                    editHoTen.requestFocus();
                    return;
                }
                classConnect = new ClassConnect(); //Mở kết nối đến SQL
<A NAME="194"></A>                String sql;
                if (mTaiKhoan.equals(&quot;&quot;)){
                    sql = &quot;insert into TB_NguoiDung(TaiKhoan, MatKhau, LoaiTaiKhoan, HoTen, MaTinh, MaHuyen, MaXa, Email, SoDienThoai) &quot; +
                            &quot;values ('&quot;+<FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#194',3,'match0-top.html#194',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editTaiKhoan.getText().toString()+&quot;', 12345678, 6, N'&quot;+editHoTen.getText().toString()+&quot;', '&quot;+strMaTinh+&quot;', '&quot;+strMaHuyen+&quot;','&quot;+strMaXa+&quot;', '&quot;+editEmail.getText().toString()+&quot;', '&quot;+editDienThoai.getText().toString()+&quot;')&quot;;
                }
                else {
                    sql = &quot;update TB_NguoiDung set HoTen = N'&quot;+editHoTen.getText().toString()+&quot;', MaTinh = '&quot;+strMaTinh+&quot;', MaHuyen = '&quot;+strMaHuyen+&quot;', MaXa = '&quot;+strMaXa+&quot;', Email = '&quot;+editEmail.getText().toString()+&quot;', SoDienThoai = '&quot;+editDienThoai</B></FONT>.getText().toString()+&quot;' where TaiKhoan = '&quot;+editTaiKhoan.getText().toString()+&quot;'&quot;;
                }
                if (classConnect.updateData(getActivity(), sql) == 1){
                    if (mTaiKhoan.equals(&quot;&quot;)){
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Thêm mới thành công&quot;);
                    }
                    else {
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Cập nhật thành công&quot;);
                    }
                    fragmentTransaction = fragmentManager.beginTransaction();
                    fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
                    fragmentTransaction.commit();
                }
                else {
                    if (mTaiKhoan.equals(&quot;&quot;)){
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Không thêm mới được&quot;);
                    }
<A NAME="195"></A>                    else {
                        classPublic.ThongBao(getActivity(), &quot;Thông báo! Không cập nhật được&quot;);
                    }
                <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#195',3,'match0-top.html#195',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
                classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
            }catch (Exception e){
                Log.d(&quot;TAG&quot;,e.getMessage());
            }
        });
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\QuanTriTinhFragment.java</CENTER></H3><HR>
<PRE>
<A NAME="196"></A>package com.example.travelling.NguoiDung;

<FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#196',3,'match0-top.html#196',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.os.Bundle;

import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class QuanTriTinhFragment extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
    ImageButton btnAdd;
    SearchView searchView;
    Spinner cmdTrangThai;
    ListView listView;
    ClassConnect classConnect;
<A NAME="197"></A>    ClassPublic classPublic = new ClassPublic();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction</B></FONT>;
    public static ArrayList&lt;QuanTriTinhClass&gt; <FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#197',3,'match0-top.html#197',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListQuanTriTinh;
    QuanTriTinhListView adapterQuanTriTinh;
    ArrayList&lt;String&gt; listMaTrangThai = new ArrayList&lt;&gt;(); //Khai báo danh sách trạng thái
    ArrayList&lt;String&gt; listTenTrangThai = new ArrayList&lt;&gt;();
    String strMaTrangThai</B></FONT>;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.fragment_quan_tri_tinh, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        layoutAnhXa();
<A NAME="198"></A>        return view;
    }

    private <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#198',3,'match0-top.html#198',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layoutAnhXa() {
        btnAdd = view.findViewById(R.id.btnThemMoi);
        searchView = view.findViewById(R.id.searchTen);
        cmdTrangThai = view.findViewById(R.id.cmdTrangThai);
        listView = view.findViewById(R.id.listView);
        loadTrangThai();
        clickButton();
    }

    private void loadTrangThai() {
        listMaTrangThai.clear(); // Xóa danh sách trạng thái
        listTenTrangThai.clear();
        listMaTrangThai.add(&quot;1&quot;);
        listTenTrangThai.add(&quot;Hoạt động&quot;);
        listMaTrangThai.add(&quot;0&quot;);
        listTenTrangThai.add(&quot;Bị khóa&quot;);
<A NAME="199"></A>        ArrayAdapter&lt;String&gt; dataTrangThai = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTrangThai);
        dataTrangThai.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdTrangThai</B></FONT>.setAdapter(dataTrangThai);
        <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#199',3,'match0-top.html#199',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdTrangThai.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTrangThai.isEmpty()) {
<A NAME="200"></A>                    strMaTrangThai = listMaTrangThai</B></FONT>.get(position);
                    loadQuanTriTinh(Integer.parseInt(strMaTrangThai)); //Load danh sách tai khoản
                }
            <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#200',3,'match0-top.html#200',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void loadQuanTriTinh(Integer maTrangThai) {
        arrayListQuanTriTinh = new ArrayList&lt;&gt;();
        arrayListQuanTriTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDanhSachTaiKhoan = &quot;select TaiKhoan, HoTen, MaTinh, MaHuyen, MaXa, Email, SoDienThoai, TrangThai from TB_NguoiDung where HienThi = 1 and TrangThai = '&quot;+strMaTrangThai+&quot;' and LoaiTaiKhoan = 6&quot;;
<A NAME="201"></A>            ResultSet resultSetDanhSachTaiKhoan = classConnect.selectData(getActivity(), sqlDanhSachTaiKhoan);
            if (resultSetDanhSachTaiKhoan != null){
                while (resultSetDanhSachTaiKhoan</B></FONT>.next()){
                    arrayListQuanTriTinh.add(new QuanTriTinhClass(<FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#201',3,'match0-top.html#201',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetDanhSachTaiKhoan.getString(&quot;TaiKhoan&quot;), resultSetDanhSachTaiKhoan.getString(&quot;HoTen&quot;),
                            resultSetDanhSachTaiKhoan.getString(&quot;MaTinh&quot;), resultSetDanhSachTaiKhoan.getString(&quot;MaHuyen&quot;), resultSetDanhSachTaiKhoan.getString(&quot;MaXa&quot;),
                            resultSetDanhSachTaiKhoan.getString(&quot;Email&quot;), resultSetDanhSachTaiKhoan.getString(&quot;SoDienThoai&quot;), resultSetDanhSachTaiKhoan.getBoolean(&quot;TrangThai&quot;)));
                }
            }
            else {
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Chưa cập nhật danh sách tài khoản&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
<A NAME="202"></A>        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(e.getMessage()));
        }
        adapterQuanTriTinh = new QuanTriTinhListView(<FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#202',3,'match0-top.html#202',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getContext());
        listView.setAdapter(adapterQuanTriTinh);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    private void clickButton() {
        btnAdd.setOnClickListener(view -&gt; {
            fragmentTransaction = fragmentManager.beginTransaction();
            fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhEditFragment());
            fragmentTransaction.commit();
<A NAME="203"></A>        });
    }</B></FONT>

    <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#203',3,'match0-top.html#203',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@Override
    public boolean onQueryTextSubmit(String s) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String s) {
        adapterQuanTriTinh.filter(s);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NguoiDung\QuanTriTinhListView.java</CENTER></H3><HR>
<PRE>
<A NAME="204"></A><FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#204',3,'match0-top.html#204',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NguoiDung;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.CompoundButton;
import android.widget.ImageButton;
import android.widget.Switch;
import android.widget.TextView;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class QuanTriTinhListView extends BaseAdapter {

    Context mContext</B></FONT>;
    LayoutInflater inflater;
    ArrayList&lt;QuanTriTinhClass&gt; arraylist;
<A NAME="205"></A>    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();

    public <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#205',3,'match0-top.html#205',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>QuanTriTinhListView(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(QuanTriTinhFragment.arrayListQuanTriTinh);
    }
    public static class ViewHolder {
        TextView textTaiKhoan, textHoTen;
        Switch btnTrangThai;
        ImageButton btnPass, btnEdit, btnDelete;
    }
    @Override
    public int getCount() {
        return QuanTriTinhFragment.arrayListQuanTriTinh.size();
    }

    @Override
    public Object getItem(int position) {
        return QuanTriTinhFragment.arrayListQuanTriTinh.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final QuanTriTinhListView.ViewHolder holder;
        if (convertView == null) {
            holder = new QuanTriTinhListView.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_danhsachtaikhoan, null);
            holder.textTaiKhoan = convertView.findViewById(R.id.textTaiKhoan);
            holder.textHoTen = convertView.findViewById(R.id.textHoTen);
            holder.btnTrangThai = convertView.findViewById(R.id.btnTrangThai);
            holder.btnPass = convertView.findViewById(R.id.btnPass);
            holder.btnEdit = convertView.findViewById(R.id.btnEdit);
            holder.btnDelete = convertView.findViewById(R.id.btnDelete);
            convertView.setTag(holder);
<A NAME="206"></A>        } else {
            holder = (QuanTriTinhListView.ViewHolder) convertView.getTag();
        }</B></FONT>
        <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#206',3,'match0-top.html#206',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textHoTen.setText((position + 1) + &quot;. &quot; + QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getStrHoTen());
        holder.textTaiKhoan.setText(&quot;Tài khoản: &quot; + QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getStrTaiKhoan());
        holder.btnTrangThai.setChecked(QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getBooleanTrangThai());
        holder</B></FONT>.btnTrangThai.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                //Hiện hộp thoại thông báo thay đổi trạng thái tài khoản
                final String strTaiKhoan = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getStrTaiKhoan();
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn thay đổi trạng thái tài khoản: &quot; + strTaiKhoan + &quot; này không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlTaiKhoan;
                            if (holder.btnTrangThai.isChecked()){
                                sqlTaiKhoan = &quot;update TB_NguoiDung set TrangThai = 1 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            }
                            else {
                                sqlTaiKhoan = &quot;update TB_NguoiDung set TrangThai = 0 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            }
                            if (classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Thay đổi trạng thái thành công&quot;);
                                QuanTriTinhFragment.fragmentTransaction = QuanTriTinhFragment.fragmentManager.beginTransaction();
                                QuanTriTinhFragment.fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
                                QuanTriTinhFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không thay đổi được trạng thái&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        QuanTriTinhFragment.fragmentTransaction = QuanTriTinhFragment.fragmentManager.beginTransaction();
                        QuanTriTinhFragment.fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
                        QuanTriTinhFragment.fragmentTransaction.commit();
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });

        holder.btnPass.setOnClickListener(view -&gt; {
            String strTaiKhoan = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getStrTaiKhoan();
            String strMatKhau = classPublic.setPass();
            AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
            builder.setTitle(&quot;THÔNG BÁO&quot;);
            builder.setMessage(&quot;Bạn có muốn Reset mật khẩu tài khoản: &quot; + strTaiKhoan + &quot; không?&quot;);
            builder.setCancelable(false);
            builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                @SuppressLint(&quot;NewApi&quot;)
                @Override
                public void onClick(DialogInterface dialogInterface, int i) {
                    try{
                        classConnect = new ClassConnect(); //Mở kết nối đến SQL
                        String sqlTaiKhoan = &quot;update TB_NguoiDung set MatKhau = '&quot;+strMatKhau+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                        if (classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                            showPass(strMatKhau);
                        }
                        else {
                            classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không Reset được mật khẩu&quot;);
                        }
                        classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                    }catch (Exception e){
                        Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                    }
                }
            });
            builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialogInterface, int i) {
                    dialogInterface.dismiss();
<A NAME="207"></A>                }
            });
            AlertDialog alertDialog = builder.create();
            <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#207',3,'match0-top.html#207',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog.show();
        });

        holder.btnEdit.setOnClickListener(view -&gt; {
<A NAME="208"></A>            String strTaiKhoan = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).strTaiKhoan;
            String strHoTen = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).strHoTen;
            String strMaTinh = QuanTriTinhFragment</B></FONT>.arrayListQuanTriTinh.get(position).strMaTinh;
            String strMaHuyen = <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#208',3,'match0-top.html#208',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>QuanTriTinhFragment.arrayListQuanTriTinh.get(position).strMaHuyen;
            String strMaXa = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).strMaXa;
            String strEmail = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).strEmail;
            String strDienThoai = QuanTriTinhFragment</B></FONT>.arrayListQuanTriTinh.get(position).strDienThoai;
            QuanTriTinhFragment.fragmentTransaction = QuanTriTinhFragment.fragmentManager.beginTransaction();
            QuanTriTinhFragment.fragmentTransaction.replace(R.id.fragment_main, QuanTriTinhEditFragment.newInstance(strTaiKhoan, strHoTen, strMaTinh, strMaHuyen, strMaXa, strEmail, strDienThoai));
            QuanTriTinhFragment.fragmentTransaction.commit();
        });

        holder.btnDelete.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) { //Hiện hộp thoại thông báo xóa tài khoản
                String strTaiKhoan = QuanTriTinhFragment.arrayListQuanTriTinh.get(position).getStrTaiKhoan();
                AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                builder.setTitle(&quot;THÔNG BÁO&quot;);
                builder.setMessage(&quot;Bạn có muốn xóa &quot; + strTaiKhoan + &quot; không?&quot;);
                builder.setCancelable(false);
                builder.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                    @SuppressLint(&quot;NewApi&quot;)
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        try{
                            classConnect = new ClassConnect(); //Mở kết nối đến SQL
                            String sqlTaiKhoan = &quot;update TB_NguoiDung set HienThi = 0, TrangThai = 0 where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                            if (classConnect.updateData((Activity)mContext, sqlTaiKhoan) == 1){
                                classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Xóa tài khoản thành công&quot;);
                                QuanTriTinhFragment.fragmentTransaction = QuanTriTinhFragment.fragmentManager.beginTransaction();
                                QuanTriTinhFragment.fragmentTransaction.replace(R.id.fragment_main, new QuanTriTinhFragment());
                                QuanTriTinhFragment.fragmentTransaction.commit();
                            }
                            else {
                                classPublic.ThongBao((Activity)mContext, &quot;Lỗi! Không xóa được tài khoản&quot;);
                            }
                            classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                        }catch (Exception e){
                            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                        }
                    }
                });
                builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        dialogInterface.dismiss();
                    }
                });
                AlertDialog alertDialog = builder.create();
                alertDialog.show();
            }
        });
        return convertView;
    }

    private void showPass(String pass) {
        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
        builder.setTitle(&quot;THÔNG BÁO&quot;);
        builder.setMessage(&quot;Mật khẩu mới: &quot; + pass);
        builder.setCancelable(false);
        builder.setNegativeButton(&quot;Đóng&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
<A NAME="209"></A>        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#209',3,'match0-top.html#209',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        QuanTriTinhFragment.arrayListQuanTriTinh.clear();
        if (charText.length() == 0) {
            QuanTriTinhFragment.arrayListQuanTriTinh.addAll(arraylist);
        } else {
            for (QuanTriTinhClass wp : arraylist) {
                if (wp.getStrTaiKhoan().toLowerCase(Locale.getDefault()).contains(charText) || wp.getStrHoTen().toLowerCase(Locale.getDefault()).contains(charText)) {
                    QuanTriTinhFragment.arrayListQuanTriTinh.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ClassMonAn_View.java</CENTER></H3><HR>
<PRE>
<A NAME="5"></A><FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#5',3,'match0-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

public class ClassMonAn_View {

    //Phần khai báo
    Integer intMaMonAn, intGiaMonAn, intLuotThich, intBinhLuan;
    String strTenMonAn, strAnh;

    public ClassMonAn_View(Integer intMaMonAn, String strAnh, String strTenMonAn, Integer intGiaMonAn, Integer intLuotThich, Integer intBinhLuan){
        this.intMaMonAn = intMaMonAn;
        this.strAnh = strAnh;
        this.strTenMonAn = strTenMonAn;
        this.intGiaMonAn = intGiaMonAn;
        this.intLuotThich = intLuotThich;
        this.intBinhLuan = intBinhLuan;
    }

    public Integer getIntMaMonAn() {
        return intMaMonAn;
    }

    public String getStrAnh() {
        return strAnh;
    }

    public String getStrTenMonAn() {
        return strTenMonAn;
    }

    public Integer getIntGiaMonAn() {
        return intGiaMonAn;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ClassNhaHang_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="6"></A><FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#6',3,'match0-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

public class ClassNhaHang_Edit {

    Integer intMaMonAn, intGiaMonAn;
    String strTenMonAn;

    public ClassNhaHang_Edit(Integer intMaMonAn, String strTenMonAn, Integer intGiaMonAn){
        this.intMaMonAn = intMaMonAn;
        this.strTenMonAn = strTenMonAn;
        this.intGiaMonAn = intGiaMonAn;
    }

    public Integer getIntMaMonAn() {
        return intMaMonAn;
    }

    public String getStrTenMonAn() {
        return strTenMonAn;
    }

    public Integer getIntGiaMonAn() {
        return intGiaMonAn;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ClassNhaHang_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="7"></A><FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#7',3,'match0-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

public class ClassNhaHang_Home {

    //Phần khai báo
    Integer intBinhLuan, intLuotThich;
    String strTaiKhoan, strMaTinh, strTenNhaHang, strSoDienThoai, strDiaChi, strAnh;

    public ClassNhaHang_Home(String strTaiKhoan, String strMaTinh, String strTenNhaHang, String strSoDienThoai,
                             String strDiaChi, Integer intBinhLuan, Integer intLuotThich, String strAnh){
        this.strTaiKhoan = strTaiKhoan;
        this.strMaTinh = strMaTinh;
        this.strTenNhaHang = strTenNhaHang;
        this.strSoDienThoai = strSoDienThoai;
        this.strDiaChi = strDiaChi;
        this.intBinhLuan = intBinhLuan;
        this.intLuotThich = intLuotThich;
        this.strAnh = strAnh;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrMaTinh() {
        return strMaTinh;
    }

    public String getStrTenNhaHang() {
        return strTenNhaHang;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public String getStrAnh() {
        return strAnh;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ClassNhaHang_View.java</CENTER></H3><HR>
<PRE>
<A NAME="8"></A><FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#8',3,'match0-top.html#8',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

public class ClassNhaHang_View {

    Integer intBinhLuan, intLuotThich;
    Double doubleKhoangCach;
    String strTaiKhoan, strTenNhaHang, strSoDienThoai, strDiaChi, strAnh</B></FONT>;
<A NAME="9"></A>
    public ClassNhaHang_View(String strTaiKhoan, String strTenNhaHang, Double doubleKhoangCach, String strSoDienThoai,
                             String strDiaChi, Integer intBinhLuan, Integer intLuotThich, String strAnh){
        <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#9',3,'match0-top.html#9',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>this.strTaiKhoan = strTaiKhoan;
        this.strTenNhaHang = strTenNhaHang;
        this.doubleKhoangCach = doubleKhoangCach;
        this.strSoDienThoai = strSoDienThoai;
        this.strDiaChi = strDiaChi;
        this.intBinhLuan = intBinhLuan;
        this.intLuotThich = intLuotThich;
        this.strAnh = strAnh;
    }

    public String getStrTaiKhoan() {
        return strTaiKhoan;
    }

    public String getStrTenNhaHang() {
        return strTenNhaHang;
    }

    public Double getDoubleKhoangCach() {
        return doubleKhoangCach;
    }

    public String getStrSoDienThoai() {
        return strSoDienThoai;
    }

    public String getStrDiaChi() {
        return strDiaChi;
    }

    public Integer getIntBinhLuan() {
        return intBinhLuan;
    }

    public Integer getIntLuotThich() {
        return intLuotThich;
    }

    public String getStrAnh() {
        return strAnh;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>NhaHang\FragmentMonAn_View.java</CENTER></H3><HR>
<PRE>
<A NAME="10"></A><FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#10',3,'match0-top.html#10',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentMonAn_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
<A NAME="11"></A>    ClassConnect classConnect</B></FONT>;
    @SuppressLint(&quot;StaticFieldLeak&quot;)
    public static ClassPublic classPublic = new ClassPublic();
    public static FragmentManager <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#11',3,'match0-top.html#11',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    ImageButton btnQuayLai, btnLienHe;
    TextView textTenNhaHang, textDiaChi;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
<A NAME="12"></A>    public static ArrayList&lt;ClassMonAn_View&gt; arrayListMonAn;
    ListViewMonAn_View adapterMonAn</B></FONT>;
    public static String strTaiKhoan, strMaDiaDiem, strMaTinh, strSoDienThoai, strTenNhaHang;
    ArrayList&lt;<FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#12',3,'match0-top.html#12',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listHienThi = new ArrayList&lt;&gt;();

    @SuppressLint(&quot;NewApi&quot;)
<A NAME="13"></A>    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_monan_view, container, false);
        fragmentManager = Objects</B></FONT>.requireNonNull(<FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#13',3,'match0-top.html#13',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strTaiKhoan = bundle.getString(&quot;TaiKhoan&quot;); //Lấy tài khoản được gửi qua từ FragmentNhaHang_View
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;); //Lấy mã địa điểm được gửi qua từ FragmentNhaHang_View
            strMaTinh = bundle.getString(&quot;MaTinh&quot;); //Lấy mã tỉnh được gửi qua từ FragmentNhaHang_View
<A NAME="14"></A>        }
        else</B></FONT> {
            startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#14',3,'match0-top.html#14',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void layoutAnhXa() {
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnLienHe = view.findViewById(R.id.btnLienHe);
        textTenNhaHang = view.findViewById(R.id.textTenNhaHang);
        textDiaChi = view.findViewById(R.id.textDiaChi);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view</B></FONT>.findViewById(R.id.listView);
        layTenNhaHang(strTaiKhoan);
        loadHienThi();
        clickButton();
<A NAME="15"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#15',3,'match0-top.html#15',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void layTenNhaHang(String taiKhoan) {
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlTenNhaHang = &quot;select CongTy, TenXa, TenHuyen, TenTinh, SoDienThoai from TB_NguoiDung nd, TB_Xa x, TB_Huyen h, TB_Tinh t &quot; +
                    &quot;where nd.MaXa = x.MaXa and nd.MaHuyen = h.MaHuyen and nd.MaTinh = t.MaTinh and LoaiTaiKhoan = 4 and TaiKhoan = '&quot;+ taiKhoan +&quot;'&quot;;
            ResultSet resultSetTenNhaHang = classConnect.selectData(getActivity(), sqlTenNhaHang);
            if (resultSetTenNhaHang != null &amp;&amp; resultSetTenNhaHang.next()){
                strTenNhaHang = resultSetTenNhaHang</B></FONT>.getString(&quot;CongTy&quot;).toUpperCase();
                textTenNhaHang.setText(strTenNhaHang);
                String strDiaChi = resultSetTenNhaHang.getString(&quot;TenXa&quot;);
<A NAME="16"></A>                strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetTenNhaHang.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetTenNhaHang.getString(&quot;TenTinh&quot;));
                textDiaChi.setText(strDiaChi);
                strSoDienThoai = resultSetTenNhaHang.getString(&quot;SoDienThoai&quot;);
            <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#16',3,'match0-top.html#16',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
    }

<A NAME="17"></A>    private void loadHienThi() {
        listHienThi.clear();
        listHienThi</B></FONT>.add(&quot;10&quot;);
        <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#17',3,'match0-top.html#17',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
<A NAME="18"></A>        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#18',3,'match0-top.html#18',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    loadDanhSachMonAn(strTaiKhoan, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        }</B></FONT>);
<A NAME="19"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#19',3,'match0-top.html#19',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadDanhSachMonAn(String taiKhoan, String hienThi) {
        arrayListMonAn = new ArrayList&lt;&gt;();
        arrayListMonAn.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlMonAn;
<A NAME="20"></A>            if</B></FONT> (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlMonAn = &quot;select MaMonAn, Anh, TenMonAn, GiaMonAn, LuotThich from TB_MonAn where TaiKhoan = '&quot; + taiKhoan + &quot;' order by GiaMonAn asc&quot;;
            }
            <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#20',3,'match0-top.html#20',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                sqlMonAn = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; MaMonAn, Anh, TenMonAn, GiaMonAn, LuotThich from TB_MonAn where TaiKhoan = '&quot; + taiKhoan + &quot;' order by GiaMonAn asc&quot;;
            }
            ResultSet resultSetMonAn = classConnect.selectData(getActivity(), sqlMonAn);
<A NAME="21"></A>            if (resultSetMonAn != null){
                while (resultSetMonAn</B></FONT>.next()){
                    int intBinhLuan = 0;
                    String <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#21',3,'match0-top.html#21',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+taiKhoan+&quot;' and MaSo = '&quot;+resultSetMonAn.getInt(&quot;MaMonAn&quot;)+&quot;'&quot;;
<A NAME="22"></A>                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan</B></FONT>.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));                    }
                    <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#22',3,'match0-top.html#22',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>arrayListMonAn.add(new ClassMonAn_View(resultSetMonAn.getInt(&quot;MaMonAn&quot;), resultSetMonAn.getString(&quot;Anh&quot;), resultSetMonAn.getString(&quot;TenMonAn&quot;),
                            resultSetMonAn.getInt(&quot;GiaMonAn&quot;), resultSetMonAn.getInt(&quot;LuotThich&quot;), intBinhLuan));
                }
            }
            if (arrayListMonAn.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách món ăn&quot;);
<A NAME="23"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(<FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#23',3,'match0-top.html#23',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e.getMessage()));
        }
        adapterMonAn = new ListViewMonAn_View(getContext());
        listView.setAdapter(adapterMonAn);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
<A NAME="24"></A>            @Override
            public void</B></FONT> onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (<FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#24',3,'match0-top.html#24',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh.isEmpty()) {
                    FragmentNhaHang_View fragment = new FragmentNhaHang_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                else</B></FONT> {
                    FragmentNhaHang_Home fragment = new FragmentNhaHang_Home();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaDiaDiem&quot;, strMaDiaDiem);
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });

<A NAME="25"></A>        btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#25',3,'match0-top.html#25',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (strSoDienThoai.length() != 0) {
                    //Hiện hộp thoại thông báo
                    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
                    builder.setTitle(&quot;THÔNG BÁO&quot;);
                    builder.setMessage(&quot;Bạn muốn gọi cho &quot; + strTenNhaHang);
                    builder.setCancelable(false);
                    builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                        @SuppressLint(&quot;NewApi&quot;)
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            Objects.requireNonNull(getActivity()).startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + strSoDienThoai)));
                        }
                    });
                    builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            //Đóng hộp thoại thông báo
                            dialogInterface.dismiss();
                        }
                    });
                    AlertDialog alertDialog = builder.create();
<A NAME="26"></A>                    alertDialog.show();
                }
                else {
                    classPublic.ThongBao(<FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#26',3,'match0-top.html#26',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(),&quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                }
            }
        });
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterMonAn.filter(newText);
        return false;
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>NhaHang\FragmentNhaHang_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="27"></A>package com.example.travelling.NhaHang;

<FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#27',3,'match0-top.html#27',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.Menu.FragmentListMenu;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;
import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;
import static java.util.Objects.requireNonNull;

public class FragmentNhaHang_Edit extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();
    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;
    FragmentManager fragmentManager</B></FONT>; //Tạo Fragment
    FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ImageButton btnThemMoi, btnQuayLai;
    ListView listView;
    public static ArrayList&lt;ClassNhaHang_Edit&gt; arrayListNhaHang;
    ListViewNhaHang_Edit adapterNhaHang;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
<A NAME="28"></A>    String strTaiKhoan, strHienThi;
    //Khai báo các đối tượng trên dialog
    TextView textTieuDe;
    EditText <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#28',3,'match0-top.html#28',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editMaMonAn, editTenMonAn, editGiaMonAn;
    Button btnLuuLai, btnXoa, btnDong;

    @SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_nhahang_edit, container, false);
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor.apply();
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager();
        strTaiKhoan = sharedpreferences</B></FONT>.getString(User,&quot;&quot;);
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
<A NAME="29"></A>    }

    private void layoutAnhXa() {
        <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#29',3,'match0-top.html#29',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        btnThemMoi = view.findViewById(R.id.btnThemMoi);
        listView = view.findViewById(R.id.listView);
        loadHienThi();
        clickButton();
        clickListView();
    }

    private void</B></FONT> loadHienThi() {
        listHienThi.clear();
<A NAME="30"></A>        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        <FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#30',3,'match0-top.html#30',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="31"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter</B></FONT>&lt;&gt;(Objects.requireNonNull(<FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#31',3,'match0-top.html#31',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachMonAn(strTaiKhoan, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void</B></FONT> loadDanhSachMonAn(String taiKhoan, String hienThi) {
        arrayListNhaHang = new ArrayList&lt;&gt;();
        arrayListNhaHang.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlNhaHang;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlNhaHang = &quot;select * from TB_MonAn where TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
<A NAME="32"></A>            else {
                sqlNhaHang = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; * from TB_MonAn where TaiKhoan = '&quot; + taiKhoan + &quot;'&quot;;
            }
            ResultSet <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#32',3,'match0-top.html#32',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetNhaHang = classConnect.selectData(getActivity(), sqlNhaHang);
            if (resultSetNhaHang != null){
                while (resultSetNhaHang.next()){
                    arrayListNhaHang.add(new ClassNhaHang_Edit(Integer.parseInt(resultSetNhaHang.getString(&quot;MaMonAn&quot;)), resultSetNhaHang.getString(&quot;TenMonAn&quot;),
                            Integer.parseInt(resultSetNhaHang.getString(&quot;GiaMonAn&quot;))));
                }
            }
            if (arrayListNhaHang.isEmpty()){
                classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách món ăn&quot;);
<A NAME="33"></A>            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects</B></FONT>.requireNonNull(<FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#33',3,'match0-top.html#33',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e.getMessage()));
        }
        adapterNhaHang = new ListViewNhaHang_Edit(getContext());
        listView.setAdapter(adapterNhaHang);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterNhaHang.filter(newText);
        return false;
    }

    private void clickButton() {
        btnThemMoi</B></FONT>.setOnClickListener(new View.OnClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                updateMonAn(-1);
            }
        });

        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                fragmentTransaction.replace(R.id.fragment_main, new FragmentListMenu());
                fragmentTransaction.commit();
            }
        });
    }

    private void clickListView() {
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
<A NAME="34"></A>                updateMonAn(position);
            }
        });
    <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#34',3,'match0-top.html#34',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

    private void updateMonAn(final int intChiSo){
        LayoutInflater inflater = getLayoutInflater();
        @SuppressLint(&quot;InflateParams&quot;) View alertLayout = inflater.inflate(R.layout.dialog_nhahang, null);
        textTieuDe = alertLayout.findViewById(R.id.textTieuDe);
        editMaMonAn = alertLayout.findViewById(R.id.editMaMonAn);
        editTenMonAn = alertLayout.findViewById(R.id.editTenMonAn);
        editGiaMonAn = alertLayout.findViewById(R.id.editGiaMonAn);
        btnLuuLai = alertLayout.findViewById(R.id.btnLuuLai);
        btnXoa = alertLayout.findViewById(R.id.btnXoa);
        btnDong = alertLayout.findViewById(R.id.btnDong);
        final AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());
        alert.setView(alertLayout);
        alert.setCancelable(false);
        final AlertDialog dialog = alert.create();
        if (intChiSo == -1){
<A NAME="35"></A>            btnXoa.setEnabled(false); //Không cho phép nhấn nút xóa
            String strTieuDe = &quot;THÊM MỚI TÊN MÓN ĂN&quot;;
            textTieuDe</B></FONT>.setText(strTieuDe);
            String <FONT color="#41a317"><A HREF="javascript:ZweiFrames('match0-1.html#35',3,'match0-top.html#35',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strNut = &quot;THÊM MỚI&quot;; //Đổi text nút lưu lại thành thêm mới
            btnLuuLai.setText(strNut);
        }
        else {
            btnXoa.setEnabled(true); //Cho phép nhấn nút xóa
            String strTieuDe = &quot;CẬP NHẬT TÊN MÓN ĂN&quot;;
            textTieuDe.setText(strTieuDe);
            String strNut = &quot;CẬP NHẬT&quot;; //Đổi text nút lưu lại thành cập nhật
            btnLuuLai.setText(strNut);
            editMaMonAn.setText(String.valueOf(arrayListNhaHang.get(intChiSo).getIntMaMonAn())); //Gán giá trị mã món ăn
            editTenMonAn.setText(arrayListNhaHang.get(intChiSo).getStrTenMonAn()); //Gán giá trị tên món ăn
            editGiaMonAn.setText(String.valueOf(arrayListNhaHang</B></FONT>.get(intChiSo).getIntGiaMonAn())); //Gán giá trị giá món ăn
        }
        btnLuuLai.setOnClickListener(new View.OnClickListener() {
<A NAME="36"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                <FONT color="#ff00ff"><A HREF="javascript:ZweiFrames('match0-1.html#36',3,'match0-top.html#36',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    if (editTenMonAn.getText().length() != 0){
                        if (editGiaMonAn.getText().length() != 0){
<A NAME="37"></A>                            String sqlMonAn;
                            if (intChiSo == -1){ //Thêm mới
                                sqlMonAn</B></FONT> = &quot;insert into TB_MonAn(TaiKhoan, TenMonAn, GiaMonAn) &quot; +
                                        &quot;values ('&quot;+ strTaiKhoan +&quot;', N'&quot;+ <FONT color="#810541"><A HREF="javascript:ZweiFrames('match0-1.html#37',3,'match0-top.html#37',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>editTenMonAn.getText() +&quot;', '&quot;+ Integer.parseInt(editGiaMonAn.getText().toString()) +&quot;')&quot;;
                            }
                            else { //Cập nhật
                                sqlMonAn = &quot;update TB_MonAn set TenMonAn = N'&quot;+ editTenMonAn.getText() +&quot;', GiaMonAn = '&quot;+ Integer.parseInt(editGiaMonAn.getText().toString())+&quot;' &quot; +
                                        &quot;where MaMonAn = '&quot;+ Integer.parseInt(editMaMonAn.getText().toString()) +&quot;'&quot;;
                            }
                            classConnect = new ClassConnect(); //Mở kết nối SQL
                            if (classConnect.updateData(getActivity(), sqlMonAn) == 1){
                                if (intChiSo == -1){
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Thêm mới tên món ăn thành công&quot;);
                                }
                                else {
                                    classPublic.ThongBao(getActivity(),&quot;Thông báo! Cập nhật tên món ăn thành công&quot;);
                                }
                                dialog.cancel(); //Đóng dialog
                                loadDanhSachMonAn</B></FONT>(strTaiKhoan, strHienThi); //Load lại danh sách
                            }
                            else {
                                classPublic.ThongBao(getActivity(), &quot;Lỗi! Không lưu được&quot;);
<A NAME="38"></A>                            }
                            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                        }
                        <FONT color="#348781"><A HREF="javascript:ZweiFrames('match0-1.html#38',3,'match0-top.html#38',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
                            classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập giá món ăn&quot;);
                        }
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Vui lòng nhập tên món ăn&quot;);
                    }
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
                }
            }
        });
<A NAME="39"></A>        btnXoa.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#152dc6"><A HREF="javascript:ZweiFrames('match0-1.html#39',3,'match0-top.html#39',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (editMaMonAn.getText().length() != 0) {
                    dialogXoa(editMaMonAn.getText().toString(), editTenMonAn.getText().toString());
                    dialog.cancel();
                }
                else {
                    classPublic.ThongBao(getActivity(),&quot;Lỗi! Không tìm thấy mã món ăn để xóa&quot;);
                }</B></FONT>
            }
        });
        btnDong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
<A NAME="40"></A>                dialog.cancel();
            }
        });
        <FONT color="#347235"><A HREF="javascript:ZweiFrames('match0-1.html#40',3,'match0-top.html#40',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>dialog.show(); //Show giao diện cập nhật danh sách tỉnh
    }

    private void dialogXoa(final String maMonAn, final String tenMonAn){
        //Hiện hộp thoại thông báo xóa tên món ăn
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(&quot;XÓA TÊN MÓN ĂN&quot;);
        builder.setMessage(&quot;Bạn có muốn xóa tên món ăn: &quot; + tenMonAn.toUpperCase() +&quot; không?&quot;);
        builder.setCancelable(false);
        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
<A NAME="41"></A>            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                <FONT color="#f87a17"><A HREF="javascript:ZweiFrames('match0-1.html#41',3,'match0-top.html#41',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
                    classConnect = new ClassConnect(); //Mở kết nối SQL
                    String sqlTourDuLich = &quot;delete TB_MonAn where MaMonAn = '&quot;+ maMonAn +&quot;'&quot;;
                    if (classConnect.updateData(getActivity(), sqlTourDuLich) == 1){
                        classPublic.ThongBao(getActivity(),&quot;Thông báo! Xóa tên món ăn thành công&quot;);
                        loadDanhSachMonAn(strTaiKhoan, strHienThi); //Load lại danh sách
                    }
                    else {
                        classPublic.ThongBao(getActivity(),&quot;Lỗi! Không xóa được tên món ăn&quot;);
                    }
                    classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
                }catch (Exception e){
                    Log.e(&quot;TAG&quot;, requireNonNull</B></FONT>(e.getMessage()));
                }
            }
        });
        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                dialogInterface.dismiss();
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }
}
</PRE>
<HR>
<H3><CENTER>NhaHang\FragmentNhaHang_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="42"></A>package com.example.travelling.NhaHang;

<FONT color="#c57717"><A HREF="javascript:ZweiFrames('match0-1.html#42',3,'match0-top.html#42',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

import static com.example.travelling.MainActivity.MyPREFERENCES;
import static com.example.travelling.MainActivity.User;

public class FragmentNhaHang_Home extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khái báo
    View view;
    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic</B></FONT>();
    public static FragmentManager fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdTinh, cmdHienThi;
    SearchView searchView;
<A NAME="43"></A>    ListView listView;
    public static ArrayList&lt;ClassNhaHang_Home&gt; arrayListNhaHang;
    ListViewNhaHang_Home adapterNhaHang;
    ArrayList&lt;<FONT color="#c22817"><A HREF="javascript:ZweiFrames('match0-1.html#43',3,'match0-top.html#43',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String&gt; listMaTinh = new ArrayList&lt;&gt;(); //Khai báo danh sách tỉnh
    ArrayList&lt;String&gt; listTenTinh = new ArrayList&lt;&gt;();
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();
    public static String strMaTinh, ganMaTinh, strHienThi, mMaTinh;
    int intDieuKien</B></FONT> = 0;
<A NAME="44"></A>    SharedPreferences sharedpreferences; //Nhớ tài khoản
    SharedPreferences.Editor editor;

    <FONT color="#e57ded"><A HREF="javascript:ZweiFrames('match0-1.html#44',3,'match0-top.html#44',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_nhahang_home, container, false);
        fragmentManager = Objects.requireNonNull(getActivity()).getSupportFragmentManager(); //Quản lý Fragment
        sharedpreferences = Objects.requireNonNull(this.getActivity()).getSharedPreferences(MyPREFERENCES, Context.MODE_PRIVATE);
        editor = sharedpreferences.edit();
        editor</B></FONT>.apply();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            ganMaTinh = bundle.getString(&quot;MaTinh&quot;); ////Lấy mã tỉnh được gửi qua từ FragmentNhaHang_View
        }
        else {
            ganMaTinh = &quot;&quot;;
        }
        mMaTinh = classPublic.layMaTinh(sharedpreferences.getString(User,&quot;&quot;), getActivity());
        layoutAnhXa(); //Ánh xạ các đối tượng trên layout
        return view;
    }

    private void layoutAnhXa() {
<A NAME="45"></A>        cmdTinh = view.findViewById(R.id.cmdTinh);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = <FONT color="#79d867"><A HREF="javascript:ZweiFrames('match0-1.html#45',3,'match0-top.html#45',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>view.findViewById(R.id.listView);
        loadTinh(); //Load tên tỉnh
        loadHienThi();
    }

    @SuppressLint(&quot;NewApi&quot;)
    private void loadTinh(){
        listMaTinh.clear(); // Xóa danh sách tỉnh
        listTenTinh.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối SQL
            String sqlTinh = &quot;select MaTinh, TenTinh from TB_Tinh&quot;;
            ResultSet resultSetTinh = classConnect.selectData(getActivity(), sqlTinh);
            if (resultSetTinh != null){
                while (resultSetTinh.next()){
                    listMaTinh.add(resultSetTinh.getString(&quot;MaTinh&quot;));
                    listTenTinh.add(resultSetTinh.getString(&quot;TenTinh&quot;));
                }
                ArrayAdapter&lt;String&gt; dataTinh = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listTenTinh);
                dataTinh</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
<A NAME="46"></A>                cmdTinh.setAdapter(dataTinh);
            }
            if(listMaTinh.isEmpty()) {
                classPublic.ThongBao(<FONT color="#92c7c7"><A HREF="javascript:ZweiFrames('match0-1.html#46',3,'match0-top.html#46',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity(), &quot;Thông báo! Đang cập nhật danh sách tỉnh/thành phố&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        cmdTinh.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listMaTinh</B></FONT>.isEmpty()) {
                    if (ganMaTinh.equals(&quot;&quot;) &amp;&amp; intDieuKien == 0){
                        cmdTinh.setSelection(listMaTinh.indexOf(mMaTinh));
                        intDieuKien = 1;
                    }
                    if (!ganMaTinh.equals(&quot;&quot;)){
                        cmdTinh.setSelection(listMaTinh.indexOf(ganMaTinh));
<A NAME="47"></A>                        ganMaTinh = &quot;&quot;;
                    }
                    strMaTinh = listMaTinh.get(position);
                    <FONT color="#d16587"><A HREF="javascript:ZweiFrames('match0-1.html#47',3,'match0-top.html#47',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>loadDanhSachNhaHang(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
    }

    private void loadHienThi() {
        listHienThi.clear();
        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
<A NAME="48"></A>        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi</B></FONT>.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(<FONT color="#c57726"><A HREF="javascript:ZweiFrames('match0-1.html#48',3,'match0-top.html#48',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!listHienThi.isEmpty()) {
                    strHienThi = listHienThi.get(position);
                    loadDanhSachNhaHang(strMaTinh, strHienThi);
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        });
<A NAME="49"></A>    }</B></FONT>

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#8e35ef"><A HREF="javascript:ZweiFrames('match0-1.html#49',3,'match0-top.html#49',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadDanhSachNhaHang(String maTinh, String hienThi) {
        arrayListNhaHang = new ArrayList&lt;&gt;();
        arrayListNhaHang.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlNhaHang</B></FONT>;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlNhaHang = &quot;select TenXa, TenHuyen, TenTinh, TaiKhoan, t.MaTinh, CongTy, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and &quot; +
                        &quot;nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 4 order by nd.LuotThich desc&quot;;
            }
            else {
                sqlNhaHang = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, TaiKhoan, t.MaTinh, CongTy, SoDienThoai, LuotThich, Anh &quot; +
<A NAME="50"></A>                        &quot;from TB_NguoiDung nd, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and &quot; +
                        &quot;nd.MaXa = x.MaXa and nd.MaTinh = '&quot; + maTinh + &quot;' and LoaiTaiKhoan = 4 order by nd.LuotThich desc&quot;;
            }
            ResultSet <FONT color="#ff0000"><A HREF="javascript:ZweiFrames('match0-1.html#50',3,'match0-top.html#50',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>resultSetNhaHang = classConnect.selectData(getActivity(), sqlNhaHang);
            if (resultSetNhaHang != null){
                while (resultSetNhaHang.next()){
                    String strDiaChi = resultSetNhaHang.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetNhaHang.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetNhaHang</B></FONT>.getString(&quot;TenTinh&quot;));
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetNhaHang.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListNhaHang.add(new ClassNhaHang_Home(resultSetNhaHang.getString(&quot;TaiKhoan&quot;), resultSetNhaHang.getString(&quot;MaTinh&quot;),
                            resultSetNhaHang.getString(&quot;CongTy&quot;), resultSetNhaHang.getString(&quot;SoDienThoai&quot;),
                            strDiaChi, intBinhLuan, Integer.parseInt(resultSetNhaHang.getString(&quot;LuotThich&quot;)), resultSetNhaHang.getString(&quot;Anh&quot;)));
<A NAME="51"></A>                }
            }
            if (arrayListNhaHang.isEmpty()){
                <FONT color="#b38481"><A HREF="javascript:ZweiFrames('match0-1.html#51',3,'match0-top.html#51',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách nhà hàng&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        adapterNhaHang = new ListViewNhaHang_Home(getContext());
        listView.setAdapter(adapterNhaHang);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) {
        adapterNhaHang.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\FragmentNhaHang_View.java</CENTER></H3><HR>
<PRE>
<A NAME="52"></A>package com.example.travelling.NhaHang;

<FONT color="#2b60de"><A HREF="javascript:ZweiFrames('match0-1.html#52',3,'match0-top.html#52',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.annotation.SuppressLint;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.SearchView;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.DiaDiemYeuThichFragment;
import com.example.travelling.DiaDiem.FragmentDiaDiem_View;
import com.example.travelling.Home.MainHomeActivity;
import com.example.travelling.R;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Objects;

public class FragmentNhaHang_View extends Fragment implements SearchView.OnQueryTextListener{

    //Phần khai báo
    View view;
<A NAME="53"></A>    ClassConnect classConnect</B></FONT>;
    @SuppressLint(&quot;StaticFieldLeak&quot;)
    public static ClassPublic classPublic = new ClassPublic();
    public static FragmentManager <FONT color="#f88158"><A HREF="javascript:ZweiFrames('match0-1.html#53',3,'match0-top.html#53',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>fragmentManager; //Tạo Fragment
    public static FragmentTransaction fragmentTransaction;
    Spinner cmdHienThi;
    SearchView searchView;
    ListView listView;
    TextView textDiaDiem;
    public static String strMaDiaDiem, strMaTinh;
    ImageButton btnQuayLai;
    public static ArrayList&lt;ClassNhaHang_View&gt; arrayListNhaHang;
<A NAME="54"></A>    ListViewNhaHang_View adapterNhaHang</B></FONT>;
    ArrayList&lt;String&gt; listHienThi = new ArrayList&lt;&gt;();

    <FONT color="#4e8975"><A HREF="javascript:ZweiFrames('match0-1.html#54',3,'match0-top.html#54',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>@SuppressLint(&quot;NewApi&quot;)
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        view = inflater.inflate(R.layout.fragment_nhahang_view, container, false);
        fragmentManager = Objects.requireNonNull(getActivity</B></FONT>()).getSupportFragmentManager();
        Bundle bundle = this.getArguments();
        if (bundle != null) {
            strMaDiaDiem = bundle.getString(&quot;MaDiaDiem&quot;);
<A NAME="55"></A>            strMaTinh = bundle.getString(&quot;MaTinh&quot;);
        }
        else {
            <FONT color="#4863a0"><A HREF="javascript:ZweiFrames('match0-1.html#55',3,'match0-top.html#55',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>startActivity(new Intent(getActivity(), MainHomeActivity.class)); //Về trang home
        }
        layoutAnhXa();
        return view;
    }

    private void layoutAnhXa() {
        textDiaDiem = view.findViewById(R.id.textDiaDiem);
        cmdHienThi = view.findViewById(R.id.cmdHienThi);
        searchView = view.findViewById(R.id.searchTen);
        listView = view</B></FONT>.findViewById(R.id.listView);
        btnQuayLai = view.findViewById(R.id.btnQuayLai);
        layTenDiaDiem(strMaDiaDiem); //Lấy tên địa điểm du lịch
        loadHienThi();
        clickButton();
    }
<A NAME="56"></A>
    @SuppressLint(&quot;NewApi&quot;)
    private void layTenDiaDiem(String maDiaDiem) {
        <FONT color="#52d017"><A HREF="javascript:ZweiFrames('match0-1.html#56',3,'match0-top.html#56',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlDiaDiem = &quot;select TenDiaDiem from TB_DiaDiem where MaDiaDiem = '&quot;+ maDiaDiem +&quot;'&quot;;
<A NAME="57"></A>            ResultSet resultSetDiaDiem = classConnect.selectData(getActivity(), sqlDiaDiem);
            if (resultSetDiaDiem != null &amp;&amp; resultSetDiaDiem.next()){
                textDiaDiem.setText(resultSetDiaDiem</B></FONT>.getString(&quot;TenDiaDiem&quot;).toUpperCase());
            <FONT color="#980517"><A HREF="javascript:ZweiFrames('match0-1.html#57',3,'match0-top.html#57',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }</B></FONT>
    }

    private void loadHienThi() {
        listHienThi.clear();
<A NAME="58"></A>        listHienThi.add(&quot;10&quot;);
        listHienThi.add(&quot;20&quot;);
        listHienThi.add(&quot;30&quot;);
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#58',3,'match0-top.html#58',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.add(&quot;40&quot;);
        listHienThi.add(&quot;50&quot;);
        listHienThi.add(&quot;100&quot;);
        listHienThi.add(&quot;200&quot;);
        listHienThi.add(&quot;500&quot;);
        listHienThi.add(&quot;Tất cả&quot;);
        ArrayAdapter&lt;String&gt; dataHienThi = new ArrayAdapter&lt;&gt;(Objects.requireNonNull(getActivity()), android.R.layout.simple_spinner_item,listHienThi);
        dataHienThi</B></FONT>.setDropDownViewResource(android.R.layout.simple_list_item_single_choice);
        cmdHienThi.setAdapter(dataHienThi);
<A NAME="59"></A>        cmdHienThi.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) {
                if (!<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#59',3,'match0-top.html#59',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>listHienThi.isEmpty()) {
                    loadDanhSachNhaHang(strMaDiaDiem, listHienThi.get(position));
                }
            }

            @Override
            public void onNothingSelected(AdapterView&lt;?&gt; parent) {

            }
        }</B></FONT>);
    }

    private void clickButton() {
        btnQuayLai.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                fragmentTransaction = fragmentManager.beginTransaction();
                if (strMaTinh.equals(&quot;&quot;)){
                    fragmentTransaction.replace(R.id.fragment_main, new DiaDiemYeuThichFragment());
                }
                else {
                    FragmentDiaDiem_View fragment = new FragmentDiaDiem_View();
                    Bundle bundle = new Bundle();
                    bundle.putString(&quot;MaTinh&quot;, strMaTinh);
                    fragment.setArguments(bundle);
                    fragmentTransaction.replace(R.id.fragment_main, fragment);
                }
                fragmentTransaction.commit();
            }
        });
<A NAME="60"></A>    }

    @SuppressLint(&quot;NewApi&quot;)
    private <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match0-1.html#60',3,'match0-top.html#60',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void loadDanhSachNhaHang(String maDiaDiem, String hienThi) {
        arrayListNhaHang = new ArrayList&lt;&gt;();
        arrayListNhaHang.clear();
        try{
            classConnect = new ClassConnect(); //Mở kết nối đến SQL
            String sqlNhaHang</B></FONT>;
            if (hienThi.equals(&quot;Tất cả&quot;)) {
                sqlNhaHang = &quot;select TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, KhoangCach, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_KinhDoanhGan kdg, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = kdg.TaiKhoan and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and kdg.MaDiaDiem = '&quot; + maDiaDiem + &quot;' and LoaiTaiKhoan = 4 order by kdg.KhoangCach asc&quot;;
            }
            else {
                sqlNhaHang = &quot;select top &quot;+Integer.parseInt(hienThi)+&quot; TenXa, TenHuyen, TenTinh, nd.TaiKhoan, CongTy, KhoangCach, SoDienThoai, LuotThich, Anh &quot; +
                        &quot;from TB_NguoiDung nd, TB_KinhDoanhGan kdg, TB_Tinh t, TB_Huyen h, TB_Xa x where nd.TaiKhoan = kdg.TaiKhoan and &quot; +
                        &quot;nd.MaTinh = t.MaTinh and nd.MaHuyen = h.MaHuyen and nd.MaXa = x.MaXa and kdg.MaDiaDiem = '&quot; + maDiaDiem + &quot;' and LoaiTaiKhoan = 4 order by kdg.KhoangCach asc&quot;;
            }
            ResultSet resultSetNhaHang = classConnect.selectData(getActivity(), sqlNhaHang);
            if (resultSetNhaHang != null){
                while (resultSetNhaHang.next()){
                    String strDiaChi = resultSetNhaHang.getString(&quot;TenXa&quot;);
                    strDiaChi = strDiaChi.concat(&quot; - &quot; + resultSetNhaHang.getString(&quot;TenHuyen&quot;) + &quot; - &quot; + resultSetNhaHang.getString(&quot;TenTinh&quot;));
                    int intBinhLuan = 0;
                    String sqlBinhLuan = &quot;select count(*) as binhluan from TB_BinhLuan where TaiKhoan = '&quot;+resultSetNhaHang.getString(&quot;TaiKhoan&quot;)+&quot;'&quot;;
                    ResultSet resultSetBinhLuan = classConnect.selectData(getActivity(), sqlBinhLuan);
                    if (resultSetBinhLuan != null &amp;&amp; resultSetBinhLuan.next()){
                        intBinhLuan = Integer.parseInt(resultSetBinhLuan.getString(&quot;binhluan&quot;));
                    }
                    arrayListNhaHang.add(new ClassNhaHang_View(resultSetNhaHang.getString(&quot;TaiKhoan&quot;), resultSetNhaHang.getString(&quot;CongTy&quot;),
                            Double.parseDouble(resultSetNhaHang.getString(&quot;KhoangCach&quot;)), resultSetNhaHang.getString(&quot;SoDienThoai&quot;),
                            strDiaChi, intBinhLuan, Integer.parseInt(resultSetNhaHang.getString(&quot;LuotThich&quot;)), resultSetNhaHang.getString(&quot;Anh&quot;)));
<A NAME="61"></A>                }
            }
            if (arrayListNhaHang.isEmpty()){
                <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match0-1.html#61',3,'match0-top.html#61',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic.ThongBao(getActivity(),&quot;Thông báo! Đang cập nhật danh sách quán ăn/nhà hàng&quot;);
            }
            classConnect.CONN(getActivity()).close(); //Đóng kết nối đến SQL
        }catch (Exception e){
            Log.e(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
        }
        adapterNhaHang = new ListViewNhaHang_View(getContext());
        listView.setAdapter(adapterNhaHang);
        //Xử lý khi nhập vào ô tìm kiếm
        searchView.setOnQueryTextListener(this);
    }

    @Override
    public boolean onQueryTextSubmit(String query) {
        return false;
    }

    @Override
    public boolean onQueryTextChange(String newText) { //Tìm theo tên địa điểm du lịch
        adapterNhaHang.filter(newText);
        return false;
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ListViewMonAn_View.java</CENTER></H3><HR>
<PRE>
<A NAME="62"></A><FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match0-1.html#62',3,'match0-top.html#62',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.example.travelling.NhaHang;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.net.ConnectivityManager;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLPhongFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewMonAn_View extends BaseAdapter {

<A NAME="63"></A>    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassMonAn_View&gt; arraylist;
    ClassConnect <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match0-1.html#63',3,'match0-top.html#63',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classConnect;

    public ListViewMonAn_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentMonAn_View.arrayListMonAn);
    }
    public static class ViewHolder {
        ImageView imageMonAn;
        TextView textTenMonAn, textGiaMonAn, textLuotThich, textBinhLuan;
        ImageButton btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentMonAn_View.arrayListMonAn.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentMonAn_View.arrayListMonAn.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewMonAn_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewMonAn_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_monan_view, null);
            holder.imageMonAn = convertView.findViewById(R.id.imageMonAn);
            holder.textTenMonAn = convertView.findViewById(R.id.textTenMonAn);
            holder.textGiaMonAn = convertView.findViewById(R.id.textGiaMonAn);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            convertView.setTag(holder);
        } else {
            holder = (ListViewMonAn_View.ViewHolder) convertView.getTag();
        }

<A NAME="64"></A>        String strAnh = FragmentMonAn_View</B></FONT>.arrayListMonAn.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match0-1.html#64',3,'match0-top.html#64',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager.getActiveNetworkInfo().isConnected()) {
                FragmentMonAn_View.classPublic = new ClassPublic();
                FragmentMonAn_View.classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageMonAn); //Load ảnh món ăn từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }</B></FONT>
        }
        else {
            holder.imageMonAn.setImageResource(R.drawable.no_image);
        }
<A NAME="65"></A>
        holder.textTenMonAn.setText((position + 1) + &quot;. &quot; + FragmentMonAn_View.arrayListMonAn.get(position).getStrTenMonAn());
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match0-1.html#65',3,'match0-top.html#65',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textGiaMonAn.setText(&quot;Giá: &quot; + formatter.format(FragmentMonAn_View.arrayListMonAn.get(position).getIntGiaMonAn()) + &quot;đ&quot;);
        final Integer[] intThich = {FragmentMonAn_View.arrayListMonAn.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;);
        holder</B></FONT>.textBinhLuan.setText(FragmentMonAn_View.arrayListMonAn.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
<A NAME="66"></A>                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    Integer intMaMonAn = FragmentMonAn_View.arrayListMonAn.get(position).getIntMaMonAn();
                    String sqlThich = &quot;update TB_MonAn set LuotThich = '&quot;+(++intThich[0])+&quot;' where MaMonAn = '&quot;+ intMaMonAn +&quot;'&quot;;
                    <FONT color="#bce954"><A HREF="javascript:ZweiFrames('match0-1.html#66',3,'match0-top.html#66',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }</B></FONT>
            }
        });

<A NAME="67"></A>        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String <FONT color="#f88017"><A HREF="javascript:ZweiFrames('match0-1.html#67',3,'match0-top.html#67',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strMaTinh = FragmentMonAn_View.strMaTinh;
                String strMaDiaDiem = FragmentMonAn_View.strMaDiaDiem;
                String strTaiKhoan = FragmentMonAn_View.strTaiKhoan;
                String strTenMonAn = FragmentMonAn_View</B></FONT>.arrayListMonAn.get(position).getStrTenMonAn();
                Integer intMaMonAn = FragmentMonAn_View.arrayListMonAn.get(position).getIntMaMonAn();
                FragmentMonAn_View.fragmentTransaction = FragmentMonAn_View.fragmentManager.beginTransaction();
                FragmentMonAn_View.fragmentTransaction.replace(R.id.fragment_main, BLPhongFragment.newInstance(strMaTinh, strMaDiaDiem, strTenMonAn, strTaiKhoan, intMaMonAn,2));
                FragmentMonAn_View.fragmentTransaction.commit();
<A NAME="68"></A>            }
        });

        <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match0-1.html#68',3,'match0-top.html#68',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentMonAn_View.arrayListMonAn.clear();
        if (charText.length() == 0) {
            FragmentMonAn_View.arrayListMonAn.addAll(arraylist);
        } else {
            for (ClassMonAn_View wp : arraylist) {
                if (wp.getStrTenMonAn().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentMonAn_View.arrayListMonAn.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ListViewNhaHang_Edit.java</CENTER></H3><HR>
<PRE>
<A NAME="69"></A>package com.example.travelling.NhaHang;

import android.annotation.SuppressLint;
<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match0-1.html#69',3,'match0-top.html#69',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import com.example.travelling.R;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Locale;

public class ListViewNhaHang_Edit extends BaseAdapter {

    Context mContext;
    LayoutInflater inflater;
    ArrayList&lt;ClassNhaHang_Edit&gt; arraylist;

    public ListViewNhaHang_Edit(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentNhaHang_Edit.arrayListNhaHang);
    }

    public static class ViewHolder {
        TextView textTenMonAn, textGiaMonAn;
    }

    @Override
    public int getCount() {
        return FragmentNhaHang_Edit.arrayListNhaHang.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentNhaHang_Edit.arrayListNhaHang.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;})
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ListViewNhaHang_Edit.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewNhaHang_Edit.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_nhahang_edit, null);
            holder.textTenMonAn = convertView.findViewById(R.id.textTenMonAn);
            holder.textGiaMonAn = convertView.findViewById(R.id.textGiaMonAn);
            convertView.setTag(holder);
        } else {
            holder = (ListViewNhaHang_Edit.ViewHolder) convertView.getTag();
        }
<A NAME="70"></A>
        holder.textTenMonAn.setText((position + 1) + &quot;. &quot; + FragmentNhaHang_Edit</B></FONT>.arrayListNhaHang.get(position).getStrTenMonAn());
        DecimalFormat formatter = new DecimalFormat(&quot;###,###,###&quot;);
        <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match0-1.html#70',3,'match0-top.html#70',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textGiaMonAn.setText(&quot;Giá món ăn: &quot; + formatter.format(FragmentNhaHang_Edit.arrayListNhaHang.get(position).getIntGiaMonAn()) + &quot;đ&quot;);
        return convertView;
    }

    public void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentNhaHang_Edit.arrayListNhaHang.clear();
        if (charText.length() == 0) {
            FragmentNhaHang_Edit.arrayListNhaHang.addAll(arraylist);
        } else {
            for (ClassNhaHang_Edit wp : arraylist) {
                if (wp.getStrTenMonAn().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentNhaHang_Edit.arrayListNhaHang.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }
}</B></FONT>
</PRE>
<HR>
<H3><CENTER>NhaHang\ListViewNhaHang_Home.java</CENTER></H3><HR>
<PRE>
<A NAME="71"></A>package com.example.travelling.NhaHang;

import android.annotation.SuppressLint;
<FONT color="#842dce"><A HREF="javascript:ZweiFrames('match0-1.html#71',3,'match0-top.html#71',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.FragmentChiDuong;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewNhaHang_Home extends BaseAdapter {

    //Phần khai báo
    Context mContext;
<A NAME="72"></A>    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassNhaHang_Home&gt; arraylist;
    ClassConnect classConnect;
    ClassPublic <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match0-1.html#72',3,'match0-top.html#72',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>classPublic;

    public ListViewNhaHang_Home(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
        this.arraylist.addAll(FragmentNhaHang_Home.arrayListNhaHang);
    }

    public static class ViewHolder {
        TextView textTenNhaHang, textDiaChi, textLuotThich, textBinhLuan;
        ImageView imageNhaHang;
        ImageButton btnDanhSach, btnLienHe, btnChiDuong, btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentNhaHang_Home.arrayListNhaHang.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentNhaHang_Home.arrayListNhaHang.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;NewApi&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_nhahang_home, null);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.textTenNhaHang = convertView.findViewById(R.id.textTenNhaHang);
            holder.imageNhaHang = convertView.findViewById(R.id.imageNhaHang);
            holder.btnDanhSach = convertView.findViewById(R.id.btnDanhSach);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnLienHe = convertView.findViewById(R.id.btnLienHe);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            convertView.setTag(holder);
        } else {
<A NAME="73"></A>            holder = (ViewHolder) convertView.getTag();
        }</B></FONT>

        <FONT color="#3bb9ff"><A HREF="javascript:ZweiFrames('match0-1.html#73',3,'match0-top.html#73',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTenNhaHang.setText((position + 1) + &quot;. &quot; + FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTenNhaHang().toUpperCase());
<A NAME="74"></A>        String strAnh = FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrAnh();
        if</B></FONT> (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match0-1.html#74',3,'match0-top.html#74',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager.getActiveNetworkInfo().isConnected()) {
                classPublic = new ClassPublic();
                classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageNhaHang); //Load ảnh địa điểm du lịch từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }</B></FONT>
        }
        else {
            holder.imageNhaHang.setImageResource(R.drawable.no_image);
        }

        holder.textDiaChi.setText(FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrDiaChi());
        final Integer[] intThich = {FragmentNhaHang_Home.arrayListNhaHang.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] +&quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentNhaHang_Home.arrayListNhaHang.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="75"></A>        holder.btnDanhSach.setOnClickListener(new View.OnClickListener() { //Click nút nhà hàng
            @Override
            public void onClick(View v) {
                <FONT color="#800517"><A HREF="javascript:ZweiFrames('match0-1.html#75',3,'match0-top.html#75',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_Home.fragmentTransaction = FragmentNhaHang_Home.fragmentManager.beginTransaction();
                FragmentMonAn_View fragment = new FragmentMonAn_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;,&quot;&quot;);
                bundle.putString(&quot;MaTinh&quot;, FragmentNhaHang_Home.strMaTinh);
                bundle.putString(&quot;TaiKhoan&quot;, FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTaiKhoan());
                bundle.putInt(&quot;DieuKien&quot;, 2);
                fragment.setArguments(bundle);
                FragmentNhaHang_Home.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentNhaHang_Home</B></FONT>.fragmentTransaction.commit();
            }
        });


<A NAME="76"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#f62817"><A HREF="javascript:ZweiFrames('match0-1.html#76',3,'match0-top.html#76',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_Home.arrayListNhaHang.get(position) != null) {
                    if (FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTenNhaHang());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="77"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match0-1.html#77',3,'match0-top.html#77',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

<A NAME="78"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#d4a017"><A HREF="javascript:ZweiFrames('match0-1.html#78',3,'match0-top.html#78',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_Home.fragmentTransaction = FragmentNhaHang_Home.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaGan&quot;,&quot;&quot;);
                bundle.putString(&quot;MaDiaDiem&quot;,&quot;&quot;);
                bundle.putString(&quot;MaTinh&quot;, FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrMaTinh());
                bundle.putString(&quot;TaiKhoan&quot;, FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTaiKhoan());
                bundle.putInt(&quot;DieuKien&quot;, 5);
                fragment.setArguments(bundle);
                FragmentNhaHang_Home.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentNhaHang_Home</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

<A NAME="79"></A>        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String <FONT color="#00ff00"><A HREF="javascript:ZweiFrames('match0-1.html#79',3,'match0-top.html#79',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strTaiKhoan = FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTaiKhoan();
                String strTenNhaHang = FragmentNhaHang_Home.arrayListNhaHang.get(position).getStrTenNhaHang();
                String strDiaChi = FragmentNhaHang_Home</B></FONT>.arrayListNhaHang.get(position).getStrDiaChi();
                FragmentNhaHang_Home.fragmentTransaction = FragmentNhaHang_Home.fragmentManager.beginTransaction();
                FragmentNhaHang_Home.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(&quot;&quot;, &quot;&quot;, strTenNhaHang, strDiaChi, strTaiKhoan,2));
                FragmentNhaHang_Home.fragmentTransaction.commit();
            }
        });
<A NAME="80"></A>        return convertView;
    }

    public <FONT color="#4cc417"><A HREF="javascript:ZweiFrames('match0-1.html#80',3,'match0-top.html#80',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentNhaHang_Home.arrayListNhaHang.clear();
        if (charText.length() == 0) {
            FragmentNhaHang_Home.arrayListNhaHang.addAll(arraylist);
        } else {
            for (ClassNhaHang_Home wp : arraylist) {
                if (wp.getStrTenNhaHang().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentNhaHang_Home.arrayListNhaHang.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }</B></FONT>
}
</PRE>
<HR>
<H3><CENTER>NhaHang\ListViewNhaHang_View.java</CENTER></H3><HR>
<PRE>
<A NAME="81"></A>package com.example.travelling.NhaHang;

import android.annotation.SuppressLint;
<FONT color="#f660ab"><A HREF="javascript:ZweiFrames('match0-1.html#81',3,'match0-top.html#81',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;
import com.example.travelling.BinhLuan.BLKhachSanFragment;
import com.example.travelling.Class.ClassConnect;
import com.example.travelling.Class.ClassPublic;
import com.example.travelling.DiaDiem.FragmentChiDuong;
import com.example.travelling.R;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Objects;

public class ListViewNhaHang_View extends BaseAdapter {

    //Phần khai báo
    Context mContext;
    LayoutInflater inflater</B></FONT>;
    ArrayList&lt;ClassNhaHang_View&gt; arraylist;
<A NAME="82"></A>    ClassConnect classConnect;
    ClassPublic classPublic = new ClassPublic();

    public <FONT color="#ada96e"><A HREF="javascript:ZweiFrames('match0-1.html#82',3,'match0-top.html#82',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ListViewNhaHang_View(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(mContext);
        this.arraylist = new ArrayList&lt;&gt;();
<A NAME="83"></A>        this.arraylist.addAll(FragmentNhaHang_View.arrayListNhaHang);
    }</B></FONT>

    public static <FONT color="#87f717"><A HREF="javascript:ZweiFrames('match0-1.html#83',3,'match0-top.html#83',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class ViewHolder {
        TextView textTenNhaHang, textKhoangCach, textSoDienThoai, textDiaChi, textBinhLuan, textLuotThich;
        ImageView imageNhaHang;
        ImageButton btnDanhSach, btnLienHe, btnChiDuong, btnLuotThich, btnBinhLuan;
    }
    @Override
    public int getCount() {
        return FragmentNhaHang_View.arrayListNhaHang.size();
    }

    @Override
    public Object getItem(int position) {
        return FragmentNhaHang_View.arrayListNhaHang.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @SuppressLint({&quot;InflateParams&quot;, &quot;SetTextI18n&quot;, &quot;DefaultLocale&quot;})
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        final ListViewNhaHang_View.ViewHolder holder;
        if (convertView == null) {
            holder = new ListViewNhaHang_View.ViewHolder();
            convertView = inflater.inflate(R.layout.listview_layout_nhahang_view, null);
            holder.textTenNhaHang = convertView.findViewById(R.id.textTenNhaHang);
            holder.textDiaChi = convertView.findViewById(R.id.textDiaChi);
            holder.imageNhaHang = convertView.findViewById(R.id.imageNhaHang);
            holder.textLuotThich = convertView.findViewById(R.id.textLuotThich);
            holder.textBinhLuan = convertView.findViewById(R.id.textBinhLuan);
            holder.btnLuotThich = convertView.findViewById(R.id.btnLuotThich);
            holder.btnBinhLuan = convertView.findViewById(R.id.btnBinhLuan);
            holder.textKhoangCach = convertView.findViewById(R.id.textKhoangCach);
            holder.textSoDienThoai = convertView.findViewById(R.id.textSoDienThoai);
            holder.btnDanhSach = convertView.findViewById(R.id.btnDanhSach);
            holder.btnLienHe = convertView.findViewById(R.id.btnLienHe);
            holder.btnChiDuong = convertView.findViewById(R.id.btnChiDuong);
            convertView.setTag(holder);
        } else {
            holder = (ListViewNhaHang_View.ViewHolder) convertView.getTag();
        }

<A NAME="84"></A>        String strAnh = FragmentNhaHang_View</B></FONT>.arrayListNhaHang.get(position).getStrAnh();
        if (!strAnh.isEmpty() || !strAnh.equals(&quot;&quot;)){
            //Kiểm tra kết nối đến hosting
            ConnectivityManager <FONT color="#95b9c7"><A HREF="javascript:ZweiFrames('match0-1.html#84',3,'match0-top.html#84',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>connectivityManager = (ConnectivityManager) mContext.getSystemService (Context.CONNECTIVITY_SERVICE);
            if(Objects.requireNonNull(connectivityManager).getActiveNetworkInfo() != null &amp;&amp; Objects.requireNonNull(connectivityManager.getActiveNetworkInfo()).isAvailable()
                    &amp;&amp; connectivityManager.getActiveNetworkInfo().isConnected()) {
                FragmentNhaHang_View.classPublic = new ClassPublic();
                FragmentNhaHang_View.classPublic.downloadImage(&quot;http://hoclamaimai.com/&quot; + strAnh, holder.imageNhaHang); //Load ảnh nhà hàng từ host
            }
            else {
                Log.e(&quot;TAG&quot;,&quot;LỖI! Kết nối đến hosting.&quot;);
            }</B></FONT>
        }
        else {
<A NAME="85"></A>            holder.imageNhaHang.setImageResource(R.drawable.no_image);
        }

        <FONT color="#e77471"><A HREF="javascript:ZweiFrames('match0-1.html#85',3,'match0-top.html#85',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>holder.textTenNhaHang.setText((position + 1) + &quot;. &quot; + FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTenNhaHang().toUpperCase());
        Double doubleKhoangCach = FragmentNhaHang_View.arrayListNhaHang.get(position).getDoubleKhoangCach();
<A NAME="86"></A>        if</B></FONT> (doubleKhoangCach &lt; 1000) {
            holder.textKhoangCach.setText(&quot;Cách điểm du lịch: &quot; + String.format(&quot;%.0f&quot;,doubleKhoangCach) +&quot;m (mét)&quot;);
        }
        <FONT color="#717d7d"><A HREF="javascript:ZweiFrames('match0-1.html#86',3,'match0-top.html#86',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>else {
            holder.textKhoangCach.setText(&quot;Cách điểm du lịch: &quot; + doubleKhoangCach/1000 +&quot;km (Kilômét)&quot;);
        }
        holder.textSoDienThoai.setText(&quot;Điện thoại: &quot; + FragmentNhaHang_View.arrayListNhaHang.get(position).getStrSoDienThoai());
        holder.textDiaChi.setText(FragmentNhaHang_View.arrayListNhaHang.get(position).getStrDiaChi());
        final Integer[] intThich = {</B></FONT>FragmentNhaHang_View.arrayListNhaHang.get(position).getIntLuotThich()};
        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;);
        holder.textBinhLuan.setText(FragmentNhaHang_View.arrayListNhaHang.get(position).getIntBinhLuan() + &quot; bình luận&quot;);

<A NAME="87"></A>        holder.btnDanhSach.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#faafba"><A HREF="javascript:ZweiFrames('match0-1.html#87',3,'match0-top.html#87',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_View.fragmentTransaction = FragmentNhaHang_View.fragmentManager.beginTransaction();
                FragmentMonAn_View fragment = new FragmentMonAn_View();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;MaDiaDiem&quot;, FragmentNhaHang_View.strMaDiaDiem);
                bundle.putString(&quot;MaTinh&quot;, FragmentNhaHang_View.strMaTinh);
                bundle.putString(&quot;TaiKhoan&quot;, FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTaiKhoan());
                fragment.setArguments(bundle);
                FragmentNhaHang_View</B></FONT>.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentNhaHang_View.fragmentTransaction.commit();
            }
        });

<A NAME="88"></A>        holder.btnLienHe.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (<FONT color="#f9966b"><A HREF="javascript:ZweiFrames('match0-1.html#88',3,'match0-top.html#88',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_View.arrayListNhaHang.get(position) != null) {
                    if (FragmentNhaHang_View.arrayListNhaHang.get(position).getStrSoDienThoai().length() != 0) {
                        //Hiện hộp thoại thông báo
                        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
                        builder.setTitle(&quot;THÔNG BÁO&quot;);
                        builder.setMessage(&quot;Bạn muốn gọi cho &quot; + FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTenNhaHang());
                        builder.setCancelable(false);
                        builder</B></FONT>.setPositiveButton(&quot;Đồng ý&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                mContext.startActivity(new Intent(Intent.ACTION_DIAL, Uri.parse(&quot;tel: &quot; + FragmentNhaHang_View.arrayListNhaHang.get(position).getStrSoDienThoai())));
                            }
                        });
                        builder.setNegativeButton(&quot;Hủy bỏ&quot;, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Đóng hộp thoại thông báo
<A NAME="89"></A>                                dialogInterface.dismiss();
                            }
                        });
                        AlertDialog <FONT color="#3ea99f"><A HREF="javascript:ZweiFrames('match0-1.html#89',3,'match0-top.html#89',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>alertDialog = builder.create();
                        alertDialog.show();
                    }
                    else {
                        classPublic.ThongBao((Activity)mContext, &quot;Thông báo! Đang cập nhật số điện thoại.&quot;);
                    }
                }
                else {
                    classPublic.ThongBao((Activity)mContext,&quot;Thông báo! Đang cập nhật dữ liệu.&quot;);
                }</B></FONT>
            }
        });

<A NAME="90"></A>        holder.btnChiDuong.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                <FONT color="#82cafa"><A HREF="javascript:ZweiFrames('match0-1.html#90',3,'match0-top.html#90',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>FragmentNhaHang_View.fragmentTransaction = FragmentNhaHang_View.fragmentManager.beginTransaction();
                FragmentChiDuong fragment = new FragmentChiDuong();
                Bundle bundle = new Bundle();
                bundle.putString(&quot;TaiKhoan&quot;, FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTaiKhoan());
                bundle.putString(&quot;MaDiaDiem&quot;,FragmentNhaHang_View.strMaDiaDiem);
                bundle.putString(&quot;MaTinh&quot;, &quot;&quot;);
                bundle.putInt(&quot;DieuKien&quot;, 3);
                fragment.setArguments(bundle);
                FragmentNhaHang_View.fragmentTransaction.replace(R.id.fragment_main, fragment);
                FragmentNhaHang_View</B></FONT>.fragmentTransaction.commit();
            }
        });

        holder.btnLuotThich.setOnClickListener(new View.OnClickListener() { //Click nút thích
            @SuppressLint(&quot;NewApi&quot;)
            @Override
            public void onClick(View v) {
                try{
                    classConnect = new ClassConnect(); //Mở kết nối đến SQL
                    String strTaiKhoan = FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTaiKhoan();
                    String sqlThich = &quot;update TB_NguoiDung set LuotThich = '&quot;+(++intThich[0])+&quot;' where TaiKhoan = '&quot;+ strTaiKhoan +&quot;'&quot;;
                    if (classConnect.updateData((Activity)mContext,sqlThich) == 1){
                        holder.textLuotThich.setText(intThich[0] + &quot; lượt thích&quot;); //Tăng lượt thích lên 1
                    }
                    classConnect.CONN((Activity)mContext).close(); //Đóng kết nối đến SQL
                }catch (Exception e){
                    Log.d(&quot;TAG&quot;, Objects.requireNonNull(e.getMessage()));
                }
            }
        });

        holder.btnBinhLuan.setOnClickListener(new View.OnClickListener() {
<A NAME="91"></A>            @Override
            public void onClick(View v) {
                String strMaDiaDiem = FragmentNhaHang_View.strMaDiaDiem;
                String <FONT color="#736aff"><A HREF="javascript:ZweiFrames('match0-1.html#91',3,'match0-top.html#91',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>strTaiKhoan = FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTaiKhoan();
                String strTenNhaHang = FragmentNhaHang_View.arrayListNhaHang.get(position).getStrTenNhaHang();
                String strDiaChi = FragmentNhaHang_View</B></FONT>.arrayListNhaHang.get(position).getStrDiaChi();
                FragmentNhaHang_View.fragmentTransaction = FragmentNhaHang_View.fragmentManager.beginTransaction();
                FragmentNhaHang_View.fragmentTransaction.replace(R.id.fragment_main, BLKhachSanFragment.newInstance(&quot;&quot;, strMaDiaDiem, strTenNhaHang, strDiaChi, strTaiKhoan, 2));
                FragmentNhaHang_View.fragmentTransaction.commit();
            }
        });
<A NAME="92"></A>        return convertView;
    }

    public <FONT color="#827d6b"><A HREF="javascript:ZweiFrames('match0-1.html#92',3,'match0-top.html#92',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>void filter(String charText) {
        charText = charText.toLowerCase(Locale.getDefault());
        FragmentNhaHang_View.arrayListNhaHang.clear();
        if (charText.length() == 0) {
            FragmentNhaHang_View.arrayListNhaHang.addAll(arraylist);
        } else {
            for (ClassNhaHang_View wp : arraylist) {
                if (wp.getStrTenNhaHang().toLowerCase(Locale.getDefault()).contains(charText)) {
                    FragmentNhaHang_View.arrayListNhaHang.add(wp);
                }
            }
        }
        notifyDataSetChanged();
    }</B></FONT>
}
</PRE>

</BODY>
</HTML>
